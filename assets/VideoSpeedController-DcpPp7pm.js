import{j as e}from"./index-D62iepav.js";import{r as t}from"./react-vendor-CjoZ0FnW.js";import{L as De}from"./Layout-7YO7GSX_.js";import{p as We,q as je,t as be,g as Be,e as K,d as ye,R as we,D as Oe,c as Ae}from"./ui-Bjy91_IB.js";function Je(){const[q,J]=t.useState(null),[b,X]=t.useState(""),[o,N]=t.useState(1),[D,y]=t.useState(!1),[g,z]=t.useState(""),[W,B]=t.useState(!1),[Z,oe]=t.useState(0),[Ne,le]=t.useState(0),[_,Ce]=t.useState(!1),[E,ee]=t.useState("high"),[a,se]=t.useState("webm"),[ce,m]=t.useState(""),[de,p]=t.useState(""),[S,ue]=t.useState(null),[me,v]=t.useState(0),[ie,Fe]=t.useState(Date.now()),[C,O]=t.useState("medium"),[$,te]=t.useState(640),M=t.useRef(null),L=t.useRef(null),u=t.useRef(null),re=t.useRef([]),ke=t.useRef(null),Me=t.useRef(null),V=t.useRef(!1),j=t.useRef([]),he=t.useRef(null);t.useEffect(()=>()=>{b&&URL.revokeObjectURL(b),g&&URL.revokeObjectURL(g),he.current&&he.current.terminate()},[]),t.useEffect(()=>{if(!window.GIF&&a==="gif"){const s=document.createElement("script");return s.src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js",s.async=!0,s.onload=()=>{console.log("GIF.js library loaded successfully")},s.onerror=()=>{console.error("Failed to load GIF.js library"),m("Failed to load GIF processing library. Please try a different output format.")},document.body.appendChild(s),()=>{document.body.removeChild(s)}}},[a]);const pe=(s="webm")=>{let i=[];s==="webm"?i=["video/webm;codecs=vp9","video/webm;codecs=vp8","video/webm"]:s==="mp4"?i=["video/mp4;codecs=h264","video/mp4"]:i=["video/webm;codecs=vp8","video/webm"],i.push("video/webm","video/mp4");for(const n of i)if(MediaRecorder.isTypeSupported(n))return console.log(`Using MIME type: ${n}`),n;return console.log("No specific MIME types supported, using browser default"),""},fe=(s,i=2)=>{if(s===0)return"0 Bytes";const n=1024,r=i<0?0:i,h=["Bytes","KB","MB","GB","TB"],l=Math.floor(Math.log(s)/Math.log(n));return parseFloat((s/Math.pow(n,l)).toFixed(r))+" "+h[l]},A=s=>{const i=Math.floor(s/60),n=Math.floor(s%60);return`${i.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},Re=()=>`${A(Ne)} / ${A(Z)}`,Se=()=>{if(!Z)return"00:00";const s=Z/o;return A(s)},Ie=s=>{const i=s.target.files[0];if(!i)return;if(m(""),p(""),z(""),b&&URL.revokeObjectURL(b),!i.type.startsWith("video/")){m("Please select a valid video file");return}if(i.size>500*1024*1024){m("Video file is too large. Maximum size is 500MB");return}J(i);const n=URL.createObjectURL(i);X(n),console.log(`File loaded successfully: ${i.name} (${i.type}, ${fe(i.size)})`);const r=M.current;r&&(r.onloadedmetadata=()=>{ue({name:i.name,type:i.type,size:fe(i.size),duration:A(r.duration),width:r.videoWidth,height:r.videoHeight}),oe(r.duration);const h=Math.min(800,r.videoWidth);te(h)},r.onerror=h=>{console.error("Video load error:",h),m("There was an error loading this video. It may be in an unsupported format or corrupted."),J(null),X("")})},Pe=()=>{const s=M.current;s&&(W?s.pause():s.play(),B(!W))},Te=()=>{const s=M.current;s&&le(s.currentTime)},Ge=s=>{N(parseFloat(s.target.value))},Ue=(s,i,n,r)=>new Promise((h,l)=>{try{if(typeof window.GIF!="function")throw new Error("GIF.js library not properly loaded. Using fallback method.");let c={workers:2,quality:10,width:i,height:n};C==="low"?(c.quality=20,c.workers=1):C==="high"&&(c.quality=5,c.workers=3);const F=new window.GIF(c);let k=0;const I=s.length;s.forEach(d=>{try{F.addFrame(d,{delay:r}),k++;const w=60+k/I*10;v(Math.min(70,w))}catch(w){console.warn(`Warning: Could not add frame ${k}`,w)}}),F.on("progress",d=>{console.log(`GIF encoding progress: ${Math.round(d*100)}%`),v(70+Math.round(d*29))});const P=setTimeout(()=>{l(new Error("GIF processing timed out. Using fallback method."))},3e4);F.on("finished",d=>{clearTimeout(P),h(d)}),F.render()}catch(c){l(c)}}),ze=async()=>{const s=M.current;if(!s||!q){m("Please upload a video first");return}m(""),p(""),y(!0),v(0),V.current=!1,j.current=[];try{if(!window.MediaRecorder)throw new Error("Your browser does not support MediaRecorder. Please try Chrome, Firefox, or Edge.");if(!document.createElement("canvas").captureStream)throw new Error("Your browser does not support canvas.captureStream. Please try a different browser like Chrome or Firefox.");const n=navigator.deviceMemory&&navigator.deviceMemory<4;s.pause(),B(!1);const r=document.createElement("canvas");Me.current=r;const h=r.getContext("2d");let l,c;a==="gif"?(l=$,c=Math.round(l*(s.videoHeight/s.videoWidth)),n&&(O("low"),te(Math.min(400,$)),l=Math.min(400,$),c=Math.round(l*(s.videoHeight/s.videoWidth)),p("Low memory detected. Quality and size reduced for better performance.")),s.duration>30&&C==="high"&&p("Note: Long videos with high quality may cause performance issues. Consider using video format instead.")):(l=s.videoWidth,c=s.videoHeight),r.width=l,r.height=c;let F={videoBitsPerSecond:5e6};if(E==="medium"?F.videoBitsPerSecond=25e5:E==="low"&&(F.videoBitsPerSecond=1e6),a==="gif"){p("Preparing to generate GIF...");const k=0,I=s.duration;s.currentTime=k;const P=Math.round(100/o);let d=1;C==="low"?d=3:C==="medium"&&(d=2),o<.5&&(d=Math.max(1,Math.floor(d/2)));let w=0,f=0;const T=async()=>{if(V.current)return;if(h.drawImage(s,0,0,l,c),w%d===0){const R=document.createElement("img"),x=document.createElement("canvas");x.width=l,x.height=c,x.getContext("2d").drawImage(r,0,0),j.current.push(x),f++}w++;const G=1/30,H=s.currentTime+G*o,Ve=s.currentTime/I*60;if(v(Math.min(60,Ve)),H>=I){p(`Creating GIF with ${j.current.length} frames...`);try{try{const R=await Ue(j.current,l,c,P),x=URL.createObjectURL(R);z(x),p(`GIF created successfully! ${j.current.length} frames at ${l}x${c}`),v(100),y(!1)}catch(R){console.error("Error creating GIF with GIF.js:",R),p("Using alternative GIF creation method...");const x=document.createElement("canvas");x.width=l,x.height=c;const ne=x.getContext("2d"),qe=x.captureStream(),Q=new MediaRecorder(qe,{mimeType:pe("webm"),videoBitsPerSecond:2e6}),ge=[];Q.ondataavailable=U=>{U.data.size>0&&ge.push(U.data)},Q.onstop=()=>{const U=new Blob(ge,{type:"video/webm"}),ae=URL.createObjectURL(U);z(ae),p("Your animation has been created. Due to browser security limitations, it has been saved as a WebM video instead of a GIF. You can convert this video to GIF using desktop software if needed."),v(100),y(!1)},Q.start();let Y=0;const ve=()=>{if(Y>=j.current.length){Q.stop();return}const U=j.current[Y];ne.clearRect(0,0,l,c),ne.drawImage(U,0,0),Y++;const ae=60+Y/j.current.length*39;v(Math.min(99,ae)),setTimeout(ve,P)};ve()}}catch(R){console.error("All GIF creation methods failed:",R),m(`Could not create animation: ${R.message}`),y(!1)}return}s.currentTime=H};s.onseeked=T,T()}else{const k=r.captureStream(),I=pe(a);u.current=new MediaRecorder(k,{mimeType:I,...F}),re.current=[],u.current.ondataavailable=f=>{f.data.size>0&&re.current.push(f.data)},u.current.onstop=async()=>{try{let f="video/webm";a==="mp4"&&(f="video/mp4");const T=new Blob(re.current,{type:f}),G=URL.createObjectURL(T);z(G),p("Video processing complete!"),v(100),y(!1),L.current&&L.current.load()}catch(f){console.error("Error processing video output:",f),m(`Error in final processing: ${f.message}`),y(!1)}},u.current.start(100);const P=0,d=s.duration;s.currentTime=P;const w=()=>{if(!u.current||u.current.state==="inactive"||V.current)return;h.drawImage(s,0,0,r.width,r.height);const T=1/30,G=s.currentTime+T*o,H=s.currentTime/d*100;if(v(Math.min(99,H)),G>=d){u.current.stop();return}s.currentTime=G};s.onseeked=w,w()}}catch(i){let n=i.message;i.name==="NotAllowedError"?n="Camera or microphone access denied. Please check your browser permissions.":i.name==="NotReadableError"?n="Could not access your camera or microphone. It may be in use by another application.":i.message.includes("out of memory")&&(n="Browser ran out of memory. Try reducing the quality settings or using a shorter video."),console.error("Error processing video:",i),m(`Processing error: ${n}`),y(!1),u.current&&u.current.state!=="inactive"&&u.current.stop()}},Ee=()=>{V.current=!0,u.current&&u.current.state!=="inactive"&&u.current.stop(),j.current=[],y(!1),m("Processing canceled")},xe=()=>{V.current=!0,b&&URL.revokeObjectURL(b),g&&URL.revokeObjectURL(g),j.current=[],J(null),X(""),z(""),B(!1),oe(0),le(0),N(1),y(!1),m(""),p(""),ue(null),v(0),M.current&&M.current.pause(),L.current&&L.current.pause(),Fe(Date.now())},$e=()=>{if(!g)return;const s=document.createElement("a");s.href=g;const i=o<1?`slow-${o}x`:`fast-${o}x`,n=q.name.split(".").slice(0,-1).join(".");let r="webm";a==="mp4"&&(r="mp4");const h=a==="gif"?"-animation":"";s.download=`${n}-${i}${h}.${r}`,document.body.appendChild(s),s.click(),document.body.removeChild(s)},Le=e.jsxs("div",{className:"info-banner",children:[e.jsx("div",{className:"info-icon",children:e.jsx(K,{size:20})}),e.jsx("div",{className:"info-content",children:"Upload a video and adjust its playback speed to create slow-motion or fast-motion effects. All processing happens locally in your browser - no data is sent to any server."})]});return e.jsx(De,{title:"Video Speed Controller",description:Le,children:e.jsxs("div",{className:"video-speed-container",children:[e.jsxs("div",{className:"upload-section",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"video-upload",children:"Upload Video:"}),e.jsxs("div",{className:"file-upload-wrapper",children:[e.jsxs("label",{className:"file-upload-button",htmlFor:`video-upload-${ie}`,children:[e.jsx(We,{size:18}),e.jsx("span",{children:"Choose Video File"})]}),e.jsx("input",{id:`video-upload-${ie}`,ref:ke,type:"file",onChange:Ie,accept:"video/*",disabled:D,className:"hidden-file-input"},ie),q&&e.jsx("div",{className:"file-name",children:q.name})]})]}),S&&e.jsxs("div",{className:"video-info",children:[e.jsx("h3",{children:"Video Details"}),e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Duration:"}),e.jsx("span",{className:"info-value",children:S.duration})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Size:"}),e.jsx("span",{className:"info-value",children:S.size})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Dimensions:"}),e.jsxs("span",{className:"info-value",children:[S.width,"×",S.height]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Type:"}),e.jsx("span",{className:"info-value",children:S.type.split("/")[1]})]})]})]}),b&&e.jsxs("div",{className:"video-preview",children:[e.jsx("h3",{children:"Original Video Preview"}),e.jsxs("div",{className:"video-container",children:[e.jsx("video",{ref:M,src:b,onTimeUpdate:Te,onEnded:()=>B(!1),muted:!0}),e.jsxs("div",{className:"video-controls",children:[e.jsxs("button",{className:"play-pause-button",onClick:Pe,children:[W?e.jsx(je,{size:20}):e.jsx(be,{size:20}),e.jsx("span",{children:W?"Pause":"Play"})]}),e.jsx("div",{className:"time-display",children:Re()})]})]})]}),b&&!D&&!g&&e.jsxs("div",{className:"speed-control-section",children:[e.jsx("h3",{children:"Playback Speed Control"}),e.jsxs("div",{className:"format-control",children:[e.jsx("label",{children:"Output Format:"}),e.jsxs("div",{className:"format-options",children:[e.jsxs("label",{className:"radio-label",children:[e.jsx("input",{type:"radio",name:"format",value:"webm",checked:a==="webm",onChange:()=>se("webm")}),e.jsx("span",{children:"WebM (best quality, most compatible)"})]}),e.jsxs("label",{className:"radio-label",children:[e.jsx("input",{type:"radio",name:"format",value:"mp4",checked:a==="mp4",onChange:()=>se("mp4")}),e.jsx("span",{children:"MP4 (widely supported)"})]}),e.jsxs("label",{className:"radio-label",children:[e.jsx("input",{type:"radio",name:"format",value:"gif",checked:a==="gif",onChange:()=>se("gif")}),e.jsx("span",{children:"GIF (animated image format)"})]})]})]}),e.jsxs("div",{className:"speed-slider-container",children:[e.jsxs("div",{className:"speed-slider-labels",children:[e.jsx("span",{children:"Slow Motion"}),e.jsx("span",{children:"Normal"}),e.jsx("span",{children:"Fast Motion"})]}),e.jsx("input",{type:"range",min:"0.25",max:"4",step:"0.25",value:o,onChange:Ge,className:"speed-slider"}),e.jsxs("div",{className:"current-speed",children:[e.jsxs("div",{className:"speed-badge",children:[o,"x speed"]}),e.jsxs("div",{className:"output-duration",children:["Estimated output duration: ",Se()]})]})]}),e.jsxs("div",{className:"preset-speeds",children:[e.jsx("button",{onClick:()=>N(.25),className:`preset-button ${o===.25?"active":""}`,children:"0.25x"}),e.jsx("button",{onClick:()=>N(.5),className:`preset-button ${o===.5?"active":""}`,children:"0.5x"}),e.jsx("button",{onClick:()=>N(1),className:`preset-button ${o===1?"active":""}`,children:"1x"}),e.jsx("button",{onClick:()=>N(1.5),className:`preset-button ${o===1.5?"active":""}`,children:"1.5x"}),e.jsx("button",{onClick:()=>N(2),className:`preset-button ${o===2?"active":""}`,children:"2x"}),e.jsx("button",{onClick:()=>N(4),className:`preset-button ${o===4?"active":""}`,children:"4x"})]}),e.jsxs("div",{className:"advanced-options-toggle",onClick:()=>Ce(!_),children:[e.jsx(Be,{size:16}),e.jsx("span",{children:_?"Hide Advanced Options":"Show Advanced Options"})]}),_&&e.jsx("div",{className:"advanced-options",children:a==="gif"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"quality-control",children:[e.jsx("label",{children:"GIF Quality:"}),e.jsxs("div",{className:"quality-options",children:[e.jsxs("label",{className:"radio-label",children:[e.jsx("input",{type:"radio",name:"gif-quality",value:"low",checked:C==="low",onChange:()=>O("low")}),e.jsx("span",{children:"Low (smaller file, faster)"})]}),e.jsxs("label",{className:"radio-label",children:[e.jsx("input",{type:"radio",name:"gif-quality",value:"medium",checked:C==="medium",onChange:()=>O("medium")}),e.jsx("span",{children:"Medium (balanced)"})]}),e.jsxs("label",{className:"radio-label",children:[e.jsx("input",{type:"radio",name:"gif-quality",value:"high",checked:C==="high",onChange:()=>O("high")}),e.jsx("span",{children:"High (better quality, larger file)"})]})]})]}),e.jsxs("div",{className:"gif-size-control",children:[e.jsxs("label",{children:["GIF Width: ",$,"px"]}),e.jsx("input",{type:"range",min:"160",max:"800",step:"80",value:$,onChange:s=>te(Number(s.target.value)),className:"gif-width-slider"}),e.jsxs("div",{className:"size-note",children:[e.jsx(K,{size:14}),e.jsx("span",{children:"Smaller width = smaller file size. Height will adjust proportionally."})]})]}),e.jsxs("div",{className:"gif-warning",children:[e.jsx(ye,{size:16}),e.jsx("span",{children:"Note: Creating GIFs can be memory-intensive. For high-quality results with longer videos, consider using a video format instead."})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"quality-control",children:[e.jsx("label",{children:"Output Quality:"}),e.jsxs("div",{className:"quality-options",children:[e.jsxs("label",{className:"radio-label",children:[e.jsx("input",{type:"radio",name:"quality",value:"low",checked:E==="low",onChange:()=>ee("low")}),e.jsx("span",{children:"Low (faster processing)"})]}),e.jsxs("label",{className:"radio-label",children:[e.jsx("input",{type:"radio",name:"quality",value:"medium",checked:E==="medium",onChange:()=>ee("medium")}),e.jsx("span",{children:"Medium"})]}),e.jsxs("label",{className:"radio-label",children:[e.jsx("input",{type:"radio",name:"quality",value:"high",checked:E==="high",onChange:()=>ee("high")}),e.jsx("span",{children:"High (larger file size)"})]})]})]})})}),e.jsxs("div",{className:"process-controls",children:[e.jsxs("button",{onClick:ze,className:"process-button",disabled:D,children:[e.jsx(be,{size:18}),e.jsxs("span",{children:["Process ",a==="gif"?"GIF":"Video"," with ",o,"x Speed"]})]}),e.jsxs("button",{onClick:xe,className:"reset-button",children:[e.jsx(we,{size:18}),e.jsx("span",{children:"Reset"})]})]})]}),D&&e.jsxs("div",{className:"processing-section",children:[e.jsxs("h3",{children:["Processing ",a==="gif"?"GIF":"Video","..."]}),e.jsx("div",{className:"progress-container",children:e.jsx("div",{className:"progress-bar",style:{width:`${me}%`}})}),e.jsxs("div",{className:"progress-info",children:[e.jsxs("span",{children:[Math.round(me),"% Complete"]}),e.jsxs("button",{onClick:Ee,className:"cancel-button",children:[e.jsx(je,{size:16}),e.jsx("span",{children:"Cancel"})]})]}),e.jsxs("p",{className:"processing-note",children:[e.jsx(K,{size:16}),e.jsx("span",{children:a==="gif"?"Creating GIFs requires significant processing. This may take several minutes depending on video length and quality settings.":"Depending on the video size and your device's performance, this might take a while. Please don't close this page."})]})]}),g&&e.jsxs("div",{className:"processed-video-section",children:[e.jsxs("h3",{children:["Processed ",a==="gif"?"Animation":"Video"," (",o,"x Speed)"]}),e.jsx("div",{className:"video-container",children:e.jsx("video",{ref:L,src:g,controls:!0,autoPlay:!0,loop:!0},g)}),e.jsxs("div",{className:"download-controls",children:[e.jsxs("button",{onClick:$e,className:"download-button",children:[e.jsx(Oe,{size:18}),e.jsxs("span",{children:["Download Processed ",a==="gif"?"Animation":"Video"]})]}),e.jsxs("button",{onClick:xe,className:"reset-button",children:[e.jsx(we,{size:18}),e.jsxs("span",{children:["Process Another ",a==="gif"?"Animation":"Video"]})]})]}),a==="gif"&&e.jsxs("div",{className:"info-message",children:[e.jsx(K,{size:16}),e.jsx("span",{children:"Due to browser limitations, your animation has been created as a WebM video instead of a GIF. This format still preserves all speed adjustments and plays perfectly in browsers, and can be converted to GIF using desktop tools if needed."})]})]}),ce&&e.jsxs("div",{className:"error-message",children:[e.jsx(ye,{size:16}),e.jsx("span",{children:ce})]}),de&&e.jsxs("div",{className:"success-message",children:[e.jsx(Ae,{size:16}),e.jsx("span",{children:de})]})]}),e.jsxs("div",{className:"instructions-section",children:[e.jsx("h3",{children:"How to Use This Tool"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Upload a video file using the selector above"}),e.jsx("li",{children:"Choose your preferred output format (WebM, MP4, or GIF)"}),e.jsx("li",{children:"Adjust the playback speed using the slider or preset buttons"}),e.jsx("li",{children:'Click "Process Video" to create your speed-adjusted video'}),e.jsx("li",{children:"Preview the result and download your new video file"})]}),e.jsxs("div",{className:"tips",children:[e.jsx("h4",{children:"Tips"}),e.jsxs("ul",{children:[e.jsx("li",{children:"For smooth slow motion, use values less than 1 (0.5x, 0.25x)"}),e.jsx("li",{children:"For time-lapse effects, use faster speeds (2x, 4x)"}),e.jsx("li",{children:"Processing high-resolution videos may take longer"}),e.jsx("li",{children:"For best results with slow motion, try to use videos recorded at high frame rates (60fps or higher)"}),e.jsx("li",{children:"When creating GIFs, using smaller dimensions and lower quality settings will result in smaller file sizes"})]})]}),e.jsxs("div",{className:"technical-notes",children:[e.jsx("h4",{children:"Technical Notes"}),e.jsxs("ul",{children:[e.jsx("li",{children:"All processing happens in your browser - videos are not uploaded to any server"}),e.jsx("li",{children:"You can choose from multiple output formats (WebM, MP4, GIF)"}),e.jsx("li",{children:"Maximum supported file size is 500MB"}),e.jsx("li",{children:"Processing large videos may use significant system resources"}),e.jsx("li",{children:"GIF creation uses the GIF.js library and can be memory-intensive. For longer videos, video formats are recommended."})]})]})]})]})})}export{Je as default};
//# sourceMappingURL=VideoSpeedController-DcpPp7pm.js.map
