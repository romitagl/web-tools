import{c as Fn,g as bs}from"./react-vendor-CjoZ0FnW.js";function ys(d,f){for(var c=0;c<f.length;c++){const w=f[c];if(typeof w!="string"&&!Array.isArray(w)){for(const A in w)if(A!=="default"&&!(A in d)){const h=Object.getOwnPropertyDescriptor(w,A);h&&Object.defineProperty(d,A,h.get?h:{enumerable:!0,get:()=>w[A]})}}}return Object.freeze(Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}))}var un={},lr,ei;function Ts(){return ei||(ei=1,lr=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),lr}var cr={},Ht={},ti;function Qt(){if(ti)return Ht;ti=1;let d;const f=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Ht.getSymbolSize=function(w){if(!w)throw new Error('"version" cannot be null or undefined');if(w<1||w>40)throw new Error('"version" should be in range from 1 to 40');return w*4+17},Ht.getSymbolTotalCodewords=function(w){return f[w]},Ht.getBCHDigit=function(c){let w=0;for(;c!==0;)w++,c>>>=1;return w},Ht.setToSJISFunction=function(w){if(typeof w!="function")throw new Error('"toSJISFunc" is not a valid function.');d=w},Ht.isKanjiModeEnabled=function(){return typeof d<"u"},Ht.toSJIS=function(w){return d(w)},Ht}var ur={},ni;function Mr(){return ni||(ni=1,function(d){d.L={bit:1},d.M={bit:0},d.Q={bit:3},d.H={bit:2};function f(c){if(typeof c!="string")throw new Error("Param is not a string");switch(c.toLowerCase()){case"l":case"low":return d.L;case"m":case"medium":return d.M;case"q":case"quartile":return d.Q;case"h":case"high":return d.H;default:throw new Error("Unknown EC Level: "+c)}}d.isValid=function(w){return w&&typeof w.bit<"u"&&w.bit>=0&&w.bit<4},d.from=function(w,A){if(d.isValid(w))return w;try{return f(w)}catch{return A}}}(ur)),ur}var fr,ri;function Ss(){if(ri)return fr;ri=1;function d(){this.buffer=[],this.length=0}return d.prototype={get:function(f){const c=Math.floor(f/8);return(this.buffer[c]>>>7-f%8&1)===1},put:function(f,c){for(let w=0;w<c;w++)this.putBit((f>>>c-w-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(f){const c=Math.floor(this.length/8);this.buffer.length<=c&&this.buffer.push(0),f&&(this.buffer[c]|=128>>>this.length%8),this.length++}},fr=d,fr}var hr,ii;function Ns(){if(ii)return hr;ii=1;function d(f){if(!f||f<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=f,this.data=new Uint8Array(f*f),this.reservedBit=new Uint8Array(f*f)}return d.prototype.set=function(f,c,w,A){const h=f*this.size+c;this.data[h]=w,A&&(this.reservedBit[h]=!0)},d.prototype.get=function(f,c){return this.data[f*this.size+c]},d.prototype.xor=function(f,c,w){this.data[f*this.size+c]^=w},d.prototype.isReserved=function(f,c){return this.reservedBit[f*this.size+c]},hr=d,hr}var dr={},si;function _s(){return si||(si=1,function(d){const f=Qt().getSymbolSize;d.getRowColCoords=function(w){if(w===1)return[];const A=Math.floor(w/7)+2,h=f(w),p=h===145?26:Math.ceil((h-13)/(2*A-2))*2,S=[h-7];for(let y=1;y<A-1;y++)S[y]=S[y-1]-p;return S.push(6),S.reverse()},d.getPositions=function(w){const A=[],h=d.getRowColCoords(w),p=h.length;for(let S=0;S<p;S++)for(let y=0;y<p;y++)S===0&&y===0||S===0&&y===p-1||S===p-1&&y===0||A.push([h[S],h[y]]);return A}}(dr)),dr}var gr={},oi;function Rs(){if(oi)return gr;oi=1;const d=Qt().getSymbolSize,f=7;return gr.getPositions=function(w){const A=d(w);return[[0,0],[A-f,0],[0,A-f]]},gr}var xr={},ai;function Os(){return ai||(ai=1,function(d){d.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const f={N1:3,N2:3,N3:40,N4:10};d.isValid=function(A){return A!=null&&A!==""&&!isNaN(A)&&A>=0&&A<=7},d.from=function(A){return d.isValid(A)?parseInt(A,10):void 0},d.getPenaltyN1=function(A){const h=A.size;let p=0,S=0,y=0,C=null,O=null;for(let R=0;R<h;R++){S=y=0,C=O=null;for(let Y=0;Y<h;Y++){let k=A.get(R,Y);k===C?S++:(S>=5&&(p+=f.N1+(S-5)),C=k,S=1),k=A.get(Y,R),k===O?y++:(y>=5&&(p+=f.N1+(y-5)),O=k,y=1)}S>=5&&(p+=f.N1+(S-5)),y>=5&&(p+=f.N1+(y-5))}return p},d.getPenaltyN2=function(A){const h=A.size;let p=0;for(let S=0;S<h-1;S++)for(let y=0;y<h-1;y++){const C=A.get(S,y)+A.get(S,y+1)+A.get(S+1,y)+A.get(S+1,y+1);(C===4||C===0)&&p++}return p*f.N2},d.getPenaltyN3=function(A){const h=A.size;let p=0,S=0,y=0;for(let C=0;C<h;C++){S=y=0;for(let O=0;O<h;O++)S=S<<1&2047|A.get(C,O),O>=10&&(S===1488||S===93)&&p++,y=y<<1&2047|A.get(O,C),O>=10&&(y===1488||y===93)&&p++}return p*f.N3},d.getPenaltyN4=function(A){let h=0;const p=A.data.length;for(let y=0;y<p;y++)h+=A.data[y];return Math.abs(Math.ceil(h*100/p/5)-10)*f.N4};function c(w,A,h){switch(w){case d.Patterns.PATTERN000:return(A+h)%2===0;case d.Patterns.PATTERN001:return A%2===0;case d.Patterns.PATTERN010:return h%3===0;case d.Patterns.PATTERN011:return(A+h)%3===0;case d.Patterns.PATTERN100:return(Math.floor(A/2)+Math.floor(h/3))%2===0;case d.Patterns.PATTERN101:return A*h%2+A*h%3===0;case d.Patterns.PATTERN110:return(A*h%2+A*h%3)%2===0;case d.Patterns.PATTERN111:return(A*h%3+(A+h)%2)%2===0;default:throw new Error("bad maskPattern:"+w)}}d.applyMask=function(A,h){const p=h.size;for(let S=0;S<p;S++)for(let y=0;y<p;y++)h.isReserved(y,S)||h.xor(y,S,c(A,y,S))},d.getBestMask=function(A,h){const p=Object.keys(d.Patterns).length;let S=0,y=1/0;for(let C=0;C<p;C++){h(C),d.applyMask(C,A);const O=d.getPenaltyN1(A)+d.getPenaltyN2(A)+d.getPenaltyN3(A)+d.getPenaltyN4(A);d.applyMask(C,A),O<y&&(y=O,S=C)}return S}}(xr)),xr}var kn={},li;function Ui(){if(li)return kn;li=1;const d=Mr(),f=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],c=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return kn.getBlocksCount=function(A,h){switch(h){case d.L:return f[(A-1)*4+0];case d.M:return f[(A-1)*4+1];case d.Q:return f[(A-1)*4+2];case d.H:return f[(A-1)*4+3];default:return}},kn.getTotalCodewordsCount=function(A,h){switch(h){case d.L:return c[(A-1)*4+0];case d.M:return c[(A-1)*4+1];case d.Q:return c[(A-1)*4+2];case d.H:return c[(A-1)*4+3];default:return}},kn}var wr={},pn={},ci;function Ds(){if(ci)return pn;ci=1;const d=new Uint8Array(512),f=new Uint8Array(256);return function(){let w=1;for(let A=0;A<255;A++)d[A]=w,f[w]=A,w<<=1,w&256&&(w^=285);for(let A=255;A<512;A++)d[A]=d[A-255]}(),pn.log=function(w){if(w<1)throw new Error("log("+w+")");return f[w]},pn.exp=function(w){return d[w]},pn.mul=function(w,A){return w===0||A===0?0:d[f[w]+f[A]]},pn}var ui;function Ms(){return ui||(ui=1,function(d){const f=Ds();d.mul=function(w,A){const h=new Uint8Array(w.length+A.length-1);for(let p=0;p<w.length;p++)for(let S=0;S<A.length;S++)h[p+S]^=f.mul(w[p],A[S]);return h},d.mod=function(w,A){let h=new Uint8Array(w);for(;h.length-A.length>=0;){const p=h[0];for(let y=0;y<A.length;y++)h[y]^=f.mul(A[y],p);let S=0;for(;S<h.length&&h[S]===0;)S++;h=h.slice(S)}return h},d.generateECPolynomial=function(w){let A=new Uint8Array([1]);for(let h=0;h<w;h++)A=d.mul(A,new Uint8Array([1,f.exp(h)]));return A}}(wr)),wr}var Ar,fi;function Bs(){if(fi)return Ar;fi=1;const d=Ms();function f(c){this.genPoly=void 0,this.degree=c,this.degree&&this.initialize(this.degree)}return f.prototype.initialize=function(w){this.degree=w,this.genPoly=d.generateECPolynomial(this.degree)},f.prototype.encode=function(w){if(!this.genPoly)throw new Error("Encoder not initialized");const A=new Uint8Array(w.length+this.degree);A.set(w);const h=d.mod(A,this.genPoly),p=this.degree-h.length;if(p>0){const S=new Uint8Array(this.degree);return S.set(h,p),S}return h},Ar=f,Ar}var Er={},Cr={},mr={},hi;function Vi(){return hi||(hi=1,mr.isValid=function(f){return!isNaN(f)&&f>=1&&f<=40}),mr}var Ot={},di;function Gi(){if(di)return Ot;di=1;const d="[0-9]+",f="[A-Z $%*+\\-./:]+";let c="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";c=c.replace(/u/g,"\\u");const w="(?:(?![A-Z0-9 $%*+\\-./:]|"+c+`)(?:.|[\r
]))+`;Ot.KANJI=new RegExp(c,"g"),Ot.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Ot.BYTE=new RegExp(w,"g"),Ot.NUMERIC=new RegExp(d,"g"),Ot.ALPHANUMERIC=new RegExp(f,"g");const A=new RegExp("^"+c+"$"),h=new RegExp("^"+d+"$"),p=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Ot.testKanji=function(y){return A.test(y)},Ot.testNumeric=function(y){return h.test(y)},Ot.testAlphanumeric=function(y){return p.test(y)},Ot}var gi;function Jt(){return gi||(gi=1,function(d){const f=Vi(),c=Gi();d.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},d.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},d.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},d.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},d.MIXED={bit:-1},d.getCharCountIndicator=function(h,p){if(!h.ccBits)throw new Error("Invalid mode: "+h);if(!f.isValid(p))throw new Error("Invalid version: "+p);return p>=1&&p<10?h.ccBits[0]:p<27?h.ccBits[1]:h.ccBits[2]},d.getBestModeForData=function(h){return c.testNumeric(h)?d.NUMERIC:c.testAlphanumeric(h)?d.ALPHANUMERIC:c.testKanji(h)?d.KANJI:d.BYTE},d.toString=function(h){if(h&&h.id)return h.id;throw new Error("Invalid mode")},d.isValid=function(h){return h&&h.bit&&h.ccBits};function w(A){if(typeof A!="string")throw new Error("Param is not a string");switch(A.toLowerCase()){case"numeric":return d.NUMERIC;case"alphanumeric":return d.ALPHANUMERIC;case"kanji":return d.KANJI;case"byte":return d.BYTE;default:throw new Error("Unknown mode: "+A)}}d.from=function(h,p){if(d.isValid(h))return h;try{return w(h)}catch{return p}}}(Cr)),Cr}var xi;function vs(){return xi||(xi=1,function(d){const f=Qt(),c=Ui(),w=Mr(),A=Jt(),h=Vi(),p=7973,S=f.getBCHDigit(p);function y(Y,k,re){for(let q=1;q<=40;q++)if(k<=d.getCapacity(q,re,Y))return q}function C(Y,k){return A.getCharCountIndicator(Y,k)+4}function O(Y,k){let re=0;return Y.forEach(function(q){const Ie=C(q.mode,k);re+=Ie+q.getBitsLength()}),re}function R(Y,k){for(let re=1;re<=40;re++)if(O(Y,re)<=d.getCapacity(re,k,A.MIXED))return re}d.from=function(k,re){return h.isValid(k)?parseInt(k,10):re},d.getCapacity=function(k,re,q){if(!h.isValid(k))throw new Error("Invalid QR Code version");typeof q>"u"&&(q=A.BYTE);const Ie=f.getSymbolTotalCodewords(k),oe=c.getTotalCodewordsCount(k,re),$=(Ie-oe)*8;if(q===A.MIXED)return $;const G=$-C(q,k);switch(q){case A.NUMERIC:return Math.floor(G/10*3);case A.ALPHANUMERIC:return Math.floor(G/11*2);case A.KANJI:return Math.floor(G/13);case A.BYTE:default:return Math.floor(G/8)}},d.getBestVersionForData=function(k,re){let q;const Ie=w.from(re,w.M);if(Array.isArray(k)){if(k.length>1)return R(k,Ie);if(k.length===0)return 1;q=k[0]}else q=k;return y(q.mode,q.getLength(),Ie)},d.getEncodedBits=function(k){if(!h.isValid(k)||k<7)throw new Error("Invalid QR Code version");let re=k<<12;for(;f.getBCHDigit(re)-S>=0;)re^=p<<f.getBCHDigit(re)-S;return k<<12|re}}(Er)),Er}var Ir={},wi;function Ps(){if(wi)return Ir;wi=1;const d=Qt(),f=1335,c=21522,w=d.getBCHDigit(f);return Ir.getEncodedBits=function(h,p){const S=h.bit<<3|p;let y=S<<10;for(;d.getBCHDigit(y)-w>=0;)y^=f<<d.getBCHDigit(y)-w;return(S<<10|y)^c},Ir}var pr={},br,Ai;function Ls(){if(Ai)return br;Ai=1;const d=Jt();function f(c){this.mode=d.NUMERIC,this.data=c.toString()}return f.getBitsLength=function(w){return 10*Math.floor(w/3)+(w%3?w%3*3+1:0)},f.prototype.getLength=function(){return this.data.length},f.prototype.getBitsLength=function(){return f.getBitsLength(this.data.length)},f.prototype.write=function(w){let A,h,p;for(A=0;A+3<=this.data.length;A+=3)h=this.data.substr(A,3),p=parseInt(h,10),w.put(p,10);const S=this.data.length-A;S>0&&(h=this.data.substr(A),p=parseInt(h,10),w.put(p,S*3+1))},br=f,br}var yr,Ei;function Fs(){if(Ei)return yr;Ei=1;const d=Jt(),f=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function c(w){this.mode=d.ALPHANUMERIC,this.data=w}return c.getBitsLength=function(A){return 11*Math.floor(A/2)+6*(A%2)},c.prototype.getLength=function(){return this.data.length},c.prototype.getBitsLength=function(){return c.getBitsLength(this.data.length)},c.prototype.write=function(A){let h;for(h=0;h+2<=this.data.length;h+=2){let p=f.indexOf(this.data[h])*45;p+=f.indexOf(this.data[h+1]),A.put(p,11)}this.data.length%2&&A.put(f.indexOf(this.data[h]),6)},yr=c,yr}var Tr,Ci;function ks(){if(Ci)return Tr;Ci=1;const d=Jt();function f(c){this.mode=d.BYTE,typeof c=="string"?this.data=new TextEncoder().encode(c):this.data=new Uint8Array(c)}return f.getBitsLength=function(w){return w*8},f.prototype.getLength=function(){return this.data.length},f.prototype.getBitsLength=function(){return f.getBitsLength(this.data.length)},f.prototype.write=function(c){for(let w=0,A=this.data.length;w<A;w++)c.put(this.data[w],8)},Tr=f,Tr}var Sr,mi;function Us(){if(mi)return Sr;mi=1;const d=Jt(),f=Qt();function c(w){this.mode=d.KANJI,this.data=w}return c.getBitsLength=function(A){return A*13},c.prototype.getLength=function(){return this.data.length},c.prototype.getBitsLength=function(){return c.getBitsLength(this.data.length)},c.prototype.write=function(w){let A;for(A=0;A<this.data.length;A++){let h=f.toSJIS(this.data[A]);if(h>=33088&&h<=40956)h-=33088;else if(h>=57408&&h<=60351)h-=49472;else throw new Error("Invalid SJIS character: "+this.data[A]+`
Make sure your charset is UTF-8`);h=(h>>>8&255)*192+(h&255),w.put(h,13)}},Sr=c,Sr}var Nr={exports:{}},Ii;function Vs(){return Ii||(Ii=1,function(d){var f={single_source_shortest_paths:function(c,w,A){var h={},p={};p[w]=0;var S=f.PriorityQueue.make();S.push(w,0);for(var y,C,O,R,Y,k,re,q,Ie;!S.empty();){y=S.pop(),C=y.value,R=y.cost,Y=c[C]||{};for(O in Y)Y.hasOwnProperty(O)&&(k=Y[O],re=R+k,q=p[O],Ie=typeof p[O]>"u",(Ie||q>re)&&(p[O]=re,S.push(O,re),h[O]=C))}if(typeof A<"u"&&typeof p[A]>"u"){var oe=["Could not find a path from ",w," to ",A,"."].join("");throw new Error(oe)}return h},extract_shortest_path_from_predecessor_list:function(c,w){for(var A=[],h=w;h;)A.push(h),c[h],h=c[h];return A.reverse(),A},find_path:function(c,w,A){var h=f.single_source_shortest_paths(c,w,A);return f.extract_shortest_path_from_predecessor_list(h,A)},PriorityQueue:{make:function(c){var w=f.PriorityQueue,A={},h;c=c||{};for(h in w)w.hasOwnProperty(h)&&(A[h]=w[h]);return A.queue=[],A.sorter=c.sorter||w.default_sorter,A},default_sorter:function(c,w){return c.cost-w.cost},push:function(c,w){var A={value:c,cost:w};this.queue.push(A),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};d.exports=f}(Nr)),Nr.exports}var pi;function Gs(){return pi||(pi=1,function(d){const f=Jt(),c=Ls(),w=Fs(),A=ks(),h=Us(),p=Gi(),S=Qt(),y=Vs();function C(oe){return unescape(encodeURIComponent(oe)).length}function O(oe,$,G){const K=[];let Te;for(;(Te=oe.exec(G))!==null;)K.push({data:Te[0],index:Te.index,mode:$,length:Te[0].length});return K}function R(oe){const $=O(p.NUMERIC,f.NUMERIC,oe),G=O(p.ALPHANUMERIC,f.ALPHANUMERIC,oe);let K,Te;return S.isKanjiModeEnabled()?(K=O(p.BYTE,f.BYTE,oe),Te=O(p.KANJI,f.KANJI,oe)):(K=O(p.BYTE_KANJI,f.BYTE,oe),Te=[]),$.concat(G,K,Te).sort(function(P,z){return P.index-z.index}).map(function(P){return{data:P.data,mode:P.mode,length:P.length}})}function Y(oe,$){switch($){case f.NUMERIC:return c.getBitsLength(oe);case f.ALPHANUMERIC:return w.getBitsLength(oe);case f.KANJI:return h.getBitsLength(oe);case f.BYTE:return A.getBitsLength(oe)}}function k(oe){return oe.reduce(function($,G){const K=$.length-1>=0?$[$.length-1]:null;return K&&K.mode===G.mode?($[$.length-1].data+=G.data,$):($.push(G),$)},[])}function re(oe){const $=[];for(let G=0;G<oe.length;G++){const K=oe[G];switch(K.mode){case f.NUMERIC:$.push([K,{data:K.data,mode:f.ALPHANUMERIC,length:K.length},{data:K.data,mode:f.BYTE,length:K.length}]);break;case f.ALPHANUMERIC:$.push([K,{data:K.data,mode:f.BYTE,length:K.length}]);break;case f.KANJI:$.push([K,{data:K.data,mode:f.BYTE,length:C(K.data)}]);break;case f.BYTE:$.push([{data:K.data,mode:f.BYTE,length:C(K.data)}])}}return $}function q(oe,$){const G={},K={start:{}};let Te=["start"];for(let W=0;W<oe.length;W++){const P=oe[W],z=[];for(let M=0;M<P.length;M++){const ae=P[M],J=""+W+M;z.push(J),G[J]={node:ae,lastCount:0},K[J]={};for(let U=0;U<Te.length;U++){const Z=Te[U];G[Z]&&G[Z].node.mode===ae.mode?(K[Z][J]=Y(G[Z].lastCount+ae.length,ae.mode)-Y(G[Z].lastCount,ae.mode),G[Z].lastCount+=ae.length):(G[Z]&&(G[Z].lastCount=ae.length),K[Z][J]=Y(ae.length,ae.mode)+4+f.getCharCountIndicator(ae.mode,$))}}Te=z}for(let W=0;W<Te.length;W++)K[Te[W]].end=0;return{map:K,table:G}}function Ie(oe,$){let G;const K=f.getBestModeForData(oe);if(G=f.from($,K),G!==f.BYTE&&G.bit<K.bit)throw new Error('"'+oe+'" cannot be encoded with mode '+f.toString(G)+`.
 Suggested mode is: `+f.toString(K));switch(G===f.KANJI&&!S.isKanjiModeEnabled()&&(G=f.BYTE),G){case f.NUMERIC:return new c(oe);case f.ALPHANUMERIC:return new w(oe);case f.KANJI:return new h(oe);case f.BYTE:return new A(oe)}}d.fromArray=function($){return $.reduce(function(G,K){return typeof K=="string"?G.push(Ie(K,null)):K.data&&G.push(Ie(K.data,K.mode)),G},[])},d.fromString=function($,G){const K=R($,S.isKanjiModeEnabled()),Te=re(K),W=q(Te,G),P=y.find_path(W.map,"start","end"),z=[];for(let M=1;M<P.length-1;M++)z.push(W.table[P[M]].node);return d.fromArray(k(z))},d.rawSplit=function($){return d.fromArray(R($,S.isKanjiModeEnabled()))}}(pr)),pr}var bi;function Hs(){if(bi)return cr;bi=1;const d=Qt(),f=Mr(),c=Ss(),w=Ns(),A=_s(),h=Rs(),p=Os(),S=Ui(),y=Bs(),C=vs(),O=Ps(),R=Jt(),Y=Gs();function k(W,P){const z=W.size,M=h.getPositions(P);for(let ae=0;ae<M.length;ae++){const J=M[ae][0],U=M[ae][1];for(let Z=-1;Z<=7;Z++)if(!(J+Z<=-1||z<=J+Z))for(let te=-1;te<=7;te++)U+te<=-1||z<=U+te||(Z>=0&&Z<=6&&(te===0||te===6)||te>=0&&te<=6&&(Z===0||Z===6)||Z>=2&&Z<=4&&te>=2&&te<=4?W.set(J+Z,U+te,!0,!0):W.set(J+Z,U+te,!1,!0))}}function re(W){const P=W.size;for(let z=8;z<P-8;z++){const M=z%2===0;W.set(z,6,M,!0),W.set(6,z,M,!0)}}function q(W,P){const z=A.getPositions(P);for(let M=0;M<z.length;M++){const ae=z[M][0],J=z[M][1];for(let U=-2;U<=2;U++)for(let Z=-2;Z<=2;Z++)U===-2||U===2||Z===-2||Z===2||U===0&&Z===0?W.set(ae+U,J+Z,!0,!0):W.set(ae+U,J+Z,!1,!0)}}function Ie(W,P){const z=W.size,M=C.getEncodedBits(P);let ae,J,U;for(let Z=0;Z<18;Z++)ae=Math.floor(Z/3),J=Z%3+z-8-3,U=(M>>Z&1)===1,W.set(ae,J,U,!0),W.set(J,ae,U,!0)}function oe(W,P,z){const M=W.size,ae=O.getEncodedBits(P,z);let J,U;for(J=0;J<15;J++)U=(ae>>J&1)===1,J<6?W.set(J,8,U,!0):J<8?W.set(J+1,8,U,!0):W.set(M-15+J,8,U,!0),J<8?W.set(8,M-J-1,U,!0):J<9?W.set(8,15-J-1+1,U,!0):W.set(8,15-J-1,U,!0);W.set(M-8,8,1,!0)}function $(W,P){const z=W.size;let M=-1,ae=z-1,J=7,U=0;for(let Z=z-1;Z>0;Z-=2)for(Z===6&&Z--;;){for(let te=0;te<2;te++)if(!W.isReserved(ae,Z-te)){let v=!1;U<P.length&&(v=(P[U]>>>J&1)===1),W.set(ae,Z-te,v),J--,J===-1&&(U++,J=7)}if(ae+=M,ae<0||z<=ae){ae-=M,M=-M;break}}}function G(W,P,z){const M=new c;z.forEach(function(te){M.put(te.mode.bit,4),M.put(te.getLength(),R.getCharCountIndicator(te.mode,W)),te.write(M)});const ae=d.getSymbolTotalCodewords(W),J=S.getTotalCodewordsCount(W,P),U=(ae-J)*8;for(M.getLengthInBits()+4<=U&&M.put(0,4);M.getLengthInBits()%8!==0;)M.putBit(0);const Z=(U-M.getLengthInBits())/8;for(let te=0;te<Z;te++)M.put(te%2?17:236,8);return K(M,W,P)}function K(W,P,z){const M=d.getSymbolTotalCodewords(P),ae=S.getTotalCodewordsCount(P,z),J=M-ae,U=S.getBlocksCount(P,z),Z=M%U,te=U-Z,v=Math.floor(M/U),Be=Math.floor(J/U),ue=Be+1,vt=v-Be,pt=new y(vt);let ht=0;const Wt=new Array(U),Ye=new Array(U);let Et=0;const Ke=new Uint8Array(W.buffer);for(let dt=0;dt<U;dt++){const Dt=dt<te?Be:ue;Wt[dt]=Ke.slice(ht,ht+Dt),Ye[dt]=pt.encode(Wt[dt]),ht+=Dt,Et=Math.max(Et,Dt)}const Xt=new Uint8Array(M);let ie=0,ct,be;for(ct=0;ct<Et;ct++)for(be=0;be<U;be++)ct<Wt[be].length&&(Xt[ie++]=Wt[be][ct]);for(ct=0;ct<vt;ct++)for(be=0;be<U;be++)Xt[ie++]=Ye[be][ct];return Xt}function Te(W,P,z,M){let ae;if(Array.isArray(W))ae=Y.fromArray(W);else if(typeof W=="string"){let v=P;if(!v){const Be=Y.rawSplit(W);v=C.getBestVersionForData(Be,z)}ae=Y.fromString(W,v||40)}else throw new Error("Invalid data");const J=C.getBestVersionForData(ae,z);if(!J)throw new Error("The amount of data is too big to be stored in a QR Code");if(!P)P=J;else if(P<J)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+J+`.
`);const U=G(P,z,ae),Z=d.getSymbolSize(P),te=new w(Z);return k(te,P),re(te),q(te,P),oe(te,z,0),P>=7&&Ie(te,P),$(te,U),isNaN(M)&&(M=p.getBestMask(te,oe.bind(null,te,z))),p.applyMask(M,te),oe(te,z,M),{modules:te,version:P,errorCorrectionLevel:z,maskPattern:M,segments:ae}}return cr.create=function(P,z){if(typeof P>"u"||P==="")throw new Error("No input text");let M=f.M,ae,J;return typeof z<"u"&&(M=f.from(z.errorCorrectionLevel,f.M),ae=C.from(z.version),J=p.from(z.maskPattern),z.toSJISFunc&&d.setToSJISFunction(z.toSJISFunc)),Te(P,ae,M,J)},cr}var _r={},Rr={},yi;function Hi(){return yi||(yi=1,function(d){function f(c){if(typeof c=="number"&&(c=c.toString()),typeof c!="string")throw new Error("Color should be defined as hex string");let w=c.slice().replace("#","").split("");if(w.length<3||w.length===5||w.length>8)throw new Error("Invalid hex color: "+c);(w.length===3||w.length===4)&&(w=Array.prototype.concat.apply([],w.map(function(h){return[h,h]}))),w.length===6&&w.push("F","F");const A=parseInt(w.join(""),16);return{r:A>>24&255,g:A>>16&255,b:A>>8&255,a:A&255,hex:"#"+w.slice(0,6).join("")}}d.getOptions=function(w){w||(w={}),w.color||(w.color={});const A=typeof w.margin>"u"||w.margin===null||w.margin<0?4:w.margin,h=w.width&&w.width>=21?w.width:void 0,p=w.scale||4;return{width:h,scale:h?4:p,margin:A,color:{dark:f(w.color.dark||"#000000ff"),light:f(w.color.light||"#ffffffff")},type:w.type,rendererOpts:w.rendererOpts||{}}},d.getScale=function(w,A){return A.width&&A.width>=w+A.margin*2?A.width/(w+A.margin*2):A.scale},d.getImageWidth=function(w,A){const h=d.getScale(w,A);return Math.floor((w+A.margin*2)*h)},d.qrToImageData=function(w,A,h){const p=A.modules.size,S=A.modules.data,y=d.getScale(p,h),C=Math.floor((p+h.margin*2)*y),O=h.margin*y,R=[h.color.light,h.color.dark];for(let Y=0;Y<C;Y++)for(let k=0;k<C;k++){let re=(Y*C+k)*4,q=h.color.light;if(Y>=O&&k>=O&&Y<C-O&&k<C-O){const Ie=Math.floor((Y-O)/y),oe=Math.floor((k-O)/y);q=R[S[Ie*p+oe]?1:0]}w[re++]=q.r,w[re++]=q.g,w[re++]=q.b,w[re]=q.a}}}(Rr)),Rr}var Ti;function Ws(){return Ti||(Ti=1,function(d){const f=Hi();function c(A,h,p){A.clearRect(0,0,h.width,h.height),h.style||(h.style={}),h.height=p,h.width=p,h.style.height=p+"px",h.style.width=p+"px"}function w(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}d.render=function(h,p,S){let y=S,C=p;typeof y>"u"&&(!p||!p.getContext)&&(y=p,p=void 0),p||(C=w()),y=f.getOptions(y);const O=f.getImageWidth(h.modules.size,y),R=C.getContext("2d"),Y=R.createImageData(O,O);return f.qrToImageData(Y.data,h,y),c(R,C,O),R.putImageData(Y,0,0),C},d.renderToDataURL=function(h,p,S){let y=S;typeof y>"u"&&(!p||!p.getContext)&&(y=p,p=void 0),y||(y={});const C=d.render(h,p,y),O=y.type||"image/png",R=y.rendererOpts||{};return C.toDataURL(O,R.quality)}}(_r)),_r}var Or={},Si;function Xs(){if(Si)return Or;Si=1;const d=Hi();function f(A,h){const p=A.a/255,S=h+'="'+A.hex+'"';return p<1?S+" "+h+'-opacity="'+p.toFixed(2).slice(1)+'"':S}function c(A,h,p){let S=A+h;return typeof p<"u"&&(S+=" "+p),S}function w(A,h,p){let S="",y=0,C=!1,O=0;for(let R=0;R<A.length;R++){const Y=Math.floor(R%h),k=Math.floor(R/h);!Y&&!C&&(C=!0),A[R]?(O++,R>0&&Y>0&&A[R-1]||(S+=C?c("M",Y+p,.5+k+p):c("m",y,0),y=0,C=!1),Y+1<h&&A[R+1]||(S+=c("h",O),O=0)):y++}return S}return Or.render=function(h,p,S){const y=d.getOptions(p),C=h.modules.size,O=h.modules.data,R=C+y.margin*2,Y=y.color.light.a?"<path "+f(y.color.light,"fill")+' d="M0 0h'+R+"v"+R+'H0z"/>':"",k="<path "+f(y.color.dark,"stroke")+' d="'+w(O,C,y.margin)+'"/>',re='viewBox="0 0 '+R+" "+R+'"',Ie='<svg xmlns="http://www.w3.org/2000/svg" '+(y.width?'width="'+y.width+'" height="'+y.width+'" ':"")+re+' shape-rendering="crispEdges">'+Y+k+`</svg>
`;return typeof S=="function"&&S(null,Ie),Ie},Or}var Ni;function Co(){if(Ni)return un;Ni=1;const d=Ts(),f=Hs(),c=Ws(),w=Xs();function A(h,p,S,y,C){const O=[].slice.call(arguments,1),R=O.length,Y=typeof O[R-1]=="function";if(!Y&&!d())throw new Error("Callback required as last argument");if(Y){if(R<2)throw new Error("Too few arguments provided");R===2?(C=S,S=p,p=y=void 0):R===3&&(p.getContext&&typeof C>"u"?(C=y,y=void 0):(C=y,y=S,S=p,p=void 0))}else{if(R<1)throw new Error("Too few arguments provided");return R===1?(S=p,p=y=void 0):R===2&&!p.getContext&&(y=S,S=p,p=void 0),new Promise(function(k,re){try{const q=f.create(S,y);k(h(q,p,y))}catch(q){re(q)}})}try{const k=f.create(S,y);C(null,h(k,p,y))}catch(k){C(k)}}return un.create=f.create,un.toCanvas=A.bind(null,c.render),un.toDataURL=A.bind(null,c.renderToDataURL),un.toString=A.bind(null,function(h,p,S){return w.render(h,S)}),un}var Q;(function(d){d[d.QR_CODE=0]="QR_CODE",d[d.AZTEC=1]="AZTEC",d[d.CODABAR=2]="CODABAR",d[d.CODE_39=3]="CODE_39",d[d.CODE_93=4]="CODE_93",d[d.CODE_128=5]="CODE_128",d[d.DATA_MATRIX=6]="DATA_MATRIX",d[d.MAXICODE=7]="MAXICODE",d[d.ITF=8]="ITF",d[d.EAN_13=9]="EAN_13",d[d.EAN_8=10]="EAN_8",d[d.PDF_417=11]="PDF_417",d[d.RSS_14=12]="RSS_14",d[d.RSS_EXPANDED=13]="RSS_EXPANDED",d[d.UPC_A=14]="UPC_A",d[d.UPC_E=15]="UPC_E",d[d.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Q||(Q={}));var _i=new Map([[Q.QR_CODE,"QR_CODE"],[Q.AZTEC,"AZTEC"],[Q.CODABAR,"CODABAR"],[Q.CODE_39,"CODE_39"],[Q.CODE_93,"CODE_93"],[Q.CODE_128,"CODE_128"],[Q.DATA_MATRIX,"DATA_MATRIX"],[Q.MAXICODE,"MAXICODE"],[Q.ITF,"ITF"],[Q.EAN_13,"EAN_13"],[Q.EAN_8,"EAN_8"],[Q.PDF_417,"PDF_417"],[Q.RSS_14,"RSS_14"],[Q.RSS_EXPANDED,"RSS_EXPANDED"],[Q.UPC_A,"UPC_A"],[Q.UPC_E,"UPC_E"],[Q.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),Ri;(function(d){d[d.UNKNOWN=0]="UNKNOWN",d[d.URL=1]="URL"})(Ri||(Ri={}));function Ys(d){return Object.values(Q).includes(d)}var Un;(function(d){d[d.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",d[d.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Un||(Un={}));var zs=function(){function d(){}return d.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",d.SCAN_DEFAULT_FPS=2,d.DEFAULT_DISABLE_FLIP=!1,d.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,d.DEFAULT_SUPPORTED_SCAN_TYPE=[Un.SCAN_TYPE_CAMERA,Un.SCAN_TYPE_FILE],d}(),Wi=function(){function d(f,c){this.format=f,this.formatName=c}return d.prototype.toString=function(){return this.formatName},d.create=function(f){if(!_i.has(f))throw"".concat(f," not in html5QrcodeSupportedFormatsTextMap");return new d(f,_i.get(f))},d}(),Oi=function(){function d(){}return d.createFromText=function(f){var c={text:f};return{decodedText:f,result:c}},d.createFromQrcodeResult=function(f){return{decodedText:f.text,result:f}},d}(),Dr;(function(d){d[d.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",d[d.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",d[d.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Dr||(Dr={}));var Zs=function(){function d(){}return d.createFrom=function(f){return{errorMessage:f,type:Dr.UNKWOWN_ERROR}},d}(),Ks=function(){function d(f){this.verbose=f}return d.prototype.log=function(f){this.verbose&&console.log(f)},d.prototype.warn=function(f){this.verbose&&console.warn(f)},d.prototype.logError=function(f,c){(this.verbose||c===!0)&&console.error(f)},d.prototype.logErrors=function(f){if(f.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(f)},d}();function Bt(d){return typeof d>"u"||d===null}var fn=function(){function d(){}return d.codeParseError=function(f){return"QR code parse error, error = ".concat(f)},d.errorGettingUserMedia=function(f){return"Error getting userMedia, error = ".concat(f)},d.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},d.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},d.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},d.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},d.scannerPaused=function(){return"Scanner paused"},d}(),Xi=function(){function d(){}return d.isMediaStreamConstraintsValid=function(f,c){if(typeof f!="object"){var w=typeof f;return c.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(w,"."),!0),!1}for(var A=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],h=new Set(A),p=Object.keys(f),S=0,y=p;S<y.length;S++){var C=y[S];if(h.has(C))return c.logError("".concat(C," is not supported videoConstaints."),!0),!1}return!0},d}(),bn={exports:{}},qs=bn.exports,Di;function js(){return Di||(Di=1,function(d,f){(function(c,w){w(f)})(qs,function(c){function w(g){return g==null}var A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,e){g.__proto__=e}||function(g,e){for(var t in e)e.hasOwnProperty(t)&&(g[t]=e[t])};function h(g,e){A(g,e);function t(){this.constructor=g}g.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function p(g,e){var t=Object.setPrototypeOf;t?t(g,e):g.__proto__=e}function S(g,e){e===void 0&&(e=g.constructor);var t=Error.captureStackTrace;t&&t(g,e)}var y=function(g){h(e,g);function e(t){var n=this.constructor,r=g.call(this,t)||this;return Object.defineProperty(r,"name",{value:n.name,enumerable:!1}),p(r,n.prototype),S(r),r}return e}(Error);class C extends y{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}C.kind="Exception";class O extends C{}O.kind="ArgumentException";class R extends C{}R.kind="IllegalArgumentException";class Y{constructor(e){if(this.binarizer=e,e===null)throw new R("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,n,r){const i=this.binarizer.getLuminanceSource().crop(e,t,n,r);return new Y(this.binarizer.createBinarizer(i))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new Y(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new Y(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class k extends C{static getChecksumInstance(){return new k}}k.kind="ChecksumException";class re{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class q{static arraycopy(e,t,n,r,i){for(;i--;)n[r++]=e[t++]}static currentTimeMillis(){return Date.now()}}class Ie extends C{}Ie.kind="IndexOutOfBoundsException";class oe extends Ie{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}oe.kind="ArrayIndexOutOfBoundsException";class ${static fill(e,t){for(let n=0,r=e.length;n<r;n++)e[n]=t}static fillWithin(e,t,n,r){$.rangeCheck(e.length,t,n);for(let i=t;i<n;i++)e[i]=r}static rangeCheck(e,t,n){if(t>n)throw new R("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new oe(t);if(n>e)throw new oe(n)}static asList(...e){return e}static create(e,t,n){return Array.from({length:e}).map(i=>Array.from({length:t}).fill(n))}static createInt32Array(e,t,n){return Array.from({length:e}).map(i=>Int32Array.from({length:t}).fill(n))}static equals(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}static hashCode(e){if(e===null)return 0;let t=1;for(const n of e)t=31*t+n;return t}static fillUint8Array(e,t){for(let n=0;n!==e.length;n++)e[n]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)}static copyOfRange(e,t,n){const r=n-t,i=new Int32Array(r);return q.arraycopy(e,t,i,0,r),i}static binarySearch(e,t,n){n===void 0&&(n=$.numberComparator);let r=0,i=e.length-1;for(;r<=i;){const s=i+r>>1,o=n(t,e[s]);if(o>0)r=s+1;else if(o<0)i=s-1;else return s}return-r-1}static numberComparator(e,t){return e-t}}class G{static numberOfTrailingZeros(e){let t;if(e===0)return 32;let n=31;return t=e<<16,t!==0&&(n-=16,e=t),t=e<<8,t!==0&&(n-=8,e=t),t=e<<4,t!==0&&(n-=4,e=t),t=e<<2,t!==0&&(n-=2,e=t),n-(e<<1>>>31)}static numberOfLeadingZeros(e){if(e===0)return 32;let t=1;return e>>>16||(t+=16,e<<=16),e>>>24||(t+=8,e<<=8),e>>>28||(t+=4,e<<=4),e>>>30||(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}G.MIN_VALUE_32_BITS=-2147483648,G.MAX_VALUE=Number.MAX_SAFE_INTEGER;class K{constructor(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=K.makeArray(e):this.bits=t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>this.bits.length*32){const t=K.makeArray(e);q.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0}set(e){this.bits[Math.floor(e/32)]|=1<<(e&31)}flip(e){this.bits[Math.floor(e/32)]^=1<<(e&31)}getNextSet(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),i=n[r];i&=~((1<<(e&31))-1);const s=n.length;for(;i===0;){if(++r===s)return t;i=n[r]}const o=r*32+G.numberOfTrailingZeros(i);return o>t?t:o}getNextUnset(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),i=~n[r];i&=~((1<<(e&31))-1);const s=n.length;for(;i===0;){if(++r===s)return t;i=~n[r]}const o=r*32+G.numberOfTrailingZeros(i);return o>t?t:o}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new R;if(t===e)return;t--;const n=Math.floor(e/32),r=Math.floor(t/32),i=this.bits;for(let s=n;s<=r;s++){const o=s>n?0:e&31,l=(2<<(s<r?31:t&31))-(1<<o);i[s]|=l}}clear(){const e=this.bits.length,t=this.bits;for(let n=0;n<e;n++)t[n]=0}isRange(e,t,n){if(t<e||e<0||t>this.size)throw new R;if(t===e)return!0;t--;const r=Math.floor(e/32),i=Math.floor(t/32),s=this.bits;for(let o=r;o<=i;o++){const a=o>r?0:e&31,u=(2<<(o<i?31:t&31))-(1<<a)&4294967295;if((s[o]&u)!==(n?u:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(e,t){if(t<0||t>32)throw new R("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let n=t;n>0;n--)this.appendBit((e>>n-1&1)===1)}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let n=0;n<t;n++)this.appendBit(e.get(n))}xor(e){if(this.size!==e.size)throw new R("Sizes don't match");const t=this.bits;for(let n=0,r=t.length;n<r;n++)t[n]^=e.bits[n]}toBytes(e,t,n,r){for(let i=0;i<r;i++){let s=0;for(let o=0;o<8;o++)this.get(e)&&(s|=1<<7-o),e++;t[n+i]=s}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,r=this.bits;for(let i=0;i<n;i++){let s=r[i];s=s>>1&1431655765|(s&1431655765)<<1,s=s>>2&858993459|(s&858993459)<<2,s=s>>4&252645135|(s&252645135)<<4,s=s>>8&16711935|(s&16711935)<<8,s=s>>16&65535|(s&65535)<<16,e[t-i]=s}if(this.size!==n*32){const i=n*32-this.size;let s=e[0]>>>i;for(let o=1;o<n;o++){const a=e[o];s|=a<<32-i,e[o-1]=s,s=a>>>i}e[n-1]=s}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof K))return!1;const t=e;return this.size===t.size&&$.equals(this.bits,t.bits)}hashCode(){return 31*this.size+$.hashCode(this.bits)}toString(){let e="";for(let t=0,n=this.size;t<n;t++)(t&7)===0&&(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new K(this.size,this.bits.slice())}}var Te;(function(g){g[g.OTHER=0]="OTHER",g[g.PURE_BARCODE=1]="PURE_BARCODE",g[g.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",g[g.TRY_HARDER=3]="TRY_HARDER",g[g.CHARACTER_SET=4]="CHARACTER_SET",g[g.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",g[g.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",g[g.ASSUME_GS1=7]="ASSUME_GS1",g[g.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",g[g.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",g[g.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Te||(Te={}));var W=Te;class P extends C{static getFormatInstance(){return new P}}P.kind="FormatException";var z;(function(g){g[g.Cp437=0]="Cp437",g[g.ISO8859_1=1]="ISO8859_1",g[g.ISO8859_2=2]="ISO8859_2",g[g.ISO8859_3=3]="ISO8859_3",g[g.ISO8859_4=4]="ISO8859_4",g[g.ISO8859_5=5]="ISO8859_5",g[g.ISO8859_6=6]="ISO8859_6",g[g.ISO8859_7=7]="ISO8859_7",g[g.ISO8859_8=8]="ISO8859_8",g[g.ISO8859_9=9]="ISO8859_9",g[g.ISO8859_10=10]="ISO8859_10",g[g.ISO8859_11=11]="ISO8859_11",g[g.ISO8859_13=12]="ISO8859_13",g[g.ISO8859_14=13]="ISO8859_14",g[g.ISO8859_15=14]="ISO8859_15",g[g.ISO8859_16=15]="ISO8859_16",g[g.SJIS=16]="SJIS",g[g.Cp1250=17]="Cp1250",g[g.Cp1251=18]="Cp1251",g[g.Cp1252=19]="Cp1252",g[g.Cp1256=20]="Cp1256",g[g.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",g[g.UTF8=22]="UTF8",g[g.ASCII=23]="ASCII",g[g.Big5=24]="Big5",g[g.GB18030=25]="GB18030",g[g.EUC_KR=26]="EUC_KR"})(z||(z={}));class M{constructor(e,t,n,...r){this.valueIdentifier=e,this.name=n,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=r,M.VALUE_IDENTIFIER_TO_ECI.set(e,this),M.NAME_TO_ECI.set(n,this);const i=this.values;for(let s=0,o=i.length;s!==o;s++){const a=i[s];M.VALUES_TO_ECI.set(a,this)}for(const s of r)M.NAME_TO_ECI.set(s,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new P("incorect value");const t=M.VALUES_TO_ECI.get(e);if(t===void 0)throw new P("incorect value");return t}static getCharacterSetECIByName(e){const t=M.NAME_TO_ECI.get(e);if(t===void 0)throw new P("incorect value");return t}equals(e){if(!(e instanceof M))return!1;const t=e;return this.getName()===t.getName()}}M.VALUE_IDENTIFIER_TO_ECI=new Map,M.VALUES_TO_ECI=new Map,M.NAME_TO_ECI=new Map,M.Cp437=new M(z.Cp437,Int32Array.from([0,2]),"Cp437"),M.ISO8859_1=new M(z.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),M.ISO8859_2=new M(z.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),M.ISO8859_3=new M(z.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),M.ISO8859_4=new M(z.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),M.ISO8859_5=new M(z.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),M.ISO8859_6=new M(z.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),M.ISO8859_7=new M(z.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),M.ISO8859_8=new M(z.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),M.ISO8859_9=new M(z.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),M.ISO8859_10=new M(z.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),M.ISO8859_11=new M(z.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),M.ISO8859_13=new M(z.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),M.ISO8859_14=new M(z.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),M.ISO8859_15=new M(z.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),M.ISO8859_16=new M(z.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),M.SJIS=new M(z.SJIS,20,"SJIS","Shift_JIS"),M.Cp1250=new M(z.Cp1250,21,"Cp1250","windows-1250"),M.Cp1251=new M(z.Cp1251,22,"Cp1251","windows-1251"),M.Cp1252=new M(z.Cp1252,23,"Cp1252","windows-1252"),M.Cp1256=new M(z.Cp1256,24,"Cp1256","windows-1256"),M.UnicodeBigUnmarked=new M(z.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),M.UTF8=new M(z.UTF8,26,"UTF8","UTF-8"),M.ASCII=new M(z.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),M.Big5=new M(z.Big5,28,"Big5"),M.GB18030=new M(z.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),M.EUC_KR=new M(z.EUC_KR,30,"EUC_KR","EUC-KR");class ae extends C{}ae.kind="UnsupportedOperationException";class J{static decode(e,t){const n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)}static shouldDecodeOnFallback(e){return!J.isBrowser()&&e==="ISO-8859-1"}static encode(e,t){const n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(e){return typeof e=="string"?e:e.getName()}static encodingCharacterSet(e){return e instanceof M?e:M.getCharacterSetECIByName(e)}static decodeFallback(e,t){const n=this.encodingCharacterSet(t);if(J.isDecodeFallbackSupported(n)){let r="";for(let i=0,s=e.length;i<s;i++){let o=e[i].toString(16);o.length<2&&(o="0"+o),r+="%"+o}return decodeURIComponent(r)}if(n.equals(M.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new ae(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(M.UTF8)||e.equals(M.ISO8859_1)||e.equals(M.ASCII)}static encodeFallback(e){const n=btoa(unescape(encodeURIComponent(e))).split(""),r=[];for(let i=0;i<n.length;i++)r.push(n[i].charCodeAt(0));return new Uint8Array(r)}}class U{static castAsNonUtf8Char(e,t=null){const n=t?t.getName():this.ISO88591;return J.decode(new Uint8Array([e]),n)}static guessEncoding(e,t){if(t!=null&&t.get(W.CHARACTER_SET)!==void 0)return t.get(W.CHARACTER_SET).toString();const n=e.length;let r=!0,i=!0,s=!0,o=0,a=0,l=0,u=0,x=0,E=0,I=0,b=0,T=0,N=0,B=0;const V=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191;for(let H=0;H<n&&(r||i||s);H++){const F=e[H]&255;s&&(o>0?(F&128)===0?s=!1:o--:(F&128)!==0&&((F&64)===0?s=!1:(o++,(F&32)===0?a++:(o++,(F&16)===0?l++:(o++,(F&8)===0?u++:s=!1))))),r&&(F>127&&F<160?r=!1:F>159&&(F<192||F===215||F===247)&&B++),i&&(x>0?F<64||F===127||F>252?i=!1:x--:F===128||F===160||F>239?i=!1:F>160&&F<224?(E++,b=0,I++,I>T&&(T=I)):F>127?(x++,I=0,b++,b>N&&(N=b)):(I=0,b=0))}return s&&o>0&&(s=!1),i&&x>0&&(i=!1),s&&(V||a+l+u>0)?U.UTF8:i&&(U.ASSUME_SHIFT_JIS||T>=3||N>=3)?U.SHIFT_JIS:r&&i?T===2&&E===2||B*10>=n?U.SHIFT_JIS:U.ISO88591:r?U.ISO88591:i?U.SHIFT_JIS:s?U.UTF8:U.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let n=-1;function r(s,o,a,l,u,x){if(s==="%%")return"%";if(t[++n]===void 0)return;s=l?parseInt(l.substr(1)):void 0;let E=u?parseInt(u.substr(1)):void 0,I;switch(x){case"s":I=t[n];break;case"c":I=t[n][0];break;case"f":I=parseFloat(t[n]).toFixed(s);break;case"p":I=parseFloat(t[n]).toPrecision(s);break;case"e":I=parseFloat(t[n]).toExponential(s);break;case"x":I=parseInt(t[n]).toString(E||16);break;case"d":I=parseFloat(parseInt(t[n],E||10).toPrecision(s)).toFixed(0);break}I=typeof I=="object"?JSON.stringify(I):(+I).toString(E);let b=parseInt(a),T=a&&a[0]+""=="0"?"0":" ";for(;I.length<b;)I=o!==void 0?I+T:T+I;return I}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,r)}static getBytes(e,t){return J.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}U.SHIFT_JIS=M.SJIS.getName(),U.GB2312="GB2312",U.ISO88591=M.ISO8859_1.getName(),U.EUC_JP="EUC_JP",U.UTF8=M.UTF8.getName(),U.PLATFORM_DEFAULT_ENCODING=U.UTF8,U.ASSUME_SHIFT_JIS=!1;class Z{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=U.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,n){for(let r=t;t<t+n;r++)this.append(e[r]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class te{constructor(e,t,n,r){if(this.width=e,this.height=t,this.rowSize=n,this.bits=r,t==null&&(t=e),this.height=t,e<1||t<1)throw new R("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,r==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,n=e[0].length,r=new te(n,t);for(let i=0;i<t;i++){const s=e[i];for(let o=0;o<n;o++)s[o]&&r.set(o,i)}return r}static parseFromString(e,t,n){if(e===null)throw new R("stringRepresentation cannot be null");const r=new Array(e.length);let i=0,s=0,o=-1,a=0,l=0;for(;l<e.length;)if(e.charAt(l)===`
`||e.charAt(l)==="\r"){if(i>s){if(o===-1)o=i-s;else if(i-s!==o)throw new R("row lengths do not match");s=i,a++}l++}else if(e.substring(l,l+t.length)===t)l+=t.length,r[i]=!0,i++;else if(e.substring(l,l+n.length)===n)l+=n.length,r[i]=!1,i++;else throw new R("illegal character encountered: "+e.substring(l));if(i>s){if(o===-1)o=i-s;else if(i-s!==o)throw new R("row lengths do not match");a++}const u=new te(o,a);for(let x=0;x<i;x++)r[x]&&u.set(Math.floor(x%o),Math.floor(x/o));return u}get(e,t){const n=t*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0}set(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295}unset(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)}flip(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new R("input matrix dimensions do not match");const t=new K(Math.floor(this.width/32)+1),n=this.rowSize,r=this.bits;for(let i=0,s=this.height;i<s;i++){const o=i*n,a=e.getRow(i,t).getBitArray();for(let l=0;l<n;l++)r[o+l]^=a[l]}}clear(){const e=this.bits,t=e.length;for(let n=0;n<t;n++)e[n]=0}setRegion(e,t,n,r){if(t<0||e<0)throw new R("Left and top must be nonnegative");if(r<1||n<1)throw new R("Height and width must be at least 1");const i=e+n,s=t+r;if(s>this.height||i>this.width)throw new R("The region must fit inside the matrix");const o=this.rowSize,a=this.bits;for(let l=t;l<s;l++){const u=l*o;for(let x=e;x<i;x++)a[u+Math.floor(x/32)]|=1<<(x&31)&4294967295}}getRow(e,t){t==null||t.getSize()<this.width?t=new K(this.width):t.clear();const n=this.rowSize,r=this.bits,i=e*n;for(let s=0;s<n;s++)t.setBulk(s*32,r[i+s]);return t}setRow(e,t){q.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let n=new K(e),r=new K(e);for(let i=0,s=Math.floor((t+1)/2);i<s;i++)n=this.getRow(i,n),r=this.getRow(t-1-i,r),n.reverse(),r.reverse(),this.setRow(i,r),this.setRow(t-1-i,n)}getEnclosingRectangle(){const e=this.width,t=this.height,n=this.rowSize,r=this.bits;let i=e,s=t,o=-1,a=-1;for(let l=0;l<t;l++)for(let u=0;u<n;u++){const x=r[l*n+u];if(x!==0){if(l<s&&(s=l),l>a&&(a=l),u*32<i){let E=0;for(;(x<<31-E&4294967295)===0;)E++;u*32+E<i&&(i=u*32+E)}if(u*32+31>o){let E=31;for(;!(x>>>E);)E--;u*32+E>o&&(o=u*32+E)}}}return o<i||a<s?null:Int32Array.from([i,s,o-i+1,a-s+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let n=0;for(;n<t.length&&t[n]===0;)n++;if(n===t.length)return null;const r=n/e;let i=n%e*32;const s=t[n];let o=0;for(;(s<<31-o&4294967295)===0;)o++;return i+=o,Int32Array.from([i,r])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let n=t.length-1;for(;n>=0&&t[n]===0;)n--;if(n<0)return null;const r=Math.floor(n/e);let i=Math.floor(n%e)*32;const s=t[n];let o=31;for(;!(s>>>o);)o--;return i+=o,Int32Array.from([i,r])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof te))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&$.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+$.hashCode(this.bits),e}toString(e="X ",t="  ",n=`
`){return this.buildToString(e,t,n)}buildToString(e,t,n){let r=new Z;for(let i=0,s=this.height;i<s;i++){for(let o=0,a=this.width;o<a;o++)r.append(this.get(o,i)?e:t);r.append(n)}return r.toString()}clone(){return new te(this.width,this.height,this.rowSize,this.bits.slice())}}class v extends C{static getNotFoundInstance(){return new v}}v.kind="NotFoundException";class Be extends re{constructor(e){super(e),this.luminances=Be.EMPTY,this.buckets=new Int32Array(Be.LUMINANCE_BUCKETS)}getBlackRow(e,t){const n=this.getLuminanceSource(),r=n.getWidth();t==null||t.getSize()<r?t=new K(r):t.clear(),this.initArrays(r);const i=n.getRow(e,this.luminances),s=this.buckets;for(let a=0;a<r;a++)s[(i[a]&255)>>Be.LUMINANCE_SHIFT]++;const o=Be.estimateBlackPoint(s);if(r<3)for(let a=0;a<r;a++)(i[a]&255)<o&&t.set(a);else{let a=i[0]&255,l=i[1]&255;for(let u=1;u<r-1;u++){const x=i[u+1]&255;(l*4-a-x)/2<o&&t.set(u),a=l,l=x}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight(),r=new te(t,n);this.initArrays(t);const i=this.buckets;for(let a=1;a<5;a++){const l=Math.floor(n*a/5),u=e.getRow(l,this.luminances),x=Math.floor(t*4/5);for(let E=Math.floor(t/5);E<x;E++){const I=u[E]&255;i[I>>Be.LUMINANCE_SHIFT]++}}const s=Be.estimateBlackPoint(i),o=e.getMatrix();for(let a=0;a<n;a++){const l=a*t;for(let u=0;u<t;u++)(o[l+u]&255)<s&&r.set(u,a)}return r}createBinarizer(e){return new Be(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let n=0;n<Be.LUMINANCE_BUCKETS;n++)t[n]=0}static estimateBlackPoint(e){const t=e.length;let n=0,r=0,i=0;for(let u=0;u<t;u++)e[u]>i&&(r=u,i=e[u]),e[u]>n&&(n=e[u]);let s=0,o=0;for(let u=0;u<t;u++){const x=u-r,E=e[u]*x*x;E>o&&(s=u,o=E)}if(r>s){const u=r;r=s,s=u}if(s-r<=t/16)throw new v;let a=s-1,l=-1;for(let u=s-1;u>r;u--){const x=u-r,E=x*x*(s-u)*(n-e[u]);E>l&&(a=u,l=E)}return a<<Be.LUMINANCE_SHIFT}}Be.LUMINANCE_BITS=5,Be.LUMINANCE_SHIFT=8-Be.LUMINANCE_BITS,Be.LUMINANCE_BUCKETS=1<<Be.LUMINANCE_BITS,Be.EMPTY=Uint8ClampedArray.from([0]);class ue extends Be{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight();if(t>=ue.MINIMUM_DIMENSION&&n>=ue.MINIMUM_DIMENSION){const r=e.getMatrix();let i=t>>ue.BLOCK_SIZE_POWER;(t&ue.BLOCK_SIZE_MASK)!==0&&i++;let s=n>>ue.BLOCK_SIZE_POWER;(n&ue.BLOCK_SIZE_MASK)!==0&&s++;const o=ue.calculateBlackPoints(r,i,s,t,n),a=new te(t,n);ue.calculateThresholdForBlock(r,i,s,t,n,o,a),this.matrix=a}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new ue(e)}static calculateThresholdForBlock(e,t,n,r,i,s,o){const a=i-ue.BLOCK_SIZE,l=r-ue.BLOCK_SIZE;for(let u=0;u<n;u++){let x=u<<ue.BLOCK_SIZE_POWER;x>a&&(x=a);const E=ue.cap(u,2,n-3);for(let I=0;I<t;I++){let b=I<<ue.BLOCK_SIZE_POWER;b>l&&(b=l);const T=ue.cap(I,2,t-3);let N=0;for(let V=-2;V<=2;V++){const H=s[E+V];N+=H[T-2]+H[T-1]+H[T]+H[T+1]+H[T+2]}const B=N/25;ue.thresholdBlock(e,b,x,B,r,o)}}}static cap(e,t,n){return e<t?t:e>n?n:e}static thresholdBlock(e,t,n,r,i,s){for(let o=0,a=n*i+t;o<ue.BLOCK_SIZE;o++,a+=i)for(let l=0;l<ue.BLOCK_SIZE;l++)(e[a+l]&255)<=r&&s.set(t+l,n+o)}static calculateBlackPoints(e,t,n,r,i){const s=i-ue.BLOCK_SIZE,o=r-ue.BLOCK_SIZE,a=new Array(n);for(let l=0;l<n;l++){a[l]=new Int32Array(t);let u=l<<ue.BLOCK_SIZE_POWER;u>s&&(u=s);for(let x=0;x<t;x++){let E=x<<ue.BLOCK_SIZE_POWER;E>o&&(E=o);let I=0,b=255,T=0;for(let B=0,V=u*r+E;B<ue.BLOCK_SIZE;B++,V+=r){for(let H=0;H<ue.BLOCK_SIZE;H++){const F=e[V+H]&255;I+=F,F<b&&(b=F),F>T&&(T=F)}if(T-b>ue.MIN_DYNAMIC_RANGE)for(B++,V+=r;B<ue.BLOCK_SIZE;B++,V+=r)for(let H=0;H<ue.BLOCK_SIZE;H++)I+=e[V+H]&255}let N=I>>ue.BLOCK_SIZE_POWER*2;if(T-b<=ue.MIN_DYNAMIC_RANGE&&(N=b/2,l>0&&x>0)){const B=(a[l-1][x]+2*a[l][x-1]+a[l-1][x-1])/4;b<B&&(N=B)}a[l][x]=N}}return a}}ue.BLOCK_SIZE_POWER=3,ue.BLOCK_SIZE=1<<ue.BLOCK_SIZE_POWER,ue.BLOCK_SIZE_MASK=ue.BLOCK_SIZE-1,ue.MINIMUM_DIMENSION=ue.BLOCK_SIZE*5,ue.MIN_DYNAMIC_RANGE=24;class vt{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,n,r){throw new ae("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new ae("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new ae("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new Z;for(let n=0;n<this.height;n++){const r=this.getRow(n,e);for(let i=0;i<this.width;i++){const s=r[i]&255;let o;s<64?o="#":s<128?o="+":s<192?o=".":o=" ",t.append(o)}t.append(`
`)}return t.toString()}}class pt extends vt{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const n=this.delegate.getRow(e,t),r=this.getWidth();for(let i=0;i<r;i++)n[i]=255-(n[i]&255);return n}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(t);for(let r=0;r<t;r++)n[r]=255-(e[r]&255);return n}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,n,r){return new pt(this.delegate.crop(e,t,n,r))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new pt(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new pt(this.delegate.rotateCounterClockwise45())}}class ht extends vt{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=ht.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return ht.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,n){const r=new Uint8ClampedArray(t*n);for(let i=0,s=0,o=e.length;i<o;i+=4,s++){let a;if(e[i+3]===0)a=255;else{const u=e[i],x=e[i+1],E=e[i+2];a=306*u+601*x+117*E+512>>10}r[s]=a}return r}getRow(e,t){if(e<0||e>=this.getHeight())throw new R("Requested row is outside the image: "+e);const n=this.getWidth(),r=e*n;return t===null?t=this.buffer.slice(r,r+n):(t.length<n&&(t=new Uint8ClampedArray(n)),t.set(this.buffer.slice(r,r+n))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,n,r){return super.crop(e,t,n,r),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),n=t.getContext("2d"),r=e*ht.DEGREE_TO_RADIANS,i=this.canvas.width,s=this.canvas.height,o=Math.ceil(Math.abs(Math.cos(r))*i+Math.abs(Math.sin(r))*s),a=Math.ceil(Math.abs(Math.sin(r))*i+Math.abs(Math.cos(r))*s);return t.width=o,t.height=a,n.translate(o/2,a/2),n.rotate(r),n.drawImage(this.canvas,i/-2,s/-2),this.buffer=ht.makeBufferFromCanvasImageData(t),this}invert(){return new pt(this)}}ht.DEGREE_TO_RADIANS=Math.PI/180;class Wt{constructor(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Ye=(globalThis||Fn||self||window||void 0)&&(globalThis||Fn||self||window||void 0).__awaiter||function(g,e,t,n){function r(i){return i instanceof t?i:new t(function(s){s(i)})}return new(t||(t=Promise))(function(i,s){function o(u){try{l(n.next(u))}catch(x){s(x)}}function a(u){try{l(n.throw(u))}catch(x){s(x)}}function l(u){u.done?i(u.value):r(u.value).then(o,a)}l((n=n.apply(g,e||[])).next())})};class Et{constructor(e,t=500,n){this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return Ye(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const n of e){const r=n.kind==="video"?"videoinput":n.kind;if(r!=="videoinput")continue;const i=n.deviceId||n.id,s=n.label||`Video device ${t.length+1}`,o=n.groupId,a={deviceId:i,label:s,kind:r,groupId:o};t.push(a)}return t})}getVideoInputDevices(){return Ye(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(t=>new Wt(t.deviceId,t.label))})}findDeviceById(e){return Ye(this,void 0,void 0,function*(){const t=yield this.listVideoInputDevices();return t?t.find(n=>n.deviceId===e):null})}decodeFromInputVideoDevice(e,t){return Ye(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,t)})}decodeOnceFromVideoDevice(e,t){return Ye(this,void 0,void 0,function*(){this.reset();let n;e?n={deviceId:{exact:e}}:n={facingMode:"environment"};const r={video:n};return yield this.decodeOnceFromConstraints(r,t)})}decodeOnceFromConstraints(e,t){return Ye(this,void 0,void 0,function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(n,t)})}decodeOnceFromStream(e,t){return Ye(this,void 0,void 0,function*(){this.reset();const n=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(n)})}decodeFromInputVideoDeviceContinuously(e,t,n){return Ye(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,t,n)})}decodeFromVideoDevice(e,t,n){return Ye(this,void 0,void 0,function*(){let r;e?r={deviceId:{exact:e}}:r={facingMode:"environment"};const i={video:r};return yield this.decodeFromConstraints(i,t,n)})}decodeFromConstraints(e,t,n){return Ye(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(r,t,n)})}decodeFromStream(e,t,n){return Ye(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(r,n)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return Ye(this,void 0,void 0,function*(){const n=this.prepareVideoElement(t);return this.addVideoSource(n,e),this.videoElement=n,this.stream=e,yield this.playVideoOnLoadAsync(n),n})}playVideoOnLoadAsync(e){return new Promise((t,n)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return Ye(this,void 0,void 0,function*(){if(this.isVideoPlaying(e)){console.warn("Trying to play video that is already playing.");return}try{yield e.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(e,t){const n=document.getElementById(e);if(!n)throw new O(`element with id '${e}' not found`);if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new O(`element with id '${e}' must be an ${t} element`);return n}decodeFromImage(e,t){if(!e&&!t)throw new O("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new O("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,n){if(e===void 0&&t===void 0)throw new O("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)}decodeFromImageElement(e){if(!e)throw new O("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);this.imageElement=t;let n;return this.isImageLoaded(t)?n=this.decodeOnce(t,!1,!0):n=this._decodeOnLoadImage(t),n}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)}_decodeFromVideoElementSetup(e){if(!e)throw new O("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new O("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const n=this._decodeOnLoadImage(t);return t.src=e,n}decodeFromVideoUrl(e){if(!e)throw new O("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n}decodeFromVideoUrlContinuously(e,t){if(!e)throw new O("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),r=this.decodeFromVideoElementContinuously(n,t);return n.src=e,r}_decodeOnLoadImage(e){return new Promise((t,n)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,n),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return Ye(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,t){return Ye(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)})}isImageLoaded(e){return!(!e.complete||e.naturalWidth===0)}prepareImageElement(e){let t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,n=!0){this._stopAsyncDecode=!1;const r=(i,s)=>{if(this._stopAsyncDecode){s(new v("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const o=this.decode(e);i(o)}catch(o){const a=t&&o instanceof v,u=(o instanceof k||o instanceof P)&&n;if(a||u)return setTimeout(r,this._timeBetweenDecodingAttempts,i,s);s(o)}};return new Promise((i,s)=>r(i,s))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const n=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const r=this.decode(e);t(r,null),setTimeout(n,this.timeBetweenScansMillis)}catch(r){t(null,r);const i=r instanceof k||r instanceof P,s=r instanceof v;(i||s)&&setTimeout(n,this._timeBetweenDecodingAttempts)}};n()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}_isHTMLVideoElement(e){return e.videoWidth!==0}drawFrameOnCanvas(e,t,n){t||(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}drawImageOnCanvas(e,t,n=this.captureCanvasContext){t||(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),n=new ht(t),r=new ue(n);return new Y(r)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const n=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=n}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let n,r;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,r=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,r=e.naturalHeight||e.height)),t.style.width=n+"px",t.style.height=r+"px",t.width=n,t.height=r,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")}}class Ke{constructor(e,t,n=t==null?0:8*t.length,r,i,s=q.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=r,this.format=i,this.timestamp=s,this.text=e,this.rawBytes=t,n==null?this.numBits=t==null?0:8*t.length:this.numBits=n,this.resultPoints=r,this.format=i,this.resultMetadata=null,s==null?this.timestamp=q.currentTimeMillis():this.timestamp=s}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){const n=new Array(t.length+e.length);q.arraycopy(t,0,n,0,t.length),q.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Xt;(function(g){g[g.AZTEC=0]="AZTEC",g[g.CODABAR=1]="CODABAR",g[g.CODE_39=2]="CODE_39",g[g.CODE_93=3]="CODE_93",g[g.CODE_128=4]="CODE_128",g[g.DATA_MATRIX=5]="DATA_MATRIX",g[g.EAN_8=6]="EAN_8",g[g.EAN_13=7]="EAN_13",g[g.ITF=8]="ITF",g[g.MAXICODE=9]="MAXICODE",g[g.PDF_417=10]="PDF_417",g[g.QR_CODE=11]="QR_CODE",g[g.RSS_14=12]="RSS_14",g[g.RSS_EXPANDED=13]="RSS_EXPANDED",g[g.UPC_A=14]="UPC_A",g[g.UPC_E=15]="UPC_E",g[g.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Xt||(Xt={}));var ie=Xt,ct;(function(g){g[g.OTHER=0]="OTHER",g[g.ORIENTATION=1]="ORIENTATION",g[g.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",g[g.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",g[g.ISSUE_NUMBER=4]="ISSUE_NUMBER",g[g.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",g[g.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",g[g.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",g[g.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",g[g.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",g[g.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ct||(ct={}));var be=ct;class dt{constructor(e,t,n,r,i=-1,s=-1){this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=r,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=s,this.numBits=e==null?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Dt{exp(e){return this.expTable[e]}log(e){if(e===0)throw new R;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class rt{constructor(e,t){if(t.length===0)throw new R;this.field=e;const n=t.length;if(n>1&&t[0]===0){let r=1;for(;r<n&&t[r]===0;)r++;r===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-r),q.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);const t=this.coefficients;let n;if(e===1){n=0;for(let s=0,o=t.length;s!==o;s++){const a=t[s];n=Dt.addOrSubtract(n,a)}return n}n=t[0];const r=t.length,i=this.field;for(let s=1;s<r;s++)n=Dt.addOrSubtract(i.multiply(e,n),t[s]);return n}addOrSubtract(e){if(!this.field.equals(e.field))throw new R("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){const s=t;t=n,n=s}let r=new Int32Array(n.length);const i=n.length-t.length;q.arraycopy(n,0,r,0,i);for(let s=i;s<n.length;s++)r[s]=Dt.addOrSubtract(t[s-i],n[s]);return new rt(this.field,r)}multiply(e){if(!this.field.equals(e.field))throw new R("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,s=new Int32Array(n+i-1),o=this.field;for(let a=0;a<n;a++){const l=t[a];for(let u=0;u<i;u++)s[a+u]=Dt.addOrSubtract(s[a+u],o.multiply(l,r[u]))}return new rt(o,s)}multiplyScalar(e){if(e===0)return this.field.getZero();if(e===1)return this;const t=this.coefficients.length,n=this.field,r=new Int32Array(t),i=this.coefficients;for(let s=0;s<t;s++)r[s]=n.multiply(i[s],e);return new rt(n,r)}multiplyByMonomial(e,t){if(e<0)throw new R;if(t===0)return this.field.getZero();const n=this.coefficients,r=n.length,i=new Int32Array(r+e),s=this.field;for(let o=0;o<r;o++)i[o]=s.multiply(n[o],t);return new rt(s,i)}divide(e){if(!this.field.equals(e.field))throw new R("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new R("Divide by 0");const t=this.field;let n=t.getZero(),r=this;const i=e.getCoefficient(e.getDegree()),s=t.inverse(i);for(;r.getDegree()>=e.getDegree()&&!r.isZero();){const o=r.getDegree()-e.getDegree(),a=t.multiply(r.getCoefficient(r.getDegree()),s),l=e.multiplyByMonomial(o,a),u=t.buildMonomial(o,a);n=n.addOrSubtract(u),r=r.addOrSubtract(l)}return[n,r]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),t===0||n!==1){const r=this.field.log(n);r===0?e+="1":r===1?e+="a":(e+="a^",e+=r)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e}}class yn extends C{}yn.kind="ArithmeticException";class Ee extends Dt{constructor(e,t,n){super(),this.primitive=e,this.size=t,this.generatorBase=n;const r=new Int32Array(t);let i=1;for(let o=0;o<t;o++)r[o]=i,i*=2,i>=t&&(i^=e,i&=t-1);this.expTable=r;const s=new Int32Array(t);for(let o=0;o<t-1;o++)s[r[o]]=o;this.logTable=s,this.zero=new rt(this,Int32Array.from([0])),this.one=new rt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new R;if(t===0)return this.zero;const n=new Int32Array(e+1);return n[0]=t,new rt(this,n)}inverse(e){if(e===0)throw new yn;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+G.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}Ee.AZTEC_DATA_12=new Ee(4201,4096,1),Ee.AZTEC_DATA_10=new Ee(1033,1024,1),Ee.AZTEC_DATA_6=new Ee(67,64,1),Ee.AZTEC_PARAM=new Ee(19,16,1),Ee.QR_CODE_FIELD_256=new Ee(285,256,0),Ee.DATA_MATRIX_FIELD_256=new Ee(301,256,1),Ee.AZTEC_DATA_8=Ee.DATA_MATRIX_FIELD_256,Ee.MAXICODE_FIELD_64=Ee.AZTEC_DATA_6;class $t extends C{}$t.kind="ReedSolomonException";class bt extends C{}bt.kind="IllegalStateException";class hn{constructor(e){this.field=e}decode(e,t){const n=this.field,r=new rt(n,e),i=new Int32Array(t);let s=!0;for(let I=0;I<t;I++){const b=r.evaluateAt(n.exp(I+n.getGeneratorBase()));i[i.length-1-I]=b,b!==0&&(s=!1)}if(s)return;const o=new rt(n,i),a=this.runEuclideanAlgorithm(n.buildMonomial(t,1),o,t),l=a[0],u=a[1],x=this.findErrorLocations(l),E=this.findErrorMagnitudes(u,x);for(let I=0;I<x.length;I++){const b=e.length-1-n.log(x[I]);if(b<0)throw new $t("Bad error location");e[b]=Ee.addOrSubtract(e[b],E[I])}}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){const I=e;e=t,t=I}const r=this.field;let i=e,s=t,o=r.getZero(),a=r.getOne();for(;s.getDegree()>=(n/2|0);){let I=i,b=o;if(i=s,o=a,i.isZero())throw new $t("r_{i-1} was zero");s=I;let T=r.getZero();const N=i.getCoefficient(i.getDegree()),B=r.inverse(N);for(;s.getDegree()>=i.getDegree()&&!s.isZero();){const V=s.getDegree()-i.getDegree(),H=r.multiply(s.getCoefficient(s.getDegree()),B);T=T.addOrSubtract(r.buildMonomial(V,H)),s=s.addOrSubtract(i.multiplyByMonomial(V,H))}if(a=T.multiply(o).addOrSubtract(b),s.getDegree()>=i.getDegree())throw new bt("Division algorithm failed to reduce polynomial?")}const l=a.getCoefficient(0);if(l===0)throw new $t("sigmaTilde(0) was zero");const u=r.inverse(l),x=a.multiplyScalar(u),E=s.multiplyScalar(u);return[x,E]}findErrorLocations(e){const t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);const n=new Int32Array(t);let r=0;const i=this.field;for(let s=1;s<i.getSize()&&r<t;s++)e.evaluateAt(s)===0&&(n[r]=i.inverse(s),r++);if(r!==t)throw new $t("Error locator degree does not match number of roots");return n}findErrorMagnitudes(e,t){const n=t.length,r=new Int32Array(n),i=this.field;for(let s=0;s<n;s++){const o=i.inverse(t[s]);let a=1;for(let l=0;l<n;l++)if(s!==l){const u=i.multiply(t[l],o),x=(u&1)===0?u|1:u&-2;a=i.multiply(a,x)}r[s]=i.multiply(e.evaluateAt(o),i.inverse(a)),i.getGeneratorBase()!==0&&(r[s]=i.multiply(r[s],o))}return r}}var qe;(function(g){g[g.UPPER=0]="UPPER",g[g.LOWER=1]="LOWER",g[g.MIXED=2]="MIXED",g[g.DIGIT=3]="DIGIT",g[g.PUNCT=4]="PUNCT",g[g.BINARY=5]="BINARY"})(qe||(qe={}));class Re{decode(e){this.ddata=e;let t=e.getBits(),n=this.extractBits(t),r=this.correctBits(n),i=Re.convertBoolArrayToByteArray(r),s=Re.getEncodedData(r),o=new dt(i,s,null,null);return o.setNumBits(r.length),o}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,n=qe.UPPER,r=qe.UPPER,i="",s=0;for(;s<t;)if(r===qe.BINARY){if(t-s<5)break;let o=Re.readCode(e,s,5);if(s+=5,o===0){if(t-s<11)break;o=Re.readCode(e,s,11)+31,s+=11}for(let a=0;a<o;a++){if(t-s<8){s=t;break}const l=Re.readCode(e,s,8);i+=U.castAsNonUtf8Char(l),s+=8}r=n}else{let o=r===qe.DIGIT?4:5;if(t-s<o)break;let a=Re.readCode(e,s,o);s+=o;let l=Re.getCharacter(r,a);l.startsWith("CTRL_")?(n=r,r=Re.getTable(l.charAt(5)),l.charAt(6)==="L"&&(n=r)):(i+=l,r=n)}return i}static getTable(e){switch(e){case"L":return qe.LOWER;case"P":return qe.PUNCT;case"M":return qe.MIXED;case"D":return qe.DIGIT;case"B":return qe.BINARY;case"U":default:return qe.UPPER}}static getCharacter(e,t){switch(e){case qe.UPPER:return Re.UPPER_TABLE[t];case qe.LOWER:return Re.LOWER_TABLE[t];case qe.MIXED:return Re.MIXED_TABLE[t];case qe.PUNCT:return Re.PUNCT_TABLE[t];case qe.DIGIT:return Re.DIGIT_TABLE[t];default:throw new bt("Bad table")}}correctBits(e){let t,n;this.ddata.getNbLayers()<=2?(n=6,t=Ee.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,t=Ee.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,t=Ee.AZTEC_DATA_10):(n=12,t=Ee.AZTEC_DATA_12);let r=this.ddata.getNbDatablocks(),i=e.length/n;if(i<r)throw new P;let s=e.length%n,o=new Int32Array(i);for(let E=0;E<i;E++,s+=n)o[E]=Re.readCode(e,s,n);try{new hn(t).decode(o,i-r)}catch(E){throw new P(E)}let a=(1<<n)-1,l=0;for(let E=0;E<r;E++){let I=o[E];if(I===0||I===a)throw new P;(I===1||I===a-1)&&l++}let u=new Array(r*n-l),x=0;for(let E=0;E<r;E++){let I=o[E];if(I===1||I===a-1)u.fill(I>1,x,x+n-1),x+=n-1;else for(let b=n-1;b>=0;--b)u[x++]=(I&1<<b)!==0}return u}extractBits(e){let t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),r=(t?11:14)+n*4,i=new Int32Array(r),s=new Array(this.totalBitsInLayer(n,t));if(t)for(let o=0;o<i.length;o++)i[o]=o;else{let o=r+1+2*G.truncDivision(G.truncDivision(r,2)-1,15),a=r/2,l=G.truncDivision(o,2);for(let u=0;u<a;u++){let x=u+G.truncDivision(u,15);i[a-u-1]=l-x-1,i[a+u]=l+x+1}}for(let o=0,a=0;o<n;o++){let l=(n-o)*4+(t?9:12),u=o*2,x=r-1-u;for(let E=0;E<l;E++){let I=E*2;for(let b=0;b<2;b++)s[a+I+b]=e.get(i[u+b],i[u+E]),s[a+2*l+I+b]=e.get(i[u+E],i[x-b]),s[a+4*l+I+b]=e.get(i[x-b],i[x-E]),s[a+6*l+I+b]=e.get(i[x-E],i[u+b])}a+=l*8}return s}static readCode(e,t,n){let r=0;for(let i=t;i<t+n;i++)r<<=1,e[i]&&(r|=1);return r}static readByte(e,t){let n=e.length-t;return n>=8?Re.readCode(e,t,8):Re.readCode(e,t,n)<<8-n}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let n=0;n<t.length;n++)t[n]=Re.readByte(e,8*n);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Re.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Re.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Re.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Re.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Re.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class we{constructor(){}static round(e){return e===NaN?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,n,r){const i=e-n,s=t-r;return Math.sqrt(i*i+s*s)}static sum(e){let t=0;for(let n=0,r=e.length;n!==r;n++){const i=e[n];t+=i}return t}}class Tn{static floatToIntBits(e){return e}}Tn.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ee{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof ee){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*Tn.floatToIntBits(this.x)+Tn.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),r=this.distance(e[0],e[2]);let i,s,o;if(n>=t&&n>=r?(s=e[0],i=e[1],o=e[2]):r>=n&&r>=t?(s=e[1],i=e[0],o=e[2]):(s=e[2],i=e[0],o=e[1]),this.crossProductZ(i,s,o)<0){const a=i;i=o,o=a}e[0]=i,e[1]=s,e[2]=o}static distance(e,t){return we.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,n){const r=t.x,i=t.y;return(n.x-r)*(e.y-i)-(n.y-i)*(e.x-r)}}class Sn{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class vr extends Sn{constructor(e,t,n,r,i){super(e,t),this.compact=n,this.nbDatablocks=r,this.nbLayers=i}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Mt{constructor(e,t,n,r){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=Mt.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),r==null&&(r=e.getHeight()/2|0);const i=t/2|0;if(this.leftInit=n-i,this.rightInit=n+i,this.upInit=r-i,this.downInit=r+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new v}detect(){let e=this.leftInit,t=this.rightInit,n=this.upInit,r=this.downInit,i=!1,s=!0,o=!1,a=!1,l=!1,u=!1,x=!1;const E=this.width,I=this.height;for(;s;){s=!1;let b=!0;for(;(b||!a)&&t<E;)b=this.containsBlackPoint(n,r,t,!1),b?(t++,s=!0,a=!0):a||t++;if(t>=E){i=!0;break}let T=!0;for(;(T||!l)&&r<I;)T=this.containsBlackPoint(e,t,r,!0),T?(r++,s=!0,l=!0):l||r++;if(r>=I){i=!0;break}let N=!0;for(;(N||!u)&&e>=0;)N=this.containsBlackPoint(n,r,e,!1),N?(e--,s=!0,u=!0):u||e--;if(e<0){i=!0;break}let B=!0;for(;(B||!x)&&n>=0;)B=this.containsBlackPoint(e,t,n,!0),B?(n--,s=!0,x=!0):x||n--;if(n<0){i=!0;break}s&&(o=!0)}if(!i&&o){const b=t-e;let T=null;for(let H=1;T===null&&H<b;H++)T=this.getBlackPointOnSegment(e,r-H,e+H,r);if(T==null)throw new v;let N=null;for(let H=1;N===null&&H<b;H++)N=this.getBlackPointOnSegment(e,n+H,e+H,n);if(N==null)throw new v;let B=null;for(let H=1;B===null&&H<b;H++)B=this.getBlackPointOnSegment(t,n+H,t-H,n);if(B==null)throw new v;let V=null;for(let H=1;V===null&&H<b;H++)V=this.getBlackPointOnSegment(t,r-H,t-H,r);if(V==null)throw new v;return this.centerEdges(V,T,B,N)}else throw new v}getBlackPointOnSegment(e,t,n,r){const i=we.round(we.distance(e,t,n,r)),s=(n-e)/i,o=(r-t)/i,a=this.image;for(let l=0;l<i;l++){const u=we.round(e+l*s),x=we.round(t+l*o);if(a.get(u,x))return new ee(u,x)}return null}centerEdges(e,t,n,r){const i=e.getX(),s=e.getY(),o=t.getX(),a=t.getY(),l=n.getX(),u=n.getY(),x=r.getX(),E=r.getY(),I=Mt.CORR;return i<this.width/2?[new ee(x-I,E+I),new ee(o+I,a+I),new ee(l-I,u-I),new ee(i+I,s-I)]:[new ee(x+I,E+I),new ee(o+I,a-I),new ee(l-I,u+I),new ee(i-I,s-I)]}containsBlackPoint(e,t,n,r){const i=this.image;if(r){for(let s=e;s<=t;s++)if(i.get(s,n))return!0}else for(let s=e;s<=t;s++)if(i.get(n,s))return!0;return!1}}Mt.INIT_SIZE=10,Mt.CORR=1;class Hn{static checkAndNudgePoints(e,t){const n=e.getWidth(),r=e.getHeight();let i=!0;for(let s=0;s<t.length&&i;s+=2){const o=Math.floor(t[s]),a=Math.floor(t[s+1]);if(o<-1||o>n||a<-1||a>r)throw new v;i=!1,o===-1?(t[s]=0,i=!0):o===n&&(t[s]=n-1,i=!0),a===-1?(t[s+1]=0,i=!0):a===r&&(t[s+1]=r-1,i=!0)}i=!0;for(let s=t.length-2;s>=0&&i;s-=2){const o=Math.floor(t[s]),a=Math.floor(t[s+1]);if(o<-1||o>n||a<-1||a>r)throw new v;i=!1,o===-1?(t[s]=0,i=!0):o===n&&(t[s]=n-1,i=!0),a===-1?(t[s+1]=0,i=!0):a===r&&(t[s+1]=r-1,i=!0)}}}class Ct{constructor(e,t,n,r,i,s,o,a,l){this.a11=e,this.a21=t,this.a31=n,this.a12=r,this.a22=i,this.a32=s,this.a13=o,this.a23=a,this.a33=l}static quadrilateralToQuadrilateral(e,t,n,r,i,s,o,a,l,u,x,E,I,b,T,N){const B=Ct.quadrilateralToSquare(e,t,n,r,i,s,o,a);return Ct.squareToQuadrilateral(l,u,x,E,I,b,T,N).times(B)}transformPoints(e){const t=e.length,n=this.a11,r=this.a12,i=this.a13,s=this.a21,o=this.a22,a=this.a23,l=this.a31,u=this.a32,x=this.a33;for(let E=0;E<t;E+=2){const I=e[E],b=e[E+1],T=i*I+a*b+x;e[E]=(n*I+s*b+l)/T,e[E+1]=(r*I+o*b+u)/T}}transformPointsWithValues(e,t){const n=this.a11,r=this.a12,i=this.a13,s=this.a21,o=this.a22,a=this.a23,l=this.a31,u=this.a32,x=this.a33,E=e.length;for(let I=0;I<E;I++){const b=e[I],T=t[I],N=i*b+a*T+x;e[I]=(n*b+s*T+l)/N,t[I]=(r*b+o*T+u)/N}}static squareToQuadrilateral(e,t,n,r,i,s,o,a){const l=e-n+i-o,u=t-r+s-a;if(l===0&&u===0)return new Ct(n-e,i-n,e,r-t,s-r,t,0,0,1);{const x=n-i,E=o-i,I=r-s,b=a-s,T=x*b-E*I,N=(l*b-E*u)/T,B=(x*u-l*I)/T;return new Ct(n-e+N*n,o-e+B*o,e,r-t+N*r,a-t+B*a,t,N,B,1)}}static quadrilateralToSquare(e,t,n,r,i,s,o,a){return Ct.squareToQuadrilateral(e,t,n,r,i,s,o,a).buildAdjoint()}buildAdjoint(){return new Ct(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new Ct(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class Pr extends Hn{sampleGrid(e,t,n,r,i,s,o,a,l,u,x,E,I,b,T,N,B,V,H){const F=Ct.quadrilateralToQuadrilateral(r,i,s,o,a,l,u,x,E,I,b,T,N,B,V,H);return this.sampleGridWithTransform(e,t,n,F)}sampleGridWithTransform(e,t,n,r){if(t<=0||n<=0)throw new v;const i=new te(t,n),s=new Float32Array(2*t);for(let o=0;o<n;o++){const a=s.length,l=o+.5;for(let u=0;u<a;u+=2)s[u]=u/2+.5,s[u+1]=l;r.transformPoints(s),Hn.checkAndNudgePoints(e,s);try{for(let u=0;u<a;u+=2)e.get(Math.floor(s[u]),Math.floor(s[u+1]))&&i.set(u/2,o)}catch{throw new v}}return i}}class Pt{static setGridSampler(e){Pt.gridSampler=e}static getInstance(){return Pt.gridSampler}}Pt.gridSampler=new Pr;class tt{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new ee(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Lr{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){let s=n[0];n[0]=n[2],n[2]=s}this.extractParameters(n);let r=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),i=this.getMatrixCornerPoints(n);return new vr(r,i,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new v;let t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);let r=0;for(let s=0;s<4;s++){let o=n[(this.shift+s)%4];this.compact?(r<<=7,r+=o>>1&127):(r<<=10,r+=(o>>2&992)+(o>>1&31))}let i=this.getCorrectedParameterData(r,this.compact);this.compact?(this.nbLayers=(i>>6)+1,this.nbDataBlocks=(i&63)+1):(this.nbLayers=(i>>11)+1,this.nbDataBlocks=(i&2047)+1)}getRotation(e,t){let n=0;e.forEach((r,i,s)=>{let o=(r>>t-2<<1)+(r&1);n=(n<<3)+o}),n=((n&1)<<11)+(n>>1);for(let r=0;r<4;r++)if(G.bitCount(n^this.EXPECTED_CORNER_BITS[r])<=2)return r;throw new v}getCorrectedParameterData(e,t){let n,r;t?(n=7,r=2):(n=10,r=4);let i=n-r,s=new Int32Array(n);for(let a=n-1;a>=0;--a)s[a]=e&15,e>>=4;try{new hn(Ee.AZTEC_PARAM).decode(s,i)}catch{throw new v}let o=0;for(let a=0;a<r;a++)o=(o<<4)+s[a];return o}getBullsEyeCorners(e){let t=e,n=e,r=e,i=e,s=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let x=this.getFirstDifferent(t,s,1,-1),E=this.getFirstDifferent(n,s,1,1),I=this.getFirstDifferent(r,s,-1,1),b=this.getFirstDifferent(i,s,-1,-1);if(this.nbCenterLayers>2){let T=this.distancePoint(b,x)*this.nbCenterLayers/(this.distancePoint(i,t)*(this.nbCenterLayers+2));if(T<.75||T>1.25||!this.isWhiteOrBlackRectangle(x,E,I,b))break}t=x,n=E,r=I,i=b,s=!s}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new v;this.compact=this.nbCenterLayers===5;let o=new ee(t.getX()+.5,t.getY()-.5),a=new ee(n.getX()+.5,n.getY()+.5),l=new ee(r.getX()-.5,r.getY()+.5),u=new ee(i.getX()-.5,i.getY()-.5);return this.expandSquare([o,a,l,u],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,n,r;try{let o=new Mt(this.image).detect();e=o[0],t=o[1],n=o[2],r=o[3]}catch{let a=this.image.getWidth()/2,l=this.image.getHeight()/2;e=this.getFirstDifferent(new tt(a+7,l-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new tt(a+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new tt(a-7,l+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new tt(a-7,l-7),!1,-1,-1).toResultPoint()}let i=we.round((e.getX()+r.getX()+t.getX()+n.getX())/4),s=we.round((e.getY()+r.getY()+t.getY()+n.getY())/4);try{let o=new Mt(this.image,15,i,s).detect();e=o[0],t=o[1],n=o[2],r=o[3]}catch{e=this.getFirstDifferent(new tt(i+7,s-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new tt(i+7,s+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new tt(i-7,s+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new tt(i-7,s-7),!1,-1,-1).toResultPoint()}return i=we.round((e.getX()+r.getX()+t.getX()+n.getX())/4),s=we.round((e.getY()+r.getY()+t.getY()+n.getY())/4),new tt(i,s)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,n,r,i){let s=Pt.getInstance(),o=this.getDimension(),a=o/2-this.nbCenterLayers,l=o/2+this.nbCenterLayers;return s.sampleGrid(e,o,o,a,a,l,a,l,l,a,l,t.getX(),t.getY(),n.getX(),n.getY(),r.getX(),r.getY(),i.getX(),i.getY())}sampleLine(e,t,n){let r=0,i=this.distanceResultPoint(e,t),s=i/n,o=e.getX(),a=e.getY(),l=s*(t.getX()-e.getX())/i,u=s*(t.getY()-e.getY())/i;for(let x=0;x<n;x++)this.image.get(we.round(o+x*l),we.round(a+x*u))&&(r|=1<<n-x-1);return r}isWhiteOrBlackRectangle(e,t,n,r){let i=3;e=new tt(e.getX()-i,e.getY()+i),t=new tt(t.getX()-i,t.getY()-i),n=new tt(n.getX()+i,n.getY()-i),r=new tt(r.getX()+i,r.getY()+i);let s=this.getColor(r,e);if(s===0)return!1;let o=this.getColor(e,t);return o!==s||(o=this.getColor(t,n),o!==s)?!1:(o=this.getColor(n,r),o===s)}getColor(e,t){let n=this.distancePoint(e,t),r=(t.getX()-e.getX())/n,i=(t.getY()-e.getY())/n,s=0,o=e.getX(),a=e.getY(),l=this.image.get(e.getX(),e.getY()),u=Math.ceil(n);for(let E=0;E<u;E++)o+=r,a+=i,this.image.get(we.round(o),we.round(a))!==l&&s++;let x=s/n;return x>.1&&x<.9?0:x<=.1===l?1:-1}getFirstDifferent(e,t,n,r){let i=e.getX()+n,s=e.getY()+r;for(;this.isValid(i,s)&&this.image.get(i,s)===t;)i+=n,s+=r;for(i-=n,s-=r;this.isValid(i,s)&&this.image.get(i,s)===t;)i+=n;for(i-=n;this.isValid(i,s)&&this.image.get(i,s)===t;)s+=r;return s-=r,new tt(i,s)}expandSquare(e,t,n){let r=n/(2*t),i=e[0].getX()-e[2].getX(),s=e[0].getY()-e[2].getY(),o=(e[0].getX()+e[2].getX())/2,a=(e[0].getY()+e[2].getY())/2,l=new ee(o+r*i,a+r*s),u=new ee(o-r*i,a-r*s);i=e[1].getX()-e[3].getX(),s=e[1].getY()-e[3].getY(),o=(e[1].getX()+e[3].getX())/2,a=(e[1].getY()+e[3].getY())/2;let x=new ee(o+r*i,a+r*s),E=new ee(o-r*i,a-r*s);return[l,x,u,E]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=we.round(e.getX()),n=we.round(e.getY());return this.isValid(t,n)}distancePoint(e,t){return we.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return we.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(G.truncDivision(this.nbLayers-4,8)+1)+15}}class Nn{decode(e,t=null){let n=null,r=new Lr(e.getBlackMatrix()),i=null,s=null;try{let u=r.detectMirror(!1);i=u.getPoints(),this.reportFoundResultPoints(t,i),s=new Re().decode(u)}catch(u){n=u}if(s==null)try{let u=r.detectMirror(!0);i=u.getPoints(),this.reportFoundResultPoints(t,i),s=new Re().decode(u)}catch(u){throw n??u}let o=new Ke(s.getText(),s.getRawBytes(),s.getNumBits(),i,ie.AZTEC,q.currentTimeMillis()),a=s.getByteSegments();a!=null&&o.putMetadata(be.BYTE_SEGMENTS,a);let l=s.getECLevel();return l!=null&&o.putMetadata(be.ERROR_CORRECTION_LEVEL,l),o}reportFoundResultPoints(e,t){if(e!=null){let n=e.get(W.NEED_RESULT_POINT_CALLBACK);n!=null&&t.forEach((r,i,s)=>{n.foundPossibleResultPoint(r)})}}reset(){}}class zi extends Et{constructor(e=500){super(new Nn,e)}}class Ge{decode(e,t){try{return this.doDecode(e,t)}catch{if(t&&t.get(W.TRY_HARDER)===!0&&e.isRotateSupported()){const i=e.rotateCounterClockwise(),s=this.doDecode(i,t),o=s.getResultMetadata();let a=270;o!==null&&o.get(be.ORIENTATION)===!0&&(a=a+o.get(be.ORIENTATION)%360),s.putMetadata(be.ORIENTATION,a);const l=s.getResultPoints();if(l!==null){const u=i.getHeight();for(let x=0;x<l.length;x++)l[x]=new ee(u-l[x].getY()-1,l[x].getX())}return s}else throw new v}}reset(){}doDecode(e,t){const n=e.getWidth(),r=e.getHeight();let i=new K(n);const s=t&&t.get(W.TRY_HARDER)===!0,o=Math.max(1,r>>(s?8:5));let a;s?a=r:a=15;const l=Math.trunc(r/2);for(let u=0;u<a;u++){const x=Math.trunc((u+1)/2),E=(u&1)===0,I=l+o*(E?x:-x);if(I<0||I>=r)break;try{i=e.getBlackRow(I,i)}catch{continue}for(let b=0;b<2;b++){if(b===1&&(i.reverse(),t&&t.get(W.NEED_RESULT_POINT_CALLBACK)===!0)){const T=new Map;t.forEach((N,B)=>T.set(B,N)),T.delete(W.NEED_RESULT_POINT_CALLBACK),t=T}try{const T=this.decodeRow(I,i,t);if(b===1){T.putMetadata(be.ORIENTATION,180);const N=T.getResultPoints();N!==null&&(N[0]=new ee(n-N[0].getX()-1,N[0].getY()),N[1]=new ee(n-N[1].getX()-1,N[1].getY()))}return T}catch{}}}throw new v}static recordPattern(e,t,n){const r=n.length;for(let l=0;l<r;l++)n[l]=0;const i=e.getSize();if(t>=i)throw new v;let s=!e.get(t),o=0,a=t;for(;a<i;){if(e.get(a)!==s)n[o]++;else{if(++o===r)break;n[o]=1,s=!s}a++}if(!(o===r||o===r-1&&a===i))throw new v}static recordPatternInReverse(e,t,n){let r=n.length,i=e.get(t);for(;t>0&&r>=0;)e.get(--t)!==i&&(r--,i=!i);if(r>=0)throw new v;Ge.recordPattern(e,t+1,n)}static patternMatchVariance(e,t,n){const r=e.length;let i=0,s=0;for(let l=0;l<r;l++)i+=e[l],s+=t[l];if(i<s)return Number.POSITIVE_INFINITY;const o=i/s;n*=o;let a=0;for(let l=0;l<r;l++){const u=e[l],x=t[l]*o,E=u>x?u-x:x-u;if(E>n)return Number.POSITIVE_INFINITY;a+=E}return a/i}}class X extends Ge{static findStartPattern(e){const t=e.getSize(),n=e.getNextSet(0);let r=0,i=Int32Array.from([0,0,0,0,0,0]),s=n,o=!1;const a=6;for(let l=n;l<t;l++)if(e.get(l)!==o)i[r]++;else{if(r===a-1){let u=X.MAX_AVG_VARIANCE,x=-1;for(let E=X.CODE_START_A;E<=X.CODE_START_C;E++){const I=Ge.patternMatchVariance(i,X.CODE_PATTERNS[E],X.MAX_INDIVIDUAL_VARIANCE);I<u&&(u=I,x=E)}if(x>=0&&e.isRange(Math.max(0,s-(l-s)/2),s,!1))return Int32Array.from([s,l,x]);s+=i[0]+i[1],i=i.slice(2,i.length-1),i[r-1]=0,i[r]=0,r--}else r++;i[r]=1,o=!o}throw new v}static decodeCode(e,t,n){Ge.recordPattern(e,n,t);let r=X.MAX_AVG_VARIANCE,i=-1;for(let s=0;s<X.CODE_PATTERNS.length;s++){const o=X.CODE_PATTERNS[s],a=this.patternMatchVariance(t,o,X.MAX_INDIVIDUAL_VARIANCE);a<r&&(r=a,i=s)}if(i>=0)return i;throw new v}decodeRow(e,t,n){const r=n&&n.get(W.ASSUME_GS1)===!0,i=X.findStartPattern(t),s=i[2];let o=0;const a=new Uint8Array(20);a[o++]=s;let l;switch(s){case X.CODE_START_A:l=X.CODE_CODE_A;break;case X.CODE_START_B:l=X.CODE_CODE_B;break;case X.CODE_START_C:l=X.CODE_CODE_C;break;default:throw new P}let u=!1,x=!1,E="",I=i[0],b=i[1];const T=Int32Array.from([0,0,0,0,0,0]);let N=0,B=0,V=s,H=0,F=!0,ge=!1,fe=!1;for(;!u;){const cn=x;switch(x=!1,N=B,B=X.decodeCode(t,T,b),a[o++]=B,B!==X.CODE_STOP&&(F=!0),B!==X.CODE_STOP&&(H++,V+=H*B),I=b,b+=T.reduce((Is,ps)=>Is+ps,0),B){case X.CODE_START_A:case X.CODE_START_B:case X.CODE_START_C:throw new P}switch(l){case X.CODE_CODE_A:if(B<64)fe===ge?E+=String.fromCharCode(32+B):E+=String.fromCharCode(32+B+128),fe=!1;else if(B<96)fe===ge?E+=String.fromCharCode(B-64):E+=String.fromCharCode(B+64),fe=!1;else switch(B!==X.CODE_STOP&&(F=!1),B){case X.CODE_FNC_1:r&&(E.length===0?E+="]C1":E+="");break;case X.CODE_FNC_2:case X.CODE_FNC_3:break;case X.CODE_FNC_4_A:!ge&&fe?(ge=!0,fe=!1):ge&&fe?(ge=!1,fe=!1):fe=!0;break;case X.CODE_SHIFT:x=!0,l=X.CODE_CODE_B;break;case X.CODE_CODE_B:l=X.CODE_CODE_B;break;case X.CODE_CODE_C:l=X.CODE_CODE_C;break;case X.CODE_STOP:u=!0;break}break;case X.CODE_CODE_B:if(B<96)fe===ge?E+=String.fromCharCode(32+B):E+=String.fromCharCode(32+B+128),fe=!1;else switch(B!==X.CODE_STOP&&(F=!1),B){case X.CODE_FNC_1:r&&(E.length===0?E+="]C1":E+="");break;case X.CODE_FNC_2:case X.CODE_FNC_3:break;case X.CODE_FNC_4_B:!ge&&fe?(ge=!0,fe=!1):ge&&fe?(ge=!1,fe=!1):fe=!0;break;case X.CODE_SHIFT:x=!0,l=X.CODE_CODE_A;break;case X.CODE_CODE_A:l=X.CODE_CODE_A;break;case X.CODE_CODE_C:l=X.CODE_CODE_C;break;case X.CODE_STOP:u=!0;break}break;case X.CODE_CODE_C:if(B<100)B<10&&(E+="0"),E+=B;else switch(B!==X.CODE_STOP&&(F=!1),B){case X.CODE_FNC_1:r&&(E.length===0?E+="]C1":E+="");break;case X.CODE_CODE_A:l=X.CODE_CODE_A;break;case X.CODE_CODE_B:l=X.CODE_CODE_B;break;case X.CODE_STOP:u=!0;break}break}cn&&(l=l===X.CODE_CODE_A?X.CODE_CODE_B:X.CODE_CODE_A)}const at=b-I;if(b=t.getNextUnset(b),!t.isRange(b,Math.min(t.getSize(),b+(b-I)/2),!1))throw new v;if(V-=H*N,V%103!==N)throw new k;const It=E.length;if(It===0)throw new v;It>0&&F&&(l===X.CODE_CODE_C?E=E.substring(0,It-2):E=E.substring(0,It-1));const lt=(i[1]+i[0])/2,_e=I+at/2,Je=a.length,ut=new Uint8Array(Je);for(let cn=0;cn<Je;cn++)ut[cn]=a[cn];const ln=[new ee(lt,e),new ee(_e,e)];return new Ke(E,ut,0,ln,ie.CODE_128,new Date().getTime())}}X.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],X.MAX_AVG_VARIANCE=.25,X.MAX_INDIVIDUAL_VARIANCE=.7,X.CODE_SHIFT=98,X.CODE_CODE_C=99,X.CODE_CODE_B=100,X.CODE_CODE_A=101,X.CODE_FNC_1=102,X.CODE_FNC_2=97,X.CODE_FNC_3=96,X.CODE_FNC_4_A=101,X.CODE_FNC_4_B=100,X.CODE_START_A=103,X.CODE_START_B=104,X.CODE_START_C=105,X.CODE_STOP=106;class He extends Ge{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,n){let r=this.counters;r.fill(0),this.decodeRowResult="";let i=He.findAsteriskPattern(t,r),s=t.getNextSet(i[1]),o=t.getSize(),a,l;do{He.recordPattern(t,s,r);let T=He.toNarrowWidePattern(r);if(T<0)throw new v;a=He.patternToChar(T),this.decodeRowResult+=a,l=s;for(let N of r)s+=N;s=t.getNextSet(s)}while(a!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let u=0;for(let T of r)u+=T;let x=s-l-u;if(s!==o&&x*2<u)throw new v;if(this.usingCheckDigit){let T=this.decodeRowResult.length-1,N=0;for(let B=0;B<T;B++)N+=He.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(B));if(this.decodeRowResult.charAt(T)!==He.ALPHABET_STRING.charAt(N%43))throw new k;this.decodeRowResult=this.decodeRowResult.substring(0,T)}if(this.decodeRowResult.length===0)throw new v;let E;this.extendedMode?E=He.decodeExtended(this.decodeRowResult):E=this.decodeRowResult;let I=(i[1]+i[0])/2,b=l+u/2;return new Ke(E,null,0,[new ee(I,e),new ee(b,e)],ie.CODE_39,new Date().getTime())}static findAsteriskPattern(e,t){let n=e.getSize(),r=e.getNextSet(0),i=0,s=r,o=!1,a=t.length;for(let l=r;l<n;l++)if(e.get(l)!==o)t[i]++;else{if(i===a-1){if(this.toNarrowWidePattern(t)===He.ASTERISK_ENCODING&&e.isRange(Math.max(0,s-Math.floor((l-s)/2)),s,!1))return[s,l];s+=t[0]+t[1],t.copyWithin(0,2,2+i-1),t[i-1]=0,t[i]=0,i--}else i++;t[i]=1,o=!o}throw new v}static toNarrowWidePattern(e){let t=e.length,n=0,r;do{let i=2147483647;for(let a of e)a<i&&a>n&&(i=a);n=i,r=0;let s=0,o=0;for(let a=0;a<t;a++){let l=e[a];l>n&&(o|=1<<t-1-a,r++,s+=l)}if(r===3){for(let a=0;a<t&&r>0;a++){let l=e[a];if(l>n&&(r--,l*2>=s))return-1}return o}}while(r>3);return-1}static patternToChar(e){for(let t=0;t<He.CHARACTER_ENCODINGS.length;t++)if(He.CHARACTER_ENCODINGS[t]===e)return He.ALPHABET_STRING.charAt(t);if(e===He.ASTERISK_ENCODING)return"*";throw new v}static decodeExtended(e){let t=e.length,n="";for(let r=0;r<t;r++){let i=e.charAt(r);if(i==="+"||i==="$"||i==="%"||i==="/"){let s=e.charAt(r+1),o="\0";switch(i){case"+":if(s>="A"&&s<="Z")o=String.fromCharCode(s.charCodeAt(0)+32);else throw new P;break;case"$":if(s>="A"&&s<="Z")o=String.fromCharCode(s.charCodeAt(0)-64);else throw new P;break;case"%":if(s>="A"&&s<="E")o=String.fromCharCode(s.charCodeAt(0)-38);else if(s>="F"&&s<="J")o=String.fromCharCode(s.charCodeAt(0)-11);else if(s>="K"&&s<="O")o=String.fromCharCode(s.charCodeAt(0)+16);else if(s>="P"&&s<="T")o=String.fromCharCode(s.charCodeAt(0)+43);else if(s==="U")o="\0";else if(s==="V")o="@";else if(s==="W")o="`";else if(s==="X"||s==="Y"||s==="Z")o="";else throw new P;break;case"/":if(s>="A"&&s<="O")o=String.fromCharCode(s.charCodeAt(0)-32);else if(s==="Z")o=":";else throw new P;break}n+=o,r++}else n+=i}return n}}He.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",He.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],He.ASTERISK_ENCODING=148;class Se extends Ge{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,n){let r=this.decodeStart(t),i=this.decodeEnd(t),s=new Z;Se.decodeMiddle(t,r[1],i[0],s);let o=s.toString(),a=null;n!=null&&(a=n.get(W.ALLOWED_LENGTHS)),a==null&&(a=Se.DEFAULT_ALLOWED_LENGTHS);let l=o.length,u=!1,x=0;for(let b of a){if(l===b){u=!0;break}b>x&&(x=b)}if(!u&&l>x&&(u=!0),!u)throw new P;const E=[new ee(r[1],e),new ee(i[0],e)];return new Ke(o,null,0,E,ie.ITF,new Date().getTime())}static decodeMiddle(e,t,n,r){let i=new Int32Array(10),s=new Int32Array(5),o=new Int32Array(5);for(i.fill(0),s.fill(0),o.fill(0);t<n;){Ge.recordPattern(e,t,i);for(let l=0;l<5;l++){let u=2*l;s[l]=i[u],o[l]=i[u+1]}let a=Se.decodeDigit(s);r.append(a.toString()),a=this.decodeDigit(o),r.append(a.toString()),i.forEach(function(l){t+=l})}}decodeStart(e){let t=Se.skipWhiteSpace(e),n=Se.findGuardPattern(e,t,Se.START_PATTERN);return this.narrowLineWidth=(n[1]-n[0])/4,this.validateQuietZone(e,n[0]),n}validateQuietZone(e,t){let n=this.narrowLineWidth*10;n=n<t?n:t;for(let r=t-1;n>0&&r>=0&&!e.get(r);r--)n--;if(n!==0)throw new v}static skipWhiteSpace(e){const t=e.getSize(),n=e.getNextSet(0);if(n===t)throw new v;return n}decodeEnd(e){e.reverse();try{let t=Se.skipWhiteSpace(e),n;try{n=Se.findGuardPattern(e,t,Se.END_PATTERN_REVERSED[0])}catch(i){i instanceof v&&(n=Se.findGuardPattern(e,t,Se.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,n[0]);let r=n[0];return n[0]=e.getSize()-n[1],n[1]=e.getSize()-r,n}finally{e.reverse()}}static findGuardPattern(e,t,n){let r=n.length,i=new Int32Array(r),s=e.getSize(),o=!1,a=0,l=t;i.fill(0);for(let u=t;u<s;u++)if(e.get(u)!==o)i[a]++;else{if(a===r-1){if(Ge.patternMatchVariance(i,n,Se.MAX_INDIVIDUAL_VARIANCE)<Se.MAX_AVG_VARIANCE)return[l,u];l+=i[0]+i[1],q.arraycopy(i,2,i,0,a-1),i[a-1]=0,i[a]=0,a--}else a++;i[a]=1,o=!o}throw new v}static decodeDigit(e){let t=Se.MAX_AVG_VARIANCE,n=-1,r=Se.PATTERNS.length;for(let i=0;i<r;i++){let s=Se.PATTERNS[i],o=Ge.patternMatchVariance(e,s,Se.MAX_INDIVIDUAL_VARIANCE);o<t?(t=o,n=i):o===t&&(n=-1)}if(n>=0)return n%10;throw new v}}Se.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Se.MAX_AVG_VARIANCE=.38,Se.MAX_INDIVIDUAL_VARIANCE=.5,Se.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Se.START_PATTERN=Int32Array.from([1,1,1,1]),Se.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Le extends Ge{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t=!1,n,r=0,i=Int32Array.from([0,0,0]);for(;!t;){i=Int32Array.from([0,0,0]),n=Le.findGuardPattern(e,r,!1,this.START_END_PATTERN,i);let s=n[0];r=n[1];let o=s-(r-s);o>=0&&(t=e.isRange(o,s,!1))}return n}static checkChecksum(e){return Le.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let n=parseInt(e.charAt(t-1),10);return Le.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new P;n+=i}n*=3;for(let r=t-2;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new P;n+=i}return(1e3-n)%10}static decodeEnd(e,t){return Le.findGuardPattern(e,t,!1,Le.START_END_PATTERN,new Int32Array(Le.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,n,r){return this.findGuardPattern(e,t,n,r,new Int32Array(r.length))}static findGuardPattern(e,t,n,r,i){let s=e.getSize();t=n?e.getNextUnset(t):e.getNextSet(t);let o=0,a=t,l=r.length,u=n;for(let x=t;x<s;x++)if(e.get(x)!==u)i[o]++;else{if(o===l-1){if(Ge.patternMatchVariance(i,r,Le.MAX_INDIVIDUAL_VARIANCE)<Le.MAX_AVG_VARIANCE)return Int32Array.from([a,x]);a+=i[0]+i[1];let E=i.slice(2,i.length-1);for(let I=0;I<o-1;I++)i[I]=E[I];i[o-1]=0,i[o]=0,o--}else o++;i[o]=1,u=!u}throw new v}static decodeDigit(e,t,n,r){this.recordPattern(e,n,t);let i=this.MAX_AVG_VARIANCE,s=-1,o=r.length;for(let a=0;a<o;a++){let l=r[a],u=Ge.patternMatchVariance(t,l,Le.MAX_INDIVIDUAL_VARIANCE);u<i&&(i=u,s=a)}if(s>=0)return s;throw new v}}Le.MAX_AVG_VARIANCE=.48,Le.MAX_INDIVIDUAL_VARIANCE=.7,Le.START_END_PATTERN=Int32Array.from([1,1,1]),Le.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Le.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Le.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class dn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let r=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,r),s=r.toString(),o=dn.parseExtensionString(s),a=[new ee((n[0]+n[1])/2,e),new ee(i,e)],l=new Ke(s,null,0,a,ie.UPC_EAN_EXTENSION,new Date().getTime());return o!=null&&l.putAllMetadata(o),l}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1],o=0;for(let l=0;l<5&&s<i;l++){let u=Le.decodeDigit(e,r,s,Le.L_AND_G_PATTERNS);n+=String.fromCharCode(48+u%10);for(let x of r)s+=x;u>=10&&(o|=1<<4-l),l!==4&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(n.length!==5)throw new v;let a=this.determineCheckDigit(o);if(dn.extensionChecksum(n.toString())!==a)throw new v;return s}static extensionChecksum(e){let t=e.length,n=0;for(let r=t-2;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-48;n*=3;for(let r=t-1;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-48;return n*=3,n%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new v}static parseExtensionString(e){if(e.length!==5)return null;let t=dn.parseExtension5String(e);return t==null?null:new Map([[be.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}let n=parseInt(e.substring(1)),r=(n/100).toString(),i=n%100,s=i<10?"0"+i:i.toString();return t+r+"."+s}}class Wn{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let r=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,r),s=r.toString(),o=Wn.parseExtensionString(s),a=[new ee((n[0]+n[1])/2,e),new ee(i,e)],l=new Ke(s,null,0,a,ie.UPC_EAN_EXTENSION,new Date().getTime());return o!=null&&l.putAllMetadata(o),l}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1],o=0;for(let a=0;a<2&&s<i;a++){let l=Le.decodeDigit(e,r,s,Le.L_AND_G_PATTERNS);n+=String.fromCharCode(48+l%10);for(let u of r)s+=u;l>=10&&(o|=1<<1-a),a!==1&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(n.length!==2)throw new v;if(parseInt(n.toString())%4!==o)throw new v;return s}static parseExtensionString(e){return e.length!==2?null:new Map([[be.ISSUE_NUMBER,parseInt(e)]])}}class Fr{static decodeRow(e,t,n){let r=Le.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new dn().decodeRow(e,t,r)}catch{return new Wn().decodeRow(e,t,r)}}}Fr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Ce extends Le{constructor(){super(),this.decodeRowStringBuffer="",Ce.L_AND_G_PATTERNS=Ce.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let t=Ce.L_PATTERNS[e-10],n=new Int32Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[t.length-r-1];Ce.L_AND_G_PATTERNS[e]=n}}decodeRow(e,t,n){let r=Ce.findStartGuardPattern(t),i=n==null?null:n.get(W.NEED_RESULT_POINT_CALLBACK);if(i!=null){const F=new ee((r[0]+r[1])/2,e);i.foundPossibleResultPoint(F)}let s=this.decodeMiddle(t,r,this.decodeRowStringBuffer),o=s.rowOffset,a=s.resultString;if(i!=null){const F=new ee(o,e);i.foundPossibleResultPoint(F)}let l=this.decodeEnd(t,o);if(i!=null){const F=new ee((l[0]+l[1])/2,e);i.foundPossibleResultPoint(F)}let u=l[1],x=u+(u-l[0]);if(x>=t.getSize()||!t.isRange(u,x,!1))throw new v;let E=a.toString();if(E.length<8)throw new P;if(!Ce.checkChecksum(E))throw new k;let I=(r[1]+r[0])/2,b=(l[1]+l[0])/2,T=this.getBarcodeFormat(),N=[new ee(I,e),new ee(b,e)],B=new Ke(E,null,0,N,T,new Date().getTime()),V=0;try{let F=Fr.decodeRow(e,t,l[1]);B.putMetadata(be.UPC_EAN_EXTENSION,F.getText()),B.putAllMetadata(F.getResultMetadata()),B.addResultPoints(F.getResultPoints()),V=F.getText().length}catch{}let H=n==null?null:n.get(W.ALLOWED_EAN_EXTENSIONS);if(H!=null){let F=!1;for(let ge in H)if(V.toString()===ge){F=!0;break}if(!F)throw new v}return B}decodeEnd(e,t){return Ce.findGuardPattern(e,t,!1,Ce.START_END_PATTERN,new Int32Array(Ce.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return Ce.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let n=parseInt(e.charAt(t-1),10);return Ce.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new P;n+=i}n*=3;for(let r=t-2;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new P;n+=i}return(1e3-n)%10}}class Yt extends Ce{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1],o=0;for(let l=0;l<6&&s<i;l++){let u=Ce.decodeDigit(e,r,s,Ce.L_AND_G_PATTERNS);n+=String.fromCharCode(48+u%10);for(let x of r)s+=x;u>=10&&(o|=1<<5-l)}n=Yt.determineFirstDigit(n,o),s=Ce.findGuardPattern(e,s,!0,Ce.MIDDLE_PATTERN,new Int32Array(Ce.MIDDLE_PATTERN.length).fill(0))[1];for(let l=0;l<6&&s<i;l++){let u=Ce.decodeDigit(e,r,s,Ce.L_PATTERNS);n+=String.fromCharCode(48+u);for(let x of r)s+=x}return{rowOffset:s,resultString:n}}getBarcodeFormat(){return ie.EAN_13}static determineFirstDigit(e,t){for(let n=0;n<10;n++)if(t===this.FIRST_DIGIT_ENCODINGS[n])return e=String.fromCharCode(48+n)+e,e;throw new v}}Yt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class kr extends Ce{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){const r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1];for(let a=0;a<4&&s<i;a++){let l=Ce.decodeDigit(e,r,s,Ce.L_PATTERNS);n+=String.fromCharCode(48+l);for(let u of r)s+=u}s=Ce.findGuardPattern(e,s,!0,Ce.MIDDLE_PATTERN,new Int32Array(Ce.MIDDLE_PATTERN.length).fill(0))[1];for(let a=0;a<4&&s<i;a++){let l=Ce.decodeDigit(e,r,s,Ce.L_PATTERNS);n+=String.fromCharCode(48+l);for(let u of r)s+=u}return{rowOffset:s,resultString:n}}getBarcodeFormat(){return ie.EAN_8}}class Ur extends Ce{constructor(){super(...arguments),this.ean13Reader=new Yt}getBarcodeFormat(){return ie.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,n){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,n))}decodeMiddle(e,t,n){return this.ean13Reader.decodeMiddle(e,t,n)}maybeReturnResult(e){let t=e.getText();if(t.charAt(0)==="0"){let n=new Ke(t.substring(1),null,null,e.getResultPoints(),ie.UPC_A);return e.getResultMetadata()!=null&&n.putAllMetadata(e.getResultMetadata()),n}else throw new v}reset(){this.ean13Reader.reset()}}class mt extends Ce{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,n){const r=this.decodeMiddleCounters.map(l=>l);r[0]=0,r[1]=0,r[2]=0,r[3]=0;const i=e.getSize();let s=t[1],o=0;for(let l=0;l<6&&s<i;l++){const u=mt.decodeDigit(e,r,s,mt.L_AND_G_PATTERNS);n+=String.fromCharCode(48+u%10);for(let x of r)s+=x;u>=10&&(o|=1<<5-l)}let a=mt.determineNumSysAndCheckDigit(n,o);return{rowOffset:s,resultString:a}}decodeEnd(e,t){return mt.findGuardPatternWithoutCounters(e,t,!0,mt.MIDDLE_END_PATTERN)}checkChecksum(e){return Ce.checkChecksum(mt.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let n=0;n<=1;n++)for(let r=0;r<10;r++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[n][r]){let i=String.fromCharCode(48+n),s=String.fromCharCode(48+r);return i+e+s}throw v.getNotFoundInstance()}getBarcodeFormat(){return ie.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map(i=>i.charCodeAt(0)),n=new Z;n.append(e.charAt(0));let r=t[5];switch(r){case 0:case 1:case 2:n.appendChars(t,0,2),n.append(r),n.append("0000"),n.appendChars(t,2,3);break;case 3:n.appendChars(t,0,3),n.append("00000"),n.appendChars(t,3,2);break;case 4:n.appendChars(t,0,4),n.append("00000"),n.append(t[4]);break;default:n.appendChars(t,0,5),n.append("0000"),n.append(r);break}return e.length>=8&&n.append(e.charAt(7)),n.toString()}}mt.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),mt.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Xn extends Ge{constructor(e){super();let t=e==null?null:e.get(W.POSSIBLE_FORMATS),n=[];w(t)?(n.push(new Yt),n.push(new Ur),n.push(new kr),n.push(new mt)):(t.indexOf(ie.EAN_13)>-1&&n.push(new Yt),t.indexOf(ie.UPC_A)>-1&&n.push(new Ur),t.indexOf(ie.EAN_8)>-1&&n.push(new kr),t.indexOf(ie.UPC_E)>-1&&n.push(new mt)),this.readers=n}decodeRow(e,t,n){for(let r of this.readers)try{const i=r.decodeRow(e,t,n),s=i.getBarcodeFormat()===ie.EAN_13&&i.getText().charAt(0)==="0",o=n==null?null:n.get(W.POSSIBLE_FORMATS),a=o==null||o.includes(ie.UPC_A);if(s&&a){const l=i.getRawBytes(),u=new Ke(i.getText().substring(1),l,l?l.length:null,i.getResultPoints(),ie.UPC_A);return u.putAllMetadata(i.getResultMetadata()),u}return i}catch{}throw new v}reset(){for(let e of this.readers)e.reset()}}class $e extends Ge{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let n=0;n<t.length;n++)if(Ge.patternMatchVariance(e,t[n],$e.MAX_INDIVIDUAL_VARIANCE)<$e.MAX_AVG_VARIANCE)return n;throw new v}static count(e){return we.sum(new Int32Array(e))}static increment(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]>r&&(r=t[i],n=i);e[n]++}static decrement(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]<r&&(r=t[i],n=i);e[n]--}static isFinderPattern(e){let t=e[0]+e[1],n=t+e[2]+e[3],r=t/n;if(r>=$e.MIN_FINDER_PATTERN_RATIO&&r<=$e.MAX_FINDER_PATTERN_RATIO){let i=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(let o of e)o>s&&(s=o),o<i&&(i=o);return s<10*i}return!1}}$e.MAX_AVG_VARIANCE=.2,$e.MAX_INDIVIDUAL_VARIANCE=.45,$e.MIN_FINDER_PATTERN_RATIO=9.5/12,$e.MAX_FINDER_PATTERN_RATIO=12.5/14;class en{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof en))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class _n{constructor(e,t,n,r,i){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new ee(n,i)),this.resultPoints.push(new ee(r,i))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof _n))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class yt{constructor(){}static getRSSvalue(e,t,n){let r=0;for(let a of e)r+=a;let i=0,s=0,o=e.length;for(let a=0;a<o-1;a++){let l;for(l=1,s|=1<<a;l<e[a];l++,s&=~(1<<a)){let u=yt.combins(r-l-1,o-a-2);if(n&&s===0&&r-l-(o-a-1)>=o-a-1&&(u-=yt.combins(r-l-(o-a),o-a-2)),o-a-1>1){let x=0;for(let E=r-l-(o-a-2);E>t;E--)x+=yt.combins(r-l-E-1,o-a-3);u-=x*(o-1-a)}else r-l>t&&u--;i+=u}r-=l}return i}static combins(e,t){let n,r;e-t>t?(r=t,n=e-t):(r=e-t,n=t);let i=1,s=1;for(let o=e;o>n;o--)i*=o,s<=r&&(i/=s,s++);for(;s<=r;)i/=s,s++;return i}}class Zi{static buildBitArray(e){let t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);let n=12*t,r=new K(n),i=0,o=e[0].getRightChar().getValue();for(let a=11;a>=0;--a)(o&1<<a)!=0&&r.set(i),i++;for(let a=1;a<e.length;++a){let l=e[a],u=l.getLeftChar().getValue();for(let x=11;x>=0;--x)(u&1<<x)!=0&&r.set(i),i++;if(l.getRightChar()!=null){let x=l.getRightChar().getValue();for(let E=11;E>=0;--E)(x&1<<E)!=0&&r.set(i),i++}}return r}}class zt{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Yn{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class it extends Yn{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===it.FNC1}}it.FNC1="$";class Zt extends Yn{constructor(e,t,n){super(e),n?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class gt extends Yn{constructor(e,t,n){if(super(e),t<0||t>10||n<0||n>10)throw new P;this.firstDigit=t,this.secondDigit=n}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===gt.FNC1}isSecondDigitFNC1(){return this.secondDigit===gt.FNC1}isAnyFNC1(){return this.firstDigit===gt.FNC1||this.secondDigit===gt.FNC1}}gt.FNC1=10;class j{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new v;let t=e.substring(0,2);for(let i of j.TWO_DIGIT_DATA_LENGTH)if(i[0]===t)return i[1]===j.VARIABLE_LENGTH?j.processVariableAI(2,i[2],e):j.processFixedAI(2,i[1],e);if(e.length<3)throw new v;let n=e.substring(0,3);for(let i of j.THREE_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===j.VARIABLE_LENGTH?j.processVariableAI(3,i[2],e):j.processFixedAI(3,i[1],e);for(let i of j.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===j.VARIABLE_LENGTH?j.processVariableAI(4,i[2],e):j.processFixedAI(4,i[1],e);if(e.length<4)throw new v;let r=e.substring(0,4);for(let i of j.FOUR_DIGIT_DATA_LENGTH)if(i[0]===r)return i[1]===j.VARIABLE_LENGTH?j.processVariableAI(4,i[2],e):j.processFixedAI(4,i[1],e);throw new v}static processFixedAI(e,t,n){if(n.length<e)throw new v;let r=n.substring(0,e);if(n.length<e+t)throw new v;let i=n.substring(e,e+t),s=n.substring(e+t),o="("+r+")"+i,a=j.parseFieldsInGeneralPurpose(s);return a==null?o:o+a}static processVariableAI(e,t,n){let r=n.substring(0,e),i;n.length<e+t?i=n.length:i=e+t;let s=n.substring(e,i),o=n.substring(i),a="("+r+")"+s,l=j.parseFieldsInGeneralPurpose(o);return l==null?a:a+l}}j.VARIABLE_LENGTH=[],j.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",j.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",j.VARIABLE_LENGTH,20],["22",j.VARIABLE_LENGTH,29],["30",j.VARIABLE_LENGTH,8],["37",j.VARIABLE_LENGTH,8],["90",j.VARIABLE_LENGTH,30],["91",j.VARIABLE_LENGTH,30],["92",j.VARIABLE_LENGTH,30],["93",j.VARIABLE_LENGTH,30],["94",j.VARIABLE_LENGTH,30],["95",j.VARIABLE_LENGTH,30],["96",j.VARIABLE_LENGTH,30],["97",j.VARIABLE_LENGTH,3],["98",j.VARIABLE_LENGTH,30],["99",j.VARIABLE_LENGTH,30]],j.THREE_DIGIT_DATA_LENGTH=[["240",j.VARIABLE_LENGTH,30],["241",j.VARIABLE_LENGTH,30],["242",j.VARIABLE_LENGTH,6],["250",j.VARIABLE_LENGTH,30],["251",j.VARIABLE_LENGTH,30],["253",j.VARIABLE_LENGTH,17],["254",j.VARIABLE_LENGTH,20],["400",j.VARIABLE_LENGTH,30],["401",j.VARIABLE_LENGTH,30],["402",17],["403",j.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",j.VARIABLE_LENGTH,20],["421",j.VARIABLE_LENGTH,15],["422",3],["423",j.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],j.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",j.VARIABLE_LENGTH,15],["391",j.VARIABLE_LENGTH,18],["392",j.VARIABLE_LENGTH,15],["393",j.VARIABLE_LENGTH,18],["703",j.VARIABLE_LENGTH,30]],j.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",j.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",j.VARIABLE_LENGTH,20],["8003",j.VARIABLE_LENGTH,30],["8004",j.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",j.VARIABLE_LENGTH,30],["8008",j.VARIABLE_LENGTH,12],["8018",18],["8020",j.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",j.VARIABLE_LENGTH,70],["8200",j.VARIABLE_LENGTH,70]];class tn{constructor(e){this.buffer=new Z,this.information=e}decodeAllCodes(e,t){let n=t,r=null;do{let i=this.decodeGeneralPurposeField(n,r),s=j.parseFieldsInGeneralPurpose(i.getNewString());if(s!=null&&e.append(s),i.isRemaining()?r=""+i.getRemainingValue():r=null,n===i.getNewPosition())break;n=i.getNewPosition()}while(!0);return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let i=this.extractNumericValueFromBitArray(e,4);return i===0?new gt(this.information.getSize(),gt.FNC1,gt.FNC1):new gt(this.information.getSize(),i-1,gt.FNC1)}let t=this.extractNumericValueFromBitArray(e,7),n=(t-8)/11,r=(t-8)%11;return new gt(e+7,n,r)}extractNumericValueFromBitArray(e,t){return tn.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,n){let r=0;for(let i=0;i<n;++i)e.get(t+i)&&(r|=1<<n-i-1);return r}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);let n=this.parseBlocks();return n!=null&&n.isRemaining()?new Zt(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new Zt(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let n=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),!(n!==this.current.getPosition())&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return e.isSecondDigitFNC1()?t=new Zt(this.current.getPosition(),this.buffer.toString()):t=new Zt(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new zt(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let t=new Zt(this.current.getPosition(),this.buffer.toString());return new zt(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new zt(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new Zt(this.current.getPosition(),this.buffer.toString());return new zt(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new zt(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new Zt(this.current.getPosition(),this.buffer.toString());return new zt(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new zt(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,8);return r>=232&&r<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new it(e+5,it.FNC1);if(t>=5&&t<15)return new it(e+5,"0"+(t-5));let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new it(e+7,""+(n+1));if(n>=90&&n<116)return new it(e+7,""+(n+7));let r=this.extractNumericValueFromBitArray(e,8),i;switch(r){case 232:i="!";break;case 233:i='"';break;case 234:i="%";break;case 235:i="&";break;case 236:i="'";break;case 237:i="(";break;case 238:i=")";break;case 239:i="*";break;case 240:i="+";break;case 241:i=",";break;case 242:i="-";break;case 243:i=".";break;case 244:i="/";break;case 245:i=":";break;case 246:i=";";break;case 247:i="<";break;case 248:i="=";break;case 249:i=">";break;case 250:i="?";break;case 251:i="_";break;case 252:i=" ";break;default:throw new P}return new it(e+8,i)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new it(e+5,it.FNC1);if(t>=5&&t<15)return new it(e+5,"0"+(t-5));let n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new it(e+6,""+(n+33));let r;switch(n){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new bt("Decoding invalid alphanumeric value: "+n)}return new it(e+6,r)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class zn{constructor(e){this.information=e,this.generalDecoder=new tn(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class st extends zn{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let n=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,n)}encodeCompressedGtinWithoutAI(e,t,n){for(let r=0;r<4;++r){let i=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*r,10);i/100===0&&e.append("0"),i/10===0&&e.append("0"),e.append(i)}st.appendCheckDigit(e,n)}static appendCheckDigit(e,t){let n=0;for(let r=0;r<13;r++){let i=e.charAt(r+t).charCodeAt(0)-48;n+=(r&1)===0?3*i:i}n=10-n%10,n===10&&(n=0),e.append(n)}}st.GTIN_SIZE=40;class nn extends st{constructor(e){super(e)}parseInformation(){let e=new Z;e.append("(01)");let t=e.length(),n=this.getGeneralDecoder().extractNumericValueFromBitArray(nn.HEADER_SIZE,4);return e.append(n),this.encodeCompressedGtinWithoutAI(e,nn.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,nn.HEADER_SIZE+44)}}nn.HEADER_SIZE=4;class Rn extends zn{constructor(e){super(e)}parseInformation(){let e=new Z;return this.getGeneralDecoder().decodeAllCodes(e,Rn.HEADER_SIZE)}}Rn.HEADER_SIZE=5;class On extends st{constructor(e){super(e)}encodeCompressedWeight(e,t,n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,n);this.addWeightCode(e,r);let i=this.checkWeight(r),s=1e5;for(let o=0;o<5;++o)i/s===0&&e.append("0"),s/=10;e.append(i)}}class Tt extends On{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=Tt.HEADER_SIZE+On.GTIN_SIZE+Tt.WEIGHT_SIZE)throw new v;let e=new Z;return this.encodeCompressedGtin(e,Tt.HEADER_SIZE),this.encodeCompressedWeight(e,Tt.HEADER_SIZE+On.GTIN_SIZE,Tt.WEIGHT_SIZE),e.toString()}}Tt.HEADER_SIZE=5,Tt.WEIGHT_SIZE=15;class Ki extends Tt{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class qi extends Tt{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class St extends st{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<St.HEADER_SIZE+st.GTIN_SIZE)throw new v;let e=new Z;this.encodeCompressedGtin(e,St.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(St.HEADER_SIZE+st.GTIN_SIZE,St.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let n=this.getGeneralDecoder().decodeGeneralPurposeField(St.HEADER_SIZE+st.GTIN_SIZE+St.LAST_DIGIT_SIZE,null);return e.append(n.getNewString()),e.toString()}}St.HEADER_SIZE=8,St.LAST_DIGIT_SIZE=2;class nt extends st{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<nt.HEADER_SIZE+st.GTIN_SIZE)throw new v;let e=new Z;this.encodeCompressedGtin(e,nt.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(nt.HEADER_SIZE+st.GTIN_SIZE,nt.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let n=this.getGeneralDecoder().extractNumericValueFromBitArray(nt.HEADER_SIZE+st.GTIN_SIZE+nt.LAST_DIGIT_SIZE,nt.FIRST_THREE_DIGITS_SIZE);n/100==0&&e.append("0"),n/10==0&&e.append("0"),e.append(n);let r=this.getGeneralDecoder().decodeGeneralPurposeField(nt.HEADER_SIZE+st.GTIN_SIZE+nt.LAST_DIGIT_SIZE+nt.FIRST_THREE_DIGITS_SIZE,null);return e.append(r.getNewString()),e.toString()}}nt.HEADER_SIZE=8,nt.LAST_DIGIT_SIZE=2,nt.FIRST_THREE_DIGITS_SIZE=10;class ve extends On{constructor(e,t,n){super(e),this.dateCode=n,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=ve.HEADER_SIZE+ve.GTIN_SIZE+ve.WEIGHT_SIZE+ve.DATE_SIZE)throw new v;let e=new Z;return this.encodeCompressedGtin(e,ve.HEADER_SIZE),this.encodeCompressedWeight(e,ve.HEADER_SIZE+ve.GTIN_SIZE,ve.WEIGHT_SIZE),this.encodeCompressedDate(e,ve.HEADER_SIZE+ve.GTIN_SIZE+ve.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t,ve.DATE_SIZE);if(n==38400)return;e.append("("),e.append(this.dateCode),e.append(")");let r=n%32;n/=32;let i=n%12+1;n/=12;let s=n;s/10==0&&e.append("0"),e.append(s),i/10==0&&e.append("0"),e.append(i),r/10==0&&e.append("0"),e.append(r)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}ve.HEADER_SIZE=8,ve.WEIGHT_SIZE=20,ve.DATE_SIZE=16;function Vr(g){try{if(g.get(1))return new nn(g);if(!g.get(2))return new Rn(g);switch(tn.extractNumericValueFromBitArray(g,1,4)){case 4:return new Ki(g);case 5:return new qi(g)}switch(tn.extractNumericValueFromBitArray(g,1,5)){case 12:return new St(g);case 13:return new nt(g)}switch(tn.extractNumericValueFromBitArray(g,1,7)){case 56:return new ve(g,"310","11");case 57:return new ve(g,"320","11");case 58:return new ve(g,"310","13");case 59:return new ve(g,"320","13");case 60:return new ve(g,"310","15");case 61:return new ve(g,"320","15");case 62:return new ve(g,"310","17");case 63:return new ve(g,"320","17")}}catch(e){throw console.log(e),new bt("unknown decoder: "+g)}}class Lt{constructor(e,t,n,r){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=r}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof Lt?Lt.equalsOrNull(e.leftchar,t.leftchar)&&Lt.equalsOrNull(e.rightchar,t.rightchar)&&Lt.equalsOrNull(e.finderpattern,t.finderpattern):!1}static equalsOrNull(e,t){return e===null?t===null:Lt.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Zn{constructor(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof Zn?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1}checkEqualitity(e,t){if(!e||!t)return;let n;return e.forEach((r,i)=>{t.forEach(s=>{r.getLeftChar().getValue()===s.getLeftChar().getValue()&&r.getRightChar().getValue()===s.getRightChar().getValue()&&r.getFinderPatter().getValue()===s.getFinderPatter().getValue()&&(n=!0)})}),n}}class L extends $e{constructor(e){super(...arguments),this.pairs=new Array(L.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=e===!0}decodeRow(e,t,n){this.pairs.length=0,this.startFromEven=!1;try{return L.constructResult(this.decodeRow2pairs(e,t))}catch(r){this.verbose&&console.log(r)}return this.pairs.length=0,this.startFromEven=!0,L.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let n=!1;for(;!n;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(i){if(i instanceof v){if(!this.pairs.length)throw new v;n=!0}}if(this.checkChecksum())return this.pairs;let r;if(this.rows.length?r=!0:r=!1,this.storeRow(e,!1),r){let i=this.checkRowsBoolean(!1);if(i!=null||(i=this.checkRowsBoolean(!0),i!=null))return i}throw new v}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(n){this.verbose&&console.log(n)}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let n=t;n<this.rows.length;n++){let r=this.rows[n];this.pairs.length=0;for(let s of e)this.pairs.push(s.getPairs());if(this.pairs.push(r.getPairs()),!L.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let i=new Array(e);i.push(r);try{return this.checkRows(i,n+1)}catch(s){this.verbose&&console.log(s)}}throw new v}static isValidSequence(e){for(let t of L.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let n=!0;for(let r=0;r<e.length;r++)if(e[r].getFinderPattern().getValue()!=t[r]){n=!1;break}if(n)return!0}return!1}storeRow(e,t){let n=0,r=!1,i=!1;for(;n<this.rows.length;){let s=this.rows[n];if(s.getRowNumber()>e){i=s.isEquivalent(this.pairs);break}r=s.isEquivalent(this.pairs),n++}i||r||L.isPartialRow(this.pairs,this.rows)||(this.rows.push(n,new Zn(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let n of t)if(n.getPairs().length!==e.length){for(let r of n.getPairs())for(let i of e)if(Lt.equals(r,i))break}}static isPartialRow(e,t){for(let n of t){let r=!0;for(let i of e){let s=!1;for(let o of n.getPairs())if(i.equals(o)){s=!0;break}if(!s){r=!1;break}}if(r)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=Zi.buildBitArray(e),r=Vr(t).parseInformation(),i=e[0].getFinderPattern().getResultPoints(),s=e[e.length-1].getFinderPattern().getResultPoints(),o=[i[0],i[1],s[0],s[1]];return new Ke(r,null,null,o,ie.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),n=e.getRightChar();if(n==null)return!1;let r=n.getChecksumPortion(),i=2;for(let o=1;o<this.pairs.size();++o){let a=this.pairs.get(o);r+=a.getLeftChar().getChecksumPortion(),i++;let l=a.getRightChar();l!=null&&(r+=l.getChecksumPortion(),i++)}return r%=211,211*(i-4)+r==t.getValue()}static getNextSecondBar(e,t){let n;return e.get(t)?(n=e.getNextUnset(t),n=e.getNextSet(n)):(n=e.getNextSet(t),n=e.getNextUnset(n)),n}retrieveNextPair(e,t,n){let r=t.length%2==0;this.startFromEven&&(r=!r);let i,s=!0,o=-1;do this.findNextPair(e,t,o),i=this.parseFoundFinderPattern(e,n,r),i==null?o=L.getNextSecondBar(e,this.startEnd[0]):s=!1;while(s);let a=this.decodeDataCharacter(e,i,r,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new v;let l;try{l=this.decodeDataCharacter(e,i,r,!1)}catch(u){l=null,this.verbose&&console.log(u)}return new Lt(a,l,i,!0)}isEmptyPair(e){return e.length===0}findNextPair(e,t,n){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s;n>=0?s=n:this.isEmptyPair(t)?s=0:s=t[t.length-1].getFinderPattern().getStartEnd()[1];let o=t.length%2!=0;this.startFromEven&&(o=!o);let a=!1;for(;s<i&&(a=!e.get(s),!!a);)s++;let l=0,u=s;for(let x=s;x<i;x++)if(e.get(x)!=a)r[l]++;else{if(l==3){if(o&&L.reverseCounters(r),L.isFinderPattern(r)){this.startEnd[0]=u,this.startEnd[1]=x;return}o&&L.reverseCounters(r),u+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,l--}else l++;r[l]=1,a=!a}throw new v}static reverseCounters(e){let t=e.length;for(let n=0;n<t/2;++n){let r=e[n];e[n]=e[t-n-1],e[t-n-1]=r}}parseFoundFinderPattern(e,t,n){let r,i,s;if(n){let l=this.startEnd[0]-1;for(;l>=0&&!e.get(l);)l--;l++,r=this.startEnd[0]-l,i=l,s=this.startEnd[1]}else i=this.startEnd[0],s=e.getNextUnset(this.startEnd[1]+1),r=s-this.startEnd[1];let o=this.getDecodeFinderCounters();q.arraycopy(o,0,o,1,o.length-1),o[0]=r;let a;try{a=this.parseFinderValue(o,L.FINDER_PATTERNS)}catch{return null}return new _n(a,[i,s],i,s,t)}decodeDataCharacter(e,t,n,r){let i=this.getDataCharacterCounters();for(let _e=0;_e<i.length;_e++)i[_e]=0;if(r)L.recordPatternInReverse(e,t.getStartEnd()[0],i);else{L.recordPattern(e,t.getStartEnd()[1],i);for(let _e=0,Je=i.length-1;_e<Je;_e++,Je--){let ut=i[_e];i[_e]=i[Je],i[Je]=ut}}let s=17,o=we.sum(new Int32Array(i))/s,a=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(o-a)/a>.3)throw new v;let l=this.getOddCounts(),u=this.getEvenCounts(),x=this.getOddRoundingErrors(),E=this.getEvenRoundingErrors();for(let _e=0;_e<i.length;_e++){let Je=1*i[_e]/o,ut=Je+.5;if(ut<1){if(Je<.3)throw new v;ut=1}else if(ut>8){if(Je>8.7)throw new v;ut=8}let ln=_e/2;(_e&1)==0?(l[ln]=ut,x[ln]=Je-ut):(u[ln]=ut,E[ln]=Je-ut)}this.adjustOddEvenCounts(s);let I=4*t.getValue()+(n?0:2)+(r?0:1)-1,b=0,T=0;for(let _e=l.length-1;_e>=0;_e--){if(L.isNotA1left(t,n,r)){let Je=L.WEIGHTS[I][2*_e];T+=l[_e]*Je}b+=l[_e]}let N=0;for(let _e=u.length-1;_e>=0;_e--)if(L.isNotA1left(t,n,r)){let Je=L.WEIGHTS[I][2*_e+1];N+=u[_e]*Je}let B=T+N;if((b&1)!=0||b>13||b<4)throw new v;let V=(13-b)/2,H=L.SYMBOL_WIDEST[V],F=9-H,ge=yt.getRSSvalue(l,H,!0),fe=yt.getRSSvalue(u,F,!1),at=L.EVEN_TOTAL_SUBSET[V],It=L.GSUM[V],lt=ge*at+fe+It;return new en(lt,B)}static isNotA1left(e,t,n){return!(e.getValue()==0&&t&&n)}adjustOddEvenCounts(e){let t=we.sum(new Int32Array(this.getOddCounts())),n=we.sum(new Int32Array(this.getEvenCounts())),r=!1,i=!1;t>13?i=!0:t<4&&(r=!0);let s=!1,o=!1;n>13?o=!0:n<4&&(s=!0);let a=t+n-e,l=(t&1)==1,u=(n&1)==0;if(a==1)if(l){if(u)throw new v;i=!0}else{if(!u)throw new v;o=!0}else if(a==-1)if(l){if(u)throw new v;r=!0}else{if(!u)throw new v;s=!0}else if(a==0){if(l){if(!u)throw new v;t<n?(r=!0,o=!0):(i=!0,s=!0)}else if(u)throw new v}else throw new v;if(r){if(i)throw new v;L.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&L.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(o)throw new v;L.increment(this.getEvenCounts(),this.getOddRoundingErrors())}o&&L.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}L.SYMBOL_WIDEST=[7,5,4,3,1],L.EVEN_TOTAL_SUBSET=[4,20,52,104,204],L.GSUM=[0,348,1388,2948,3988],L.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],L.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],L.FINDER_PAT_A=0,L.FINDER_PAT_B=1,L.FINDER_PAT_C=2,L.FINDER_PAT_D=3,L.FINDER_PAT_E=4,L.FINDER_PAT_F=5,L.FINDER_PATTERN_SEQUENCES=[[L.FINDER_PAT_A,L.FINDER_PAT_A],[L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B],[L.FINDER_PAT_A,L.FINDER_PAT_C,L.FINDER_PAT_B,L.FINDER_PAT_D],[L.FINDER_PAT_A,L.FINDER_PAT_E,L.FINDER_PAT_B,L.FINDER_PAT_D,L.FINDER_PAT_C],[L.FINDER_PAT_A,L.FINDER_PAT_E,L.FINDER_PAT_B,L.FINDER_PAT_D,L.FINDER_PAT_D,L.FINDER_PAT_F],[L.FINDER_PAT_A,L.FINDER_PAT_E,L.FINDER_PAT_B,L.FINDER_PAT_D,L.FINDER_PAT_E,L.FINDER_PAT_F,L.FINDER_PAT_F],[L.FINDER_PAT_A,L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B,L.FINDER_PAT_C,L.FINDER_PAT_C,L.FINDER_PAT_D,L.FINDER_PAT_D],[L.FINDER_PAT_A,L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B,L.FINDER_PAT_C,L.FINDER_PAT_C,L.FINDER_PAT_D,L.FINDER_PAT_E,L.FINDER_PAT_E],[L.FINDER_PAT_A,L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B,L.FINDER_PAT_C,L.FINDER_PAT_C,L.FINDER_PAT_D,L.FINDER_PAT_E,L.FINDER_PAT_F,L.FINDER_PAT_F],[L.FINDER_PAT_A,L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B,L.FINDER_PAT_C,L.FINDER_PAT_D,L.FINDER_PAT_D,L.FINDER_PAT_E,L.FINDER_PAT_E,L.FINDER_PAT_F,L.FINDER_PAT_F]],L.MAX_PAIRS=11;class ji extends en{constructor(e,t,n){super(e,t),this.count=0,this.finderPattern=n}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Fe extends $e{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,n){const r=this.decodePair(t,!1,e,n);Fe.addOrTally(this.possibleLeftPairs,r),t.reverse();let i=this.decodePair(t,!0,e,n);Fe.addOrTally(this.possibleRightPairs,i),t.reverse();for(let s of this.possibleLeftPairs)if(s.getCount()>1){for(let o of this.possibleRightPairs)if(o.getCount()>1&&Fe.checkChecksum(s,o))return Fe.constructResult(s,o)}throw new v}static addOrTally(e,t){if(t==null)return;let n=!1;for(let r of e)if(r.getValue()===t.getValue()){r.incrementCount(),n=!0;break}n||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let n=4537077*e.getValue()+t.getValue(),r=new String(n).toString(),i=new Z;for(let l=13-r.length;l>0;l--)i.append("0");i.append(r);let s=0;for(let l=0;l<13;l++){let u=i.charAt(l).charCodeAt(0)-48;s+=(l&1)===0?3*u:u}s=10-s%10,s===10&&(s=0),i.append(s.toString());let o=e.getFinderPattern().getResultPoints(),a=t.getFinderPattern().getResultPoints();return new Ke(i.toString(),null,0,[o[0],o[1],a[0],a[1]],ie.RSS_14,new Date().getTime())}static checkChecksum(e,t){let n=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,r=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return r>72&&r--,r>8&&r--,n===r}decodePair(e,t,n,r){try{let i=this.findFinderPattern(e,t),s=this.parseFoundFinderPattern(e,n,t,i),o=r==null?null:r.get(W.NEED_RESULT_POINT_CALLBACK);if(o!=null){let u=(i[0]+i[1])/2;t&&(u=e.getSize()-1-u),o.foundPossibleResultPoint(new ee(u,n))}let a=this.decodeDataCharacter(e,s,!0),l=this.decodeDataCharacter(e,s,!1);return new ji(1597*a.getValue()+l.getValue(),a.getChecksumPortion()+4*l.getChecksumPortion(),s)}catch{return null}}decodeDataCharacter(e,t,n){let r=this.getDataCharacterCounters();for(let N=0;N<r.length;N++)r[N]=0;if(n)Ge.recordPatternInReverse(e,t.getStartEnd()[0],r);else{Ge.recordPattern(e,t.getStartEnd()[1]+1,r);for(let N=0,B=r.length-1;N<B;N++,B--){let V=r[N];r[N]=r[B],r[B]=V}}let i=n?16:15,s=we.sum(new Int32Array(r))/i,o=this.getOddCounts(),a=this.getEvenCounts(),l=this.getOddRoundingErrors(),u=this.getEvenRoundingErrors();for(let N=0;N<r.length;N++){let B=r[N]/s,V=Math.floor(B+.5);V<1?V=1:V>8&&(V=8);let H=Math.floor(N/2);(N&1)===0?(o[H]=V,l[H]=B-V):(a[H]=V,u[H]=B-V)}this.adjustOddEvenCounts(n,i);let x=0,E=0;for(let N=o.length-1;N>=0;N--)E*=9,E+=o[N],x+=o[N];let I=0,b=0;for(let N=a.length-1;N>=0;N--)I*=9,I+=a[N],b+=a[N];let T=E+3*I;if(n){if((x&1)!==0||x>12||x<4)throw new v;let N=(12-x)/2,B=Fe.OUTSIDE_ODD_WIDEST[N],V=9-B,H=yt.getRSSvalue(o,B,!1),F=yt.getRSSvalue(a,V,!0),ge=Fe.OUTSIDE_EVEN_TOTAL_SUBSET[N],fe=Fe.OUTSIDE_GSUM[N];return new en(H*ge+F+fe,T)}else{if((b&1)!==0||b>10||b<4)throw new v;let N=(10-b)/2,B=Fe.INSIDE_ODD_WIDEST[N],V=9-B,H=yt.getRSSvalue(o,B,!0),F=yt.getRSSvalue(a,V,!1),ge=Fe.INSIDE_ODD_TOTAL_SUBSET[N],fe=Fe.INSIDE_GSUM[N];return new en(F*ge+H+fe,T)}}findFinderPattern(e,t){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let r=e.getSize(),i=!1,s=0;for(;s<r&&(i=!e.get(s),t!==i);)s++;let o=0,a=s;for(let l=s;l<r;l++)if(e.get(l)!==i)n[o]++;else{if(o===3){if($e.isFinderPattern(n))return[a,l];a+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,o--}else o++;n[o]=1,i=!i}throw new v}parseFoundFinderPattern(e,t,n,r){let i=e.get(r[0]),s=r[0]-1;for(;s>=0&&i!==e.get(s);)s--;s++;const o=r[0]-s,a=this.getDecodeFinderCounters(),l=new Int32Array(a.length);q.arraycopy(a,0,l,1,a.length-1),l[0]=o;const u=this.parseFinderValue(l,Fe.FINDER_PATTERNS);let x=s,E=r[1];return n&&(x=e.getSize()-1-x,E=e.getSize()-1-E),new _n(u,[s,r[1]],x,E,t)}adjustOddEvenCounts(e,t){let n=we.sum(new Int32Array(this.getOddCounts())),r=we.sum(new Int32Array(this.getEvenCounts())),i=!1,s=!1,o=!1,a=!1;e?(n>12?s=!0:n<4&&(i=!0),r>12?a=!0:r<4&&(o=!0)):(n>11?s=!0:n<5&&(i=!0),r>10?a=!0:r<4&&(o=!0));let l=n+r-t,u=(n&1)===(e?1:0),x=(r&1)===1;if(l===1)if(u){if(x)throw new v;s=!0}else{if(!x)throw new v;a=!0}else if(l===-1)if(u){if(x)throw new v;i=!0}else{if(!x)throw new v;o=!0}else if(l===0){if(u){if(!x)throw new v;n<r?(i=!0,a=!0):(s=!0,o=!0)}else if(x)throw new v}else throw new v;if(i){if(s)throw new v;$e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(s&&$e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(a)throw new v;$e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}a&&$e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Fe.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Fe.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Fe.OUTSIDE_GSUM=[0,161,961,2015,2715],Fe.INSIDE_GSUM=[0,336,1036,1516],Fe.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Fe.INSIDE_ODD_WIDEST=[2,4,6,8],Fe.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class rn extends Ge{constructor(e,t){super(),this.readers=[],this.verbose=t===!0;const n=e?e.get(W.POSSIBLE_FORMATS):null,r=e&&e.get(W.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;n?((n.includes(ie.EAN_13)||n.includes(ie.UPC_A)||n.includes(ie.EAN_8)||n.includes(ie.UPC_E))&&this.readers.push(new Xn(e)),n.includes(ie.CODE_39)&&this.readers.push(new He(r)),n.includes(ie.CODE_128)&&this.readers.push(new X),n.includes(ie.ITF)&&this.readers.push(new Se),n.includes(ie.RSS_14)&&this.readers.push(new Fe),n.includes(ie.RSS_EXPANDED)&&this.readers.push(new L(this.verbose))):(this.readers.push(new Xn(e)),this.readers.push(new He),this.readers.push(new Xn(e)),this.readers.push(new X),this.readers.push(new Se),this.readers.push(new Fe),this.readers.push(new L(this.verbose)))}decodeRow(e,t,n){for(let r=0;r<this.readers.length;r++)try{return this.readers[r].decodeRow(e,t,n)}catch{}throw new v}reset(){this.readers.forEach(e=>e.reset())}}class Qi extends Et{constructor(e=500,t){super(new rn(t),e,t)}}class pe{constructor(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class me{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class xe{constructor(e,t,n,r,i,s){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=r,this.dataRegionSizeColumns=i,this.ecBlocks=s;let o=0;const a=s.getECCodewords(),l=s.getECBlocks();for(let u of l)o+=u.getCount()*(u.getDataCodewords()+a);this.totalCodewords=o}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if((e&1)!==0||(t&1)!==0)throw new P;for(let n of xe.VERSIONS)if(n.symbolSizeRows===e&&n.symbolSizeColumns===t)return n;throw new P}toString(){return""+this.versionNumber}static buildVersions(){return[new xe(1,10,10,8,8,new pe(5,new me(1,3))),new xe(2,12,12,10,10,new pe(7,new me(1,5))),new xe(3,14,14,12,12,new pe(10,new me(1,8))),new xe(4,16,16,14,14,new pe(12,new me(1,12))),new xe(5,18,18,16,16,new pe(14,new me(1,18))),new xe(6,20,20,18,18,new pe(18,new me(1,22))),new xe(7,22,22,20,20,new pe(20,new me(1,30))),new xe(8,24,24,22,22,new pe(24,new me(1,36))),new xe(9,26,26,24,24,new pe(28,new me(1,44))),new xe(10,32,32,14,14,new pe(36,new me(1,62))),new xe(11,36,36,16,16,new pe(42,new me(1,86))),new xe(12,40,40,18,18,new pe(48,new me(1,114))),new xe(13,44,44,20,20,new pe(56,new me(1,144))),new xe(14,48,48,22,22,new pe(68,new me(1,174))),new xe(15,52,52,24,24,new pe(42,new me(2,102))),new xe(16,64,64,14,14,new pe(56,new me(2,140))),new xe(17,72,72,16,16,new pe(36,new me(4,92))),new xe(18,80,80,18,18,new pe(48,new me(4,114))),new xe(19,88,88,20,20,new pe(56,new me(4,144))),new xe(20,96,96,22,22,new pe(68,new me(4,174))),new xe(21,104,104,24,24,new pe(56,new me(6,136))),new xe(22,120,120,18,18,new pe(68,new me(6,175))),new xe(23,132,132,20,20,new pe(62,new me(8,163))),new xe(24,144,144,22,22,new pe(62,new me(8,156),new me(2,155))),new xe(25,8,18,6,16,new pe(7,new me(1,5))),new xe(26,8,32,6,14,new pe(11,new me(1,10))),new xe(27,12,26,10,24,new pe(14,new me(1,16))),new xe(28,12,36,10,16,new pe(18,new me(1,22))),new xe(29,16,36,14,16,new pe(24,new me(1,32))),new xe(30,16,48,14,22,new pe(28,new me(1,49)))]}}xe.VERSIONS=xe.buildVersions();class Kn{constructor(e){const t=e.getHeight();if(t<8||t>144||(t&1)!==0)throw new P;this.version=Kn.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new te(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),n=e.getWidth();return xe.getVersionForDimensions(t,n)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,n=4,r=0;const i=this.mappingBitMatrix.getHeight(),s=this.mappingBitMatrix.getWidth();let o=!1,a=!1,l=!1,u=!1;do if(n===i&&r===0&&!o)e[t++]=this.readCorner1(i,s)&255,n-=2,r+=2,o=!0;else if(n===i-2&&r===0&&(s&3)!==0&&!a)e[t++]=this.readCorner2(i,s)&255,n-=2,r+=2,a=!0;else if(n===i+4&&r===2&&(s&7)===0&&!l)e[t++]=this.readCorner3(i,s)&255,n-=2,r+=2,l=!0;else if(n===i-2&&r===0&&(s&7)===4&&!u)e[t++]=this.readCorner4(i,s)&255,n-=2,r+=2,u=!0;else{do n<i&&r>=0&&!this.readMappingMatrix.get(r,n)&&(e[t++]=this.readUtah(n,r,i,s)&255),n-=2,r+=2;while(n>=0&&r<s);n+=1,r+=3;do n>=0&&r<s&&!this.readMappingMatrix.get(r,n)&&(e[t++]=this.readUtah(n,r,i,s)&255),n+=2,r-=2;while(n<i&&r>=0);n+=3,r+=1}while(n<i||r<s);if(t!==this.version.getTotalCodewords())throw new P;return e}readModule(e,t,n,r){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=r,e+=4-(r+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,n,r){let i=0;return this.readModule(e-2,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-2,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t,n,r)&&(i|=1),i<<=1,this.readModule(e,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e,t,n,r)&&(i|=1),i}readCorner1(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}readCorner2(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner3(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner4(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new R("Dimension of bitMatrix must match the version size");const r=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),s=t/r|0,o=n/i|0,a=s*r,l=o*i,u=new te(l,a);for(let x=0;x<s;++x){const E=x*r;for(let I=0;I<o;++I){const b=I*i;for(let T=0;T<r;++T){const N=x*(r+2)+1+T,B=E+T;for(let V=0;V<i;++V){const H=I*(i+2)+1+V;if(e.get(H,N)){const F=b+V;u.set(F,B)}}}}}return u}}class qn{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const n=t.getECBlocks();let r=0;const i=n.getECBlocks();for(let T of i)r+=T.getCount();const s=new Array(r);let o=0;for(let T of i)for(let N=0;N<T.getCount();N++){const B=T.getDataCodewords(),V=n.getECCodewords()+B;s[o++]=new qn(B,new Uint8Array(V))}const l=s[0].codewords.length-n.getECCodewords(),u=l-1;let x=0;for(let T=0;T<u;T++)for(let N=0;N<o;N++)s[N].codewords[T]=e[x++];const E=t.getVersionNumber()===24,I=E?8:o;for(let T=0;T<I;T++)s[T].codewords[l-1]=e[x++];const b=s[0].codewords.length;for(let T=l;T<b;T++)for(let N=0;N<o;N++){const B=E?(N+8)%o:N,V=E&&B>7?T-1:T;s[B].codewords[V]=e[x++]}if(x!==e.length)throw new R;return s}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class jn{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new R(""+e);let t=0,n=this.bitOffset,r=this.byteOffset;const i=this.bytes;if(n>0){const s=8-n,o=e<s?e:s,a=s-o,l=255>>8-o<<a;t=(i[r]&l)>>a,e-=o,n+=o,n===8&&(n=0,r++)}if(e>0){for(;e>=8;)t=t<<8|i[r]&255,r++,e-=8;if(e>0){const s=8-e,o=255>>s<<s;t=t<<e|(i[r]&o)>>s,n+=e}}return this.bitOffset=n,this.byteOffset=r,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var We;(function(g){g[g.PAD_ENCODE=0]="PAD_ENCODE",g[g.ASCII_ENCODE=1]="ASCII_ENCODE",g[g.C40_ENCODE=2]="C40_ENCODE",g[g.TEXT_ENCODE=3]="TEXT_ENCODE",g[g.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",g[g.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",g[g.BASE256_ENCODE=6]="BASE256_ENCODE"})(We||(We={}));class Ft{static decode(e){const t=new jn(e),n=new Z,r=new Z,i=new Array;let s=We.ASCII_ENCODE;do if(s===We.ASCII_ENCODE)s=this.decodeAsciiSegment(t,n,r);else{switch(s){case We.C40_ENCODE:this.decodeC40Segment(t,n);break;case We.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case We.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case We.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case We.BASE256_ENCODE:this.decodeBase256Segment(t,n,i);break;default:throw new P}s=We.ASCII_ENCODE}while(s!==We.PAD_ENCODE&&t.available()>0);return r.length()>0&&n.append(r.toString()),new dt(e,n.toString(),i.length===0?null:i,null)}static decodeAsciiSegment(e,t,n){let r=!1;do{let i=e.readBits(8);if(i===0)throw new P;if(i<=128)return r&&(i+=128),t.append(String.fromCharCode(i-1)),We.ASCII_ENCODE;if(i===129)return We.PAD_ENCODE;if(i<=229){const s=i-130;s<10&&t.append("0"),t.append(""+s)}else switch(i){case 230:return We.C40_ENCODE;case 231:return We.BASE256_ENCODE;case 232:t.append("");break;case 233:case 234:break;case 235:r=!0;break;case 236:t.append("[)>05"),n.insert(0,"");break;case 237:t.append("[)>06"),n.insert(0,"");break;case 238:return We.ANSIX12_ENCODE;case 239:return We.TEXT_ENCODE;case 240:return We.EDIFACT_ENCODE;case 241:break;default:if(i!==254||e.available()!==0)throw new P;break}}while(e.available()>0);return We.ASCII_ENCODE}static decodeC40Segment(e,t){let n=!1;const r=[];let i=0;do{if(e.available()===8)return;const s=e.readBits(8);if(s===254)return;this.parseTwoBytes(s,e.readBits(8),r);for(let o=0;o<3;o++){const a=r[o];switch(i){case 0:if(a<3)i=a+1;else if(a<this.C40_BASIC_SET_CHARS.length){const l=this.C40_BASIC_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else throw new P;break;case 1:n?(t.append(String.fromCharCode(a+128)),n=!1):t.append(String.fromCharCode(a)),i=0;break;case 2:if(a<this.C40_SHIFT2_SET_CHARS.length){const l=this.C40_SHIFT2_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else switch(a){case 27:t.append("");break;case 30:n=!0;break;default:throw new P}i=0;break;case 3:n?(t.append(String.fromCharCode(a+224)),n=!1):t.append(String.fromCharCode(a+96)),i=0;break;default:throw new P}}}while(e.available()>0)}static decodeTextSegment(e,t){let n=!1,r=[],i=0;do{if(e.available()===8)return;const s=e.readBits(8);if(s===254)return;this.parseTwoBytes(s,e.readBits(8),r);for(let o=0;o<3;o++){const a=r[o];switch(i){case 0:if(a<3)i=a+1;else if(a<this.TEXT_BASIC_SET_CHARS.length){const l=this.TEXT_BASIC_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else throw new P;break;case 1:n?(t.append(String.fromCharCode(a+128)),n=!1):t.append(String.fromCharCode(a)),i=0;break;case 2:if(a<this.TEXT_SHIFT2_SET_CHARS.length){const l=this.TEXT_SHIFT2_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else switch(a){case 27:t.append("");break;case 30:n=!0;break;default:throw new P}i=0;break;case 3:if(a<this.TEXT_SHIFT3_SET_CHARS.length){const l=this.TEXT_SHIFT3_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l),i=0}else throw new P;break;default:throw new P}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const n=[];do{if(e.available()===8)return;const r=e.readBits(8);if(r===254)return;this.parseTwoBytes(r,e.readBits(8),n);for(let i=0;i<3;i++){const s=n[i];switch(s){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(s<14)t.append(String.fromCharCode(s+44));else if(s<40)t.append(String.fromCharCode(s+51));else throw new P;break}}}while(e.available()>0)}static parseTwoBytes(e,t,n){let r=(e<<8)+t-1,i=Math.floor(r/1600);n[0]=i,r-=i*1600,i=Math.floor(r/40),n[1]=i,n[2]=r-i*40}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let n=0;n<4;n++){let r=e.readBits(6);if(r===31){const i=8-e.getBitOffset();i!==8&&e.readBits(i);return}(r&32)===0&&(r|=64),t.append(String.fromCharCode(r))}}while(e.available()>0)}static decodeBase256Segment(e,t,n){let r=1+e.getByteOffset();const i=this.unrandomize255State(e.readBits(8),r++);let s;if(i===0?s=e.available()/8|0:i<250?s=i:s=250*(i-249)+this.unrandomize255State(e.readBits(8),r++),s<0)throw new P;const o=new Uint8Array(s);for(let a=0;a<s;a++){if(e.available()<8)throw new P;o[a]=this.unrandomize255State(e.readBits(8),r++)}n.push(o);try{t.append(J.decode(o,U.ISO88591))}catch(a){throw new bt("Platform does not support required encoding: "+a.message)}}static unrandomize255State(e,t){const n=149*t%255+1,r=e-n;return r>=0?r:r+256}}Ft.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ft.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Ft.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Ft.TEXT_SHIFT2_SET_CHARS=Ft.C40_SHIFT2_SET_CHARS,Ft.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Ji{constructor(){this.rsDecoder=new hn(Ee.DATA_MATRIX_FIELD_256)}decode(e){const t=new Kn(e),n=t.getVersion(),r=t.readCodewords(),i=qn.getDataBlocks(r,n);let s=0;for(let l of i)s+=l.getNumDataCodewords();const o=new Uint8Array(s),a=i.length;for(let l=0;l<a;l++){const u=i[l],x=u.getCodewords(),E=u.getNumDataCodewords();this.correctErrors(x,E);for(let I=0;I<E;I++)o[I*a+l]=x[I]}return Ft.decode(o)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new k}for(let r=0;r<t;r++)e[r]=n[r]}}class Ve{constructor(e){this.image=e,this.rectangleDetector=new Mt(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new v;t=this.shiftToModuleCenter(t);const n=t[0],r=t[1],i=t[2],s=t[3];let o=this.transitionsBetween(n,s)+1,a=this.transitionsBetween(i,s)+1;(o&1)===1&&(o+=1),(a&1)===1&&(a+=1),4*o<7*a&&4*a<7*o&&(o=a=Math.max(o,a));let l=Ve.sampleGrid(this.image,n,r,i,s,o,a);return new Sn(l,[n,r,i,s])}static shiftPoint(e,t,n){let r=(t.getX()-e.getX())/(n+1),i=(t.getY()-e.getY())/(n+1);return new ee(e.getX()+r,e.getY()+i)}static moveAway(e,t,n){let r=e.getX(),i=e.getY();return r<t?r-=1:r+=1,i<n?i-=1:i+=1,new ee(r,i)}detectSolid1(e){let t=e[0],n=e[1],r=e[3],i=e[2],s=this.transitionsBetween(t,n),o=this.transitionsBetween(n,r),a=this.transitionsBetween(r,i),l=this.transitionsBetween(i,t),u=s,x=[i,t,n,r];return u>o&&(u=o,x[0]=t,x[1]=n,x[2]=r,x[3]=i),u>a&&(u=a,x[0]=n,x[1]=r,x[2]=i,x[3]=t),u>l&&(x[0]=r,x[1]=i,x[2]=t,x[3]=n),x}detectSolid2(e){let t=e[0],n=e[1],r=e[2],i=e[3],s=this.transitionsBetween(t,i),o=Ve.shiftPoint(n,r,(s+1)*4),a=Ve.shiftPoint(r,n,(s+1)*4),l=this.transitionsBetween(o,t),u=this.transitionsBetween(a,i);return l<u?(e[0]=t,e[1]=n,e[2]=r,e[3]=i):(e[0]=n,e[1]=r,e[2]=i,e[3]=t),e}correctTopRight(e){let t=e[0],n=e[1],r=e[2],i=e[3],s=this.transitionsBetween(t,i),o=this.transitionsBetween(n,i),a=Ve.shiftPoint(t,n,(o+1)*4),l=Ve.shiftPoint(r,n,(s+1)*4);s=this.transitionsBetween(a,i),o=this.transitionsBetween(l,i);let u=new ee(i.getX()+(r.getX()-n.getX())/(s+1),i.getY()+(r.getY()-n.getY())/(s+1)),x=new ee(i.getX()+(t.getX()-n.getX())/(o+1),i.getY()+(t.getY()-n.getY())/(o+1));if(!this.isValid(u))return this.isValid(x)?x:null;if(!this.isValid(x))return u;let E=this.transitionsBetween(a,u)+this.transitionsBetween(l,u),I=this.transitionsBetween(a,x)+this.transitionsBetween(l,x);return E>I?u:x}shiftToModuleCenter(e){let t=e[0],n=e[1],r=e[2],i=e[3],s=this.transitionsBetween(t,i)+1,o=this.transitionsBetween(r,i)+1,a=Ve.shiftPoint(t,n,o*4),l=Ve.shiftPoint(r,n,s*4);s=this.transitionsBetween(a,i)+1,o=this.transitionsBetween(l,i)+1,(s&1)===1&&(s+=1),(o&1)===1&&(o+=1);let u=(t.getX()+n.getX()+r.getX()+i.getX())/4,x=(t.getY()+n.getY()+r.getY()+i.getY())/4;t=Ve.moveAway(t,u,x),n=Ve.moveAway(n,u,x),r=Ve.moveAway(r,u,x),i=Ve.moveAway(i,u,x);let E,I;return a=Ve.shiftPoint(t,n,o*4),a=Ve.shiftPoint(a,i,s*4),E=Ve.shiftPoint(n,t,o*4),E=Ve.shiftPoint(E,r,s*4),l=Ve.shiftPoint(r,i,o*4),l=Ve.shiftPoint(l,n,s*4),I=Ve.shiftPoint(i,r,o*4),I=Ve.shiftPoint(I,t,s*4),[a,E,l,I]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,n,r,i,s,o){return Pt.getInstance().sampleGrid(e,s,o,.5,.5,s-.5,.5,s-.5,o-.5,.5,o-.5,t.getX(),t.getY(),i.getX(),i.getY(),r.getX(),r.getY(),n.getX(),n.getY())}transitionsBetween(e,t){let n=Math.trunc(e.getX()),r=Math.trunc(e.getY()),i=Math.trunc(t.getX()),s=Math.trunc(t.getY()),o=Math.abs(s-r)>Math.abs(i-n);if(o){let T=n;n=r,r=T,T=i,i=s,s=T}let a=Math.abs(i-n),l=Math.abs(s-r),u=-a/2,x=r<s?1:-1,E=n<i?1:-1,I=0,b=this.image.get(o?r:n,o?n:r);for(let T=n,N=r;T!==i;T+=E){let B=this.image.get(o?N:T,o?T:N);if(B!==b&&(I++,b=B),u+=l,u>0){if(N===s)break;N+=x,u-=a}}return I}}class kt{constructor(){this.decoder=new Ji}decode(e,t=null){let n,r;if(t!=null&&t.has(W.PURE_BARCODE)){const l=kt.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(l),r=kt.NO_POINTS}else{const l=new Ve(e.getBlackMatrix()).detect();n=this.decoder.decode(l.getBits()),r=l.getPoints()}const i=n.getRawBytes(),s=new Ke(n.getText(),i,8*i.length,r,ie.DATA_MATRIX,q.currentTimeMillis()),o=n.getByteSegments();o!=null&&s.putMetadata(be.BYTE_SEGMENTS,o);const a=n.getECLevel();return a!=null&&s.putMetadata(be.ERROR_CORRECTION_LEVEL,a),s}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t==null||n==null)throw new v;const r=this.moduleSize(t,e);let i=t[1];const s=n[1];let o=t[0];const l=(n[0]-o+1)/r,u=(s-i+1)/r;if(l<=0||u<=0)throw new v;const x=r/2;i+=x,o+=x;const E=new te(l,u);for(let I=0;I<u;I++){const b=i+I*r;for(let T=0;T<l;T++)e.get(o+T*r,b)&&E.set(T,I)}return E}static moduleSize(e,t){const n=t.getWidth();let r=e[0];const i=e[1];for(;r<n&&t.get(r,i);)r++;if(r===n)throw new v;const s=r-e[0];if(s===0)throw new v;return s}}kt.NO_POINTS=[];class $i extends Et{constructor(e=500){super(new kt,e)}}var sn;(function(g){g[g.L=0]="L",g[g.M=1]="M",g[g.Q=2]="Q",g[g.H=3]="H"})(sn||(sn={}));class Oe{constructor(e,t,n){this.value=e,this.stringValue=t,this.bits=n,Oe.FOR_BITS.set(n,this),Oe.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return Oe.L;case"M":return Oe.M;case"Q":return Oe.Q;case"H":return Oe.H;default:throw new O(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof Oe))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=Oe.FOR_BITS.size)throw new R;return Oe.FOR_BITS.get(e)}}Oe.FOR_BITS=new Map,Oe.FOR_VALUE=new Map,Oe.L=new Oe(sn.L,"L",1),Oe.M=new Oe(sn.M,"M",0),Oe.Q=new Oe(sn.Q,"Q",3),Oe.H=new Oe(sn.H,"H",2);class et{constructor(e){this.errorCorrectionLevel=Oe.forBits(e>>3&3),this.dataMask=e&7}static numBitsDiffering(e,t){return G.bitCount(e^t)}static decodeFormatInformation(e,t){const n=et.doDecodeFormatInformation(e,t);return n!==null?n:et.doDecodeFormatInformation(e^et.FORMAT_INFO_MASK_QR,t^et.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let n=Number.MAX_SAFE_INTEGER,r=0;for(const i of et.FORMAT_INFO_DECODE_LOOKUP){const s=i[0];if(s===e||s===t)return new et(i[1]);let o=et.numBitsDiffering(e,s);o<n&&(r=i[1],n=o),e!==t&&(o=et.numBitsDiffering(t,s),o<n&&(r=i[1],n=o))}return n<=3?new et(r):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof et))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}et.FORMAT_INFO_MASK_QR=21522,et.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class _{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const n of t)e+=n.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class m{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ne{constructor(e,t,...n){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=n;let r=0;const i=n[0].getECCodewordsPerBlock(),s=n[0].getECBlocks();for(const o of s)r+=o.getCount()*(o.getDataCodewords()+i);this.totalCodewords=r}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!==1)throw new P;try{return this.getVersionForNumber((e-17)/4)}catch{throw new P}}static getVersionForNumber(e){if(e<1||e>40)throw new R;return ne.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,n=0;for(let r=0;r<ne.VERSION_DECODE_INFO.length;r++){const i=ne.VERSION_DECODE_INFO[r];if(i===e)return ne.getVersionForNumber(r+7);const s=et.numBitsDiffering(e,i);s<t&&(n=r+7,t=s)}return t<=3?ne.getVersionForNumber(n):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new te(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const n=this.alignmentPatternCenters.length;for(let r=0;r<n;r++){const i=this.alignmentPatternCenters[r]-2;for(let s=0;s<n;s++)r===0&&(s===0||s===n-1)||r===n-1&&s===0||t.setRegion(this.alignmentPatternCenters[s]-2,i,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}ne.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ne.VERSIONS=[new ne(1,new Int32Array(0),new _(7,new m(1,19)),new _(10,new m(1,16)),new _(13,new m(1,13)),new _(17,new m(1,9))),new ne(2,Int32Array.from([6,18]),new _(10,new m(1,34)),new _(16,new m(1,28)),new _(22,new m(1,22)),new _(28,new m(1,16))),new ne(3,Int32Array.from([6,22]),new _(15,new m(1,55)),new _(26,new m(1,44)),new _(18,new m(2,17)),new _(22,new m(2,13))),new ne(4,Int32Array.from([6,26]),new _(20,new m(1,80)),new _(18,new m(2,32)),new _(26,new m(2,24)),new _(16,new m(4,9))),new ne(5,Int32Array.from([6,30]),new _(26,new m(1,108)),new _(24,new m(2,43)),new _(18,new m(2,15),new m(2,16)),new _(22,new m(2,11),new m(2,12))),new ne(6,Int32Array.from([6,34]),new _(18,new m(2,68)),new _(16,new m(4,27)),new _(24,new m(4,19)),new _(28,new m(4,15))),new ne(7,Int32Array.from([6,22,38]),new _(20,new m(2,78)),new _(18,new m(4,31)),new _(18,new m(2,14),new m(4,15)),new _(26,new m(4,13),new m(1,14))),new ne(8,Int32Array.from([6,24,42]),new _(24,new m(2,97)),new _(22,new m(2,38),new m(2,39)),new _(22,new m(4,18),new m(2,19)),new _(26,new m(4,14),new m(2,15))),new ne(9,Int32Array.from([6,26,46]),new _(30,new m(2,116)),new _(22,new m(3,36),new m(2,37)),new _(20,new m(4,16),new m(4,17)),new _(24,new m(4,12),new m(4,13))),new ne(10,Int32Array.from([6,28,50]),new _(18,new m(2,68),new m(2,69)),new _(26,new m(4,43),new m(1,44)),new _(24,new m(6,19),new m(2,20)),new _(28,new m(6,15),new m(2,16))),new ne(11,Int32Array.from([6,30,54]),new _(20,new m(4,81)),new _(30,new m(1,50),new m(4,51)),new _(28,new m(4,22),new m(4,23)),new _(24,new m(3,12),new m(8,13))),new ne(12,Int32Array.from([6,32,58]),new _(24,new m(2,92),new m(2,93)),new _(22,new m(6,36),new m(2,37)),new _(26,new m(4,20),new m(6,21)),new _(28,new m(7,14),new m(4,15))),new ne(13,Int32Array.from([6,34,62]),new _(26,new m(4,107)),new _(22,new m(8,37),new m(1,38)),new _(24,new m(8,20),new m(4,21)),new _(22,new m(12,11),new m(4,12))),new ne(14,Int32Array.from([6,26,46,66]),new _(30,new m(3,115),new m(1,116)),new _(24,new m(4,40),new m(5,41)),new _(20,new m(11,16),new m(5,17)),new _(24,new m(11,12),new m(5,13))),new ne(15,Int32Array.from([6,26,48,70]),new _(22,new m(5,87),new m(1,88)),new _(24,new m(5,41),new m(5,42)),new _(30,new m(5,24),new m(7,25)),new _(24,new m(11,12),new m(7,13))),new ne(16,Int32Array.from([6,26,50,74]),new _(24,new m(5,98),new m(1,99)),new _(28,new m(7,45),new m(3,46)),new _(24,new m(15,19),new m(2,20)),new _(30,new m(3,15),new m(13,16))),new ne(17,Int32Array.from([6,30,54,78]),new _(28,new m(1,107),new m(5,108)),new _(28,new m(10,46),new m(1,47)),new _(28,new m(1,22),new m(15,23)),new _(28,new m(2,14),new m(17,15))),new ne(18,Int32Array.from([6,30,56,82]),new _(30,new m(5,120),new m(1,121)),new _(26,new m(9,43),new m(4,44)),new _(28,new m(17,22),new m(1,23)),new _(28,new m(2,14),new m(19,15))),new ne(19,Int32Array.from([6,30,58,86]),new _(28,new m(3,113),new m(4,114)),new _(26,new m(3,44),new m(11,45)),new _(26,new m(17,21),new m(4,22)),new _(26,new m(9,13),new m(16,14))),new ne(20,Int32Array.from([6,34,62,90]),new _(28,new m(3,107),new m(5,108)),new _(26,new m(3,41),new m(13,42)),new _(30,new m(15,24),new m(5,25)),new _(28,new m(15,15),new m(10,16))),new ne(21,Int32Array.from([6,28,50,72,94]),new _(28,new m(4,116),new m(4,117)),new _(26,new m(17,42)),new _(28,new m(17,22),new m(6,23)),new _(30,new m(19,16),new m(6,17))),new ne(22,Int32Array.from([6,26,50,74,98]),new _(28,new m(2,111),new m(7,112)),new _(28,new m(17,46)),new _(30,new m(7,24),new m(16,25)),new _(24,new m(34,13))),new ne(23,Int32Array.from([6,30,54,78,102]),new _(30,new m(4,121),new m(5,122)),new _(28,new m(4,47),new m(14,48)),new _(30,new m(11,24),new m(14,25)),new _(30,new m(16,15),new m(14,16))),new ne(24,Int32Array.from([6,28,54,80,106]),new _(30,new m(6,117),new m(4,118)),new _(28,new m(6,45),new m(14,46)),new _(30,new m(11,24),new m(16,25)),new _(30,new m(30,16),new m(2,17))),new ne(25,Int32Array.from([6,32,58,84,110]),new _(26,new m(8,106),new m(4,107)),new _(28,new m(8,47),new m(13,48)),new _(30,new m(7,24),new m(22,25)),new _(30,new m(22,15),new m(13,16))),new ne(26,Int32Array.from([6,30,58,86,114]),new _(28,new m(10,114),new m(2,115)),new _(28,new m(19,46),new m(4,47)),new _(28,new m(28,22),new m(6,23)),new _(30,new m(33,16),new m(4,17))),new ne(27,Int32Array.from([6,34,62,90,118]),new _(30,new m(8,122),new m(4,123)),new _(28,new m(22,45),new m(3,46)),new _(30,new m(8,23),new m(26,24)),new _(30,new m(12,15),new m(28,16))),new ne(28,Int32Array.from([6,26,50,74,98,122]),new _(30,new m(3,117),new m(10,118)),new _(28,new m(3,45),new m(23,46)),new _(30,new m(4,24),new m(31,25)),new _(30,new m(11,15),new m(31,16))),new ne(29,Int32Array.from([6,30,54,78,102,126]),new _(30,new m(7,116),new m(7,117)),new _(28,new m(21,45),new m(7,46)),new _(30,new m(1,23),new m(37,24)),new _(30,new m(19,15),new m(26,16))),new ne(30,Int32Array.from([6,26,52,78,104,130]),new _(30,new m(5,115),new m(10,116)),new _(28,new m(19,47),new m(10,48)),new _(30,new m(15,24),new m(25,25)),new _(30,new m(23,15),new m(25,16))),new ne(31,Int32Array.from([6,30,56,82,108,134]),new _(30,new m(13,115),new m(3,116)),new _(28,new m(2,46),new m(29,47)),new _(30,new m(42,24),new m(1,25)),new _(30,new m(23,15),new m(28,16))),new ne(32,Int32Array.from([6,34,60,86,112,138]),new _(30,new m(17,115)),new _(28,new m(10,46),new m(23,47)),new _(30,new m(10,24),new m(35,25)),new _(30,new m(19,15),new m(35,16))),new ne(33,Int32Array.from([6,30,58,86,114,142]),new _(30,new m(17,115),new m(1,116)),new _(28,new m(14,46),new m(21,47)),new _(30,new m(29,24),new m(19,25)),new _(30,new m(11,15),new m(46,16))),new ne(34,Int32Array.from([6,34,62,90,118,146]),new _(30,new m(13,115),new m(6,116)),new _(28,new m(14,46),new m(23,47)),new _(30,new m(44,24),new m(7,25)),new _(30,new m(59,16),new m(1,17))),new ne(35,Int32Array.from([6,30,54,78,102,126,150]),new _(30,new m(12,121),new m(7,122)),new _(28,new m(12,47),new m(26,48)),new _(30,new m(39,24),new m(14,25)),new _(30,new m(22,15),new m(41,16))),new ne(36,Int32Array.from([6,24,50,76,102,128,154]),new _(30,new m(6,121),new m(14,122)),new _(28,new m(6,47),new m(34,48)),new _(30,new m(46,24),new m(10,25)),new _(30,new m(2,15),new m(64,16))),new ne(37,Int32Array.from([6,28,54,80,106,132,158]),new _(30,new m(17,122),new m(4,123)),new _(28,new m(29,46),new m(14,47)),new _(30,new m(49,24),new m(10,25)),new _(30,new m(24,15),new m(46,16))),new ne(38,Int32Array.from([6,32,58,84,110,136,162]),new _(30,new m(4,122),new m(18,123)),new _(28,new m(13,46),new m(32,47)),new _(30,new m(48,24),new m(14,25)),new _(30,new m(42,15),new m(32,16))),new ne(39,Int32Array.from([6,26,54,82,110,138,166]),new _(30,new m(20,117),new m(4,118)),new _(28,new m(40,47),new m(7,48)),new _(30,new m(43,24),new m(22,25)),new _(30,new m(10,15),new m(67,16))),new ne(40,Int32Array.from([6,30,58,86,114,142,170]),new _(30,new m(19,118),new m(6,119)),new _(28,new m(18,47),new m(31,48)),new _(30,new m(34,24),new m(34,25)),new _(30,new m(20,15),new m(61,16)))];var ze;(function(g){g[g.DATA_MASK_000=0]="DATA_MASK_000",g[g.DATA_MASK_001=1]="DATA_MASK_001",g[g.DATA_MASK_010=2]="DATA_MASK_010",g[g.DATA_MASK_011=3]="DATA_MASK_011",g[g.DATA_MASK_100=4]="DATA_MASK_100",g[g.DATA_MASK_101=5]="DATA_MASK_101",g[g.DATA_MASK_110=6]="DATA_MASK_110",g[g.DATA_MASK_111=7]="DATA_MASK_111"})(ze||(ze={}));class xt{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let n=0;n<t;n++)for(let r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)}}xt.values=new Map([[ze.DATA_MASK_000,new xt(ze.DATA_MASK_000,(g,e)=>(g+e&1)===0)],[ze.DATA_MASK_001,new xt(ze.DATA_MASK_001,(g,e)=>(g&1)===0)],[ze.DATA_MASK_010,new xt(ze.DATA_MASK_010,(g,e)=>e%3===0)],[ze.DATA_MASK_011,new xt(ze.DATA_MASK_011,(g,e)=>(g+e)%3===0)],[ze.DATA_MASK_100,new xt(ze.DATA_MASK_100,(g,e)=>(Math.floor(g/2)+Math.floor(e/3)&1)===0)],[ze.DATA_MASK_101,new xt(ze.DATA_MASK_101,(g,e)=>g*e%6===0)],[ze.DATA_MASK_110,new xt(ze.DATA_MASK_110,(g,e)=>g*e%6<3)],[ze.DATA_MASK_111,new xt(ze.DATA_MASK_111,(g,e)=>(g+e+g*e%3&1)===0)]]);class es{constructor(e){const t=e.getHeight();if(t<21||(t&3)!==1)throw new P;this.bitMatrix=e}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let e=0;for(let i=0;i<6;i++)e=this.copyBit(i,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let i=5;i>=0;i--)e=this.copyBit(8,i,e);const t=this.bitMatrix.getHeight();let n=0;const r=t-7;for(let i=t-1;i>=r;i--)n=this.copyBit(8,i,n);for(let i=t-8;i<t;i++)n=this.copyBit(i,8,n);if(this.parsedFormatInfo=et.decodeFormatInformation(e,n),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new P}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return ne.getVersionForNumber(t);let n=0;const r=e-11;for(let s=5;s>=0;s--)for(let o=e-9;o>=r;o--)n=this.copyBit(o,s,n);let i=ne.decodeVersionInformation(n);if(i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;n=0;for(let s=5;s>=0;s--)for(let o=e-9;o>=r;o--)n=this.copyBit(s,o,n);if(i=ne.decodeVersionInformation(n),i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;throw new P}copyBit(e,t,n){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?n<<1|1:n<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),n=xt.values.get(e.getDataMask()),r=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,r);const i=t.buildFunctionPattern();let s=!0;const o=new Uint8Array(t.getTotalCodewords());let a=0,l=0,u=0;for(let x=r-1;x>0;x-=2){x===6&&x--;for(let E=0;E<r;E++){const I=s?r-1-E:E;for(let b=0;b<2;b++)i.get(x-b,I)||(u++,l<<=1,this.bitMatrix.get(x-b,I)&&(l|=1),u===8&&(o[a++]=l,u=0,l=0))}s=!s}if(a!==t.getTotalCodewords())throw new P;return o}remask(){if(this.parsedFormatInfo===null)return;const e=xt.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,n=e.getWidth();t<n;t++)for(let r=t+1,i=e.getHeight();r<i;r++)e.get(t,r)!==e.get(r,t)&&(e.flip(r,t),e.flip(t,r))}}class Qn{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,n){if(e.length!==t.getTotalCodewords())throw new R;const r=t.getECBlocksForLevel(n);let i=0;const s=r.getECBlocks();for(const b of s)i+=b.getCount();const o=new Array(i);let a=0;for(const b of s)for(let T=0;T<b.getCount();T++){const N=b.getDataCodewords(),B=r.getECCodewordsPerBlock()+N;o[a++]=new Qn(N,new Uint8Array(B))}const l=o[0].codewords.length;let u=o.length-1;for(;u>=0&&o[u].codewords.length!==l;)u--;u++;const x=l-r.getECCodewordsPerBlock();let E=0;for(let b=0;b<x;b++)for(let T=0;T<a;T++)o[T].codewords[b]=e[E++];for(let b=u;b<a;b++)o[b].codewords[x]=e[E++];const I=o[0].codewords.length;for(let b=x;b<I;b++)for(let T=0;T<a;T++){const N=T<u?b:b+1;o[T].codewords[N]=e[E++]}return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var wt;(function(g){g[g.TERMINATOR=0]="TERMINATOR",g[g.NUMERIC=1]="NUMERIC",g[g.ALPHANUMERIC=2]="ALPHANUMERIC",g[g.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",g[g.BYTE=4]="BYTE",g[g.ECI=5]="ECI",g[g.KANJI=6]="KANJI",g[g.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",g[g.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",g[g.HANZI=9]="HANZI"})(wt||(wt={}));class se{constructor(e,t,n,r){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=n,this.bits=r,se.FOR_BITS.set(r,this),se.FOR_VALUE.set(e,this)}static forBits(e){const t=se.FOR_BITS.get(e);if(t===void 0)throw new R;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let n;return t<=9?n=0:t<=26?n=1:n=2,this.characterCountBitsForVersions[n]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof se))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}se.FOR_BITS=new Map,se.FOR_VALUE=new Map,se.TERMINATOR=new se(wt.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),se.NUMERIC=new se(wt.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),se.ALPHANUMERIC=new se(wt.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),se.STRUCTURED_APPEND=new se(wt.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),se.BYTE=new se(wt.BYTE,"BYTE",Int32Array.from([8,16,16]),4),se.ECI=new se(wt.ECI,"ECI",Int32Array.from([0,0,0]),7),se.KANJI=new se(wt.KANJI,"KANJI",Int32Array.from([8,10,12]),8),se.FNC1_FIRST_POSITION=new se(wt.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),se.FNC1_SECOND_POSITION=new se(wt.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),se.HANZI=new se(wt.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Pe{static decode(e,t,n,r){const i=new jn(e);let s=new Z;const o=new Array;let a=-1,l=-1;try{let u=null,x=!1,E;do{if(i.available()<4)E=se.TERMINATOR;else{const I=i.readBits(4);E=se.forBits(I)}switch(E){case se.TERMINATOR:break;case se.FNC1_FIRST_POSITION:case se.FNC1_SECOND_POSITION:x=!0;break;case se.STRUCTURED_APPEND:if(i.available()<16)throw new P;a=i.readBits(8),l=i.readBits(8);break;case se.ECI:const I=Pe.parseECIValue(i);if(u=M.getCharacterSetECIByValue(I),u===null)throw new P;break;case se.HANZI:const b=i.readBits(4),T=i.readBits(E.getCharacterCountBits(t));b===Pe.GB2312_SUBSET&&Pe.decodeHanziSegment(i,s,T);break;default:const N=i.readBits(E.getCharacterCountBits(t));switch(E){case se.NUMERIC:Pe.decodeNumericSegment(i,s,N);break;case se.ALPHANUMERIC:Pe.decodeAlphanumericSegment(i,s,N,x);break;case se.BYTE:Pe.decodeByteSegment(i,s,N,u,o,r);break;case se.KANJI:Pe.decodeKanjiSegment(i,s,N);break;default:throw new P}break}}while(E!==se.TERMINATOR)}catch{throw new P}return new dt(e,s.toString(),o.length===0?null:o,n===null?null:n.toString(),a,l)}static decodeHanziSegment(e,t,n){if(n*13>e.available())throw new P;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const s=e.readBits(13);let o=s/96<<8&4294967295|s%96;o<959?o+=41377:o+=42657,r[i]=o>>8&255,r[i+1]=o&255,i+=2,n--}try{t.append(J.decode(r,U.GB2312))}catch(s){throw new P(s)}}static decodeKanjiSegment(e,t,n){if(n*13>e.available())throw new P;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const s=e.readBits(13);let o=s/192<<8&4294967295|s%192;o<7936?o+=33088:o+=49472,r[i]=o>>8,r[i+1]=o,i+=2,n--}try{t.append(J.decode(r,U.SHIFT_JIS))}catch(s){throw new P(s)}}static decodeByteSegment(e,t,n,r,i,s){if(8*n>e.available())throw new P;const o=new Uint8Array(n);for(let l=0;l<n;l++)o[l]=e.readBits(8);let a;r===null?a=U.guessEncoding(o,s):a=r.getName();try{t.append(J.decode(o,a))}catch(l){throw new P(l)}i.push(o)}static toAlphaNumericChar(e){if(e>=Pe.ALPHANUMERIC_CHARS.length)throw new P;return Pe.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,n,r){const i=t.length();for(;n>1;){if(e.available()<11)throw new P;const s=e.readBits(11);t.append(Pe.toAlphaNumericChar(Math.floor(s/45))),t.append(Pe.toAlphaNumericChar(s%45)),n-=2}if(n===1){if(e.available()<6)throw new P;t.append(Pe.toAlphaNumericChar(e.readBits(6)))}if(r)for(let s=i;s<t.length();s++)t.charAt(s)==="%"&&(s<t.length()-1&&t.charAt(s+1)==="%"?t.deleteCharAt(s+1):t.setCharAt(s,""))}static decodeNumericSegment(e,t,n){for(;n>=3;){if(e.available()<10)throw new P;const r=e.readBits(10);if(r>=1e3)throw new P;t.append(Pe.toAlphaNumericChar(Math.floor(r/100))),t.append(Pe.toAlphaNumericChar(Math.floor(r/10)%10)),t.append(Pe.toAlphaNumericChar(r%10)),n-=3}if(n===2){if(e.available()<7)throw new P;const r=e.readBits(7);if(r>=100)throw new P;t.append(Pe.toAlphaNumericChar(Math.floor(r/10))),t.append(Pe.toAlphaNumericChar(r%10))}else if(n===1){if(e.available()<4)throw new P;const r=e.readBits(4);if(r>=10)throw new P;t.append(Pe.toAlphaNumericChar(r))}}static parseECIValue(e){const t=e.readBits(8);if((t&128)===0)return t&127;if((t&192)===128){const n=e.readBits(8);return(t&63)<<8&4294967295|n}if((t&224)===192){const n=e.readBits(16);return(t&31)<<16&4294967295|n}throw new P}}Pe.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Pe.GB2312_SUBSET=1;class Gr{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||e===null||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class ts{constructor(){this.rsDecoder=new hn(Ee.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(te.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const n=new es(e);let r=null;try{return this.decodeBitMatrixParser(n,t)}catch(i){r=i}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();const i=this.decodeBitMatrixParser(n,t);return i.setOther(new Gr(!0)),i}catch(i){throw r!==null?r:i}}decodeBitMatrixParser(e,t){const n=e.readVersion(),r=e.readFormatInformation().getErrorCorrectionLevel(),i=e.readCodewords(),s=Qn.getDataBlocks(i,n,r);let o=0;for(const u of s)o+=u.getNumDataCodewords();const a=new Uint8Array(o);let l=0;for(const u of s){const x=u.getCodewords(),E=u.getNumDataCodewords();this.correctErrors(x,E);for(let I=0;I<E;I++)a[l++]=x[I]}return Pe.decode(a,n,r,t)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new k}for(let r=0;r<t;r++)e[r]=n[r]}}class Jn extends ee{constructor(e,t,n){super(e,t),this.estimatedModuleSize=n}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=(this.getX()+t)/2,i=(this.getY()+e)/2,s=(this.estimatedModuleSize+n)/2;return new Jn(r,i,s)}}class Dn{constructor(e,t,n,r,i,s,o){this.image=e,this.startX=t,this.startY=n,this.width=r,this.height=i,this.moduleSize=s,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,n=this.width,r=e+n,i=this.startY+t/2,s=new Int32Array(3),o=this.image;for(let a=0;a<t;a++){const l=i+((a&1)===0?Math.floor((a+1)/2):-Math.floor((a+1)/2));s[0]=0,s[1]=0,s[2]=0;let u=e;for(;u<r&&!o.get(u,l);)u++;let x=0;for(;u<r;){if(o.get(u,l))if(x===1)s[1]++;else if(x===2){if(this.foundPatternCross(s)){const E=this.handlePossibleCenter(s,l,u);if(E!==null)return E}s[0]=s[2],s[1]=1,s[2]=0,x=1}else s[++x]++;else x===1&&x++,s[x]++;u++}if(this.foundPatternCross(s)){const E=this.handlePossibleCenter(s,l,r);if(E!==null)return E}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new v}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,n=t/2;for(let r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0}crossCheckVertical(e,t,n,r){const i=this.image,s=i.getHeight(),o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;let a=e;for(;a>=0&&i.get(t,a)&&o[1]<=n;)o[1]++,a--;if(a<0||o[1]>n)return NaN;for(;a>=0&&!i.get(t,a)&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;a<s&&i.get(t,a)&&o[1]<=n;)o[1]++,a++;if(a===s||o[1]>n)return NaN;for(;a<s&&!i.get(t,a)&&o[2]<=n;)o[2]++,a++;if(o[2]>n)return NaN;const l=o[0]+o[1]+o[2];return 5*Math.abs(l-r)>=2*r?NaN:this.foundPatternCross(o)?Dn.centerFromEnd(o,a):NaN}handlePossibleCenter(e,t,n){const r=e[0]+e[1]+e[2],i=Dn.centerFromEnd(e,n),s=this.crossCheckVertical(t,i,2*e[1],r);if(!isNaN(s)){const o=(e[0]+e[1]+e[2])/3;for(const l of this.possibleCenters)if(l.aboutEquals(o,s,i))return l.combineEstimate(s,i,o);const a=new Jn(i,s,o);this.possibleCenters.push(a),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(a)}return null}}class $n extends ee{constructor(e,t,n,r){super(e,t),this.estimatedModuleSize=n,this.count=r,r===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=this.count+1,i=(this.count*this.getX()+t)/r,s=(this.count*this.getY()+e)/r,o=(this.count*this.estimatedModuleSize+n)/r;return new $n(i,s,o,r)}}class ns{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Ze{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=e!=null&&e.get(W.TRY_HARDER)!==void 0,n=e!=null&&e.get(W.PURE_BARCODE)!==void 0,r=this.image,i=r.getHeight(),s=r.getWidth();let o=Math.floor(3*i/(4*Ze.MAX_MODULES));(o<Ze.MIN_SKIP||t)&&(o=Ze.MIN_SKIP);let a=!1;const l=new Int32Array(5);for(let x=o-1;x<i&&!a;x+=o){l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0;let E=0;for(let I=0;I<s;I++)if(r.get(I,x))(E&1)===1&&E++,l[E]++;else if((E&1)===0)if(E===4)if(Ze.foundPatternCross(l)){if(this.handlePossibleCenter(l,x,I,n)===!0)if(o=2,this.hasSkipped===!0)a=this.haveMultiplyConfirmedCenters();else{const T=this.findRowSkip();T>l[2]&&(x+=T-l[2]-o,I=s-1)}else{l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,E=3;continue}E=0,l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0}else l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,E=3;else l[++E]++;else l[E]++;Ze.foundPatternCross(l)&&this.handlePossibleCenter(l,x,s,n)===!0&&(o=l[0],this.hasSkipped&&(a=this.haveMultiplyConfirmedCenters()))}const u=this.selectBestPatterns();return ee.orderBestPatterns(u),new ns(u)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let i=0;i<5;i++){const s=e[i];if(s===0)return!1;t+=s}if(t<7)return!1;const n=t/7,r=n/2;return Math.abs(n-e[0])<r&&Math.abs(n-e[1])<r&&Math.abs(3*n-e[2])<3*r&&Math.abs(n-e[3])<r&&Math.abs(n-e[4])<r}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,n,r){const i=this.getCrossCheckStateCount();let s=0;const o=this.image;for(;e>=s&&t>=s&&o.get(t-s,e-s);)i[2]++,s++;if(e<s||t<s)return!1;for(;e>=s&&t>=s&&!o.get(t-s,e-s)&&i[1]<=n;)i[1]++,s++;if(e<s||t<s||i[1]>n)return!1;for(;e>=s&&t>=s&&o.get(t-s,e-s)&&i[0]<=n;)i[0]++,s++;if(i[0]>n)return!1;const a=o.getHeight(),l=o.getWidth();for(s=1;e+s<a&&t+s<l&&o.get(t+s,e+s);)i[2]++,s++;if(e+s>=a||t+s>=l)return!1;for(;e+s<a&&t+s<l&&!o.get(t+s,e+s)&&i[3]<n;)i[3]++,s++;if(e+s>=a||t+s>=l||i[3]>=n)return!1;for(;e+s<a&&t+s<l&&o.get(t+s,e+s)&&i[4]<n;)i[4]++,s++;if(i[4]>=n)return!1;const u=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(u-r)<2*r&&Ze.foundPatternCross(i)}crossCheckVertical(e,t,n,r){const i=this.image,s=i.getHeight(),o=this.getCrossCheckStateCount();let a=e;for(;a>=0&&i.get(t,a);)o[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(t,a)&&o[1]<=n;)o[1]++,a--;if(a<0||o[1]>n)return NaN;for(;a>=0&&i.get(t,a)&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;a<s&&i.get(t,a);)o[2]++,a++;if(a===s)return NaN;for(;a<s&&!i.get(t,a)&&o[3]<n;)o[3]++,a++;if(a===s||o[3]>=n)return NaN;for(;a<s&&i.get(t,a)&&o[4]<n;)o[4]++,a++;if(o[4]>=n)return NaN;const l=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(l-r)>=2*r?NaN:Ze.foundPatternCross(o)?Ze.centerFromEnd(o,a):NaN}crossCheckHorizontal(e,t,n,r){const i=this.image,s=i.getWidth(),o=this.getCrossCheckStateCount();let a=e;for(;a>=0&&i.get(a,t);)o[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(a,t)&&o[1]<=n;)o[1]++,a--;if(a<0||o[1]>n)return NaN;for(;a>=0&&i.get(a,t)&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;a<s&&i.get(a,t);)o[2]++,a++;if(a===s)return NaN;for(;a<s&&!i.get(a,t)&&o[3]<n;)o[3]++,a++;if(a===s||o[3]>=n)return NaN;for(;a<s&&i.get(a,t)&&o[4]<n;)o[4]++,a++;if(o[4]>=n)return NaN;const l=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(l-r)>=r?NaN:Ze.foundPatternCross(o)?Ze.centerFromEnd(o,a):NaN}handlePossibleCenter(e,t,n,r){const i=e[0]+e[1]+e[2]+e[3]+e[4];let s=Ze.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(s),e[2],i);if(!isNaN(o)&&(s=this.crossCheckHorizontal(Math.floor(s),Math.floor(o),e[2],i),!isNaN(s)&&(!r||this.crossCheckDiagonal(Math.floor(o),Math.floor(s),e[2],i)))){const a=i/7;let l=!1;const u=this.possibleCenters;for(let x=0,E=u.length;x<E;x++){const I=u[x];if(I.aboutEquals(a,o,s)){u[x]=I.combineEstimate(o,s,a),l=!0;break}}if(!l){const x=new $n(s,o,a);u.push(x),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(x)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let t=null;for(const n of this.possibleCenters)if(n.getCount()>=Ze.CENTER_QUORUM)if(t==null)t=n;else return this.hasSkipped=!0,Math.floor((Math.abs(t.getX()-n.getX())-Math.abs(t.getY()-n.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const n=this.possibleCenters.length;for(const s of this.possibleCenters)s.getCount()>=Ze.CENTER_QUORUM&&(e++,t+=s.getEstimatedModuleSize());if(e<3)return!1;const r=t/n;let i=0;for(const s of this.possibleCenters)i+=Math.abs(s.getEstimatedModuleSize()-r);return i<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new v;const t=this.possibleCenters;let n;if(e>3){let r=0,i=0;for(const a of this.possibleCenters){const l=a.getEstimatedModuleSize();r+=l,i+=l*l}n=r/e;let s=Math.sqrt(i/e-n*n);t.sort((a,l)=>{const u=Math.abs(l.getEstimatedModuleSize()-n),x=Math.abs(a.getEstimatedModuleSize()-n);return u<x?-1:u>x?1:0});const o=Math.max(.2*n,s);for(let a=0;a<t.length&&t.length>3;a++){const l=t[a];Math.abs(l.getEstimatedModuleSize()-n)>o&&(t.splice(a,1),a--)}}if(t.length>3){let r=0;for(const i of t)r+=i.getEstimatedModuleSize();n=r/t.length,t.sort((i,s)=>{if(s.getCount()===i.getCount()){const o=Math.abs(s.getEstimatedModuleSize()-n),a=Math.abs(i.getEstimatedModuleSize()-n);return o<a?1:o>a?-1:0}else return s.getCount()-i.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}Ze.CENTER_QUORUM=2,Ze.MIN_SKIP=3,Ze.MAX_MODULES=57;class gn{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=e==null?null:e.get(W.NEED_RESULT_POINT_CALLBACK);const n=new Ze(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(n)}processFinderPatternInfo(e){const t=e.getTopLeft(),n=e.getTopRight(),r=e.getBottomLeft(),i=this.calculateModuleSize(t,n,r);if(i<1)throw new v("No pattern found in proccess finder.");const s=gn.computeDimension(t,n,r,i),o=ne.getProvisionalVersionForDimension(s),a=o.getDimensionForVersion()-7;let l=null;if(o.getAlignmentPatternCenters().length>0){const I=n.getX()-t.getX()+r.getX(),b=n.getY()-t.getY()+r.getY(),T=1-3/a,N=Math.floor(t.getX()+T*(I-t.getX())),B=Math.floor(t.getY()+T*(b-t.getY()));for(let V=4;V<=16;V<<=1)try{l=this.findAlignmentInRegion(i,N,B,V);break}catch(H){if(!(H instanceof v))throw H}}const u=gn.createTransform(t,n,r,l,s),x=gn.sampleGrid(this.image,u,s);let E;return l===null?E=[r,t,n]:E=[r,t,n,l],new Sn(x,E)}static createTransform(e,t,n,r,i){const s=i-3.5;let o,a,l,u;return r!==null?(o=r.getX(),a=r.getY(),l=s-3,u=l):(o=t.getX()-e.getX()+n.getX(),a=t.getY()-e.getY()+n.getY(),l=s,u=s),Ct.quadrilateralToQuadrilateral(3.5,3.5,s,3.5,l,u,3.5,s,e.getX(),e.getY(),t.getX(),t.getY(),o,a,n.getX(),n.getY())}static sampleGrid(e,t,n){return Pt.getInstance().sampleGridWithTransform(e,n,n,t)}static computeDimension(e,t,n,r){const i=we.round(ee.distance(e,t)/r),s=we.round(ee.distance(e,n)/r);let o=Math.floor((i+s)/2)+7;switch(o&3){case 0:o++;break;case 2:o--;break;case 3:throw new v("Dimensions could be not found.")}return o}calculateModuleSize(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2}calculateModuleSizeOneWay(e,t){const n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,n,r){let i=this.sizeOfBlackWhiteBlackRun(e,t,n,r),s=1,o=e-(n-e);o<0?(s=e/(e-o),o=0):o>=this.image.getWidth()&&(s=(this.image.getWidth()-1-e)/(o-e),o=this.image.getWidth()-1);let a=Math.floor(t-(r-t)*s);return s=1,a<0?(s=t/(t-a),a=0):a>=this.image.getHeight()&&(s=(this.image.getHeight()-1-t)/(a-t),a=this.image.getHeight()-1),o=Math.floor(e+(o-e)*s),i+=this.sizeOfBlackWhiteBlackRun(e,t,o,a),i-1}sizeOfBlackWhiteBlackRun(e,t,n,r){const i=Math.abs(r-t)>Math.abs(n-e);if(i){let I=e;e=t,t=I,I=n,n=r,r=I}const s=Math.abs(n-e),o=Math.abs(r-t);let a=-s/2;const l=e<n?1:-1,u=t<r?1:-1;let x=0;const E=n+l;for(let I=e,b=t;I!==E;I+=l){const T=i?b:I,N=i?I:b;if(x===1===this.image.get(T,N)){if(x===2)return we.distance(I,b,e,t);x++}if(a+=o,a>0){if(b===r)break;b+=u,a-=s}}return x===2?we.distance(n+l,r,e,t):NaN}findAlignmentInRegion(e,t,n,r){const i=Math.floor(r*e),s=Math.max(0,t-i),o=Math.min(this.image.getWidth()-1,t+i);if(o-s<e*3)throw new v("Alignment top exceeds estimated module size.");const a=Math.max(0,n-i),l=Math.min(this.image.getHeight()-1,n+i);if(l-a<e*3)throw new v("Alignment bottom exceeds estimated module size.");return new Dn(this.image,s,a,o-s,l-a,e,this.resultPointCallback).find()}}class Ut{constructor(){this.decoder=new ts}getDecoder(){return this.decoder}decode(e,t){let n,r;if(t!=null&&t.get(W.PURE_BARCODE)!==void 0){const a=Ut.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(a,t),r=Ut.NO_POINTS}else{const a=new gn(e.getBlackMatrix()).detect(t);n=this.decoder.decodeBitMatrix(a.getBits(),t),r=a.getPoints()}n.getOther()instanceof Gr&&n.getOther().applyMirroredCorrection(r);const i=new Ke(n.getText(),n.getRawBytes(),void 0,r,ie.QR_CODE,void 0),s=n.getByteSegments();s!==null&&i.putMetadata(be.BYTE_SEGMENTS,s);const o=n.getECLevel();return o!==null&&i.putMetadata(be.ERROR_CORRECTION_LEVEL,o),n.hasStructuredAppend()&&(i.putMetadata(be.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),i.putMetadata(be.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),i}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t===null||n===null)throw new v;const r=this.moduleSize(t,e);let i=t[1],s=n[1],o=t[0],a=n[0];if(o>=a||i>=s)throw new v;if(s-i!==a-o&&(a=o+(s-i),a>=e.getWidth()))throw new v;const l=Math.round((a-o+1)/r),u=Math.round((s-i+1)/r);if(l<=0||u<=0)throw new v;if(u!==l)throw new v;const x=Math.floor(r/2);i+=x,o+=x;const E=o+Math.floor((l-1)*r)-a;if(E>0){if(E>x)throw new v;o-=E}const I=i+Math.floor((u-1)*r)-s;if(I>0){if(I>x)throw new v;i-=I}const b=new te(l,u);for(let T=0;T<u;T++){const N=i+Math.floor(T*r);for(let B=0;B<l;B++)e.get(o+Math.floor(B*r),N)&&b.set(B,T)}return b}static moduleSize(e,t){const n=t.getHeight(),r=t.getWidth();let i=e[0],s=e[1],o=!0,a=0;for(;i<r&&s<n;){if(o!==t.get(i,s)){if(++a===5)break;o=!o}i++,s++}if(i===r||s===n)throw new v;return(i-e[0])/7}}Ut.NO_POINTS=new Array;class ce{PDF417Common(){}static getBitCountSum(e){return we.sum(e)}static toIntArray(e){if(e==null||!e.length)return ce.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let n=0;for(const r of e)t[n++]=r;return t}static getCodeword(e){const t=$.binarySearch(ce.SYMBOL_TABLE,e&262143);return t<0?-1:(ce.CODEWORD_TABLE[t]-1)%ce.NUMBER_OF_CODEWORDS}}ce.NUMBER_OF_CODEWORDS=929,ce.MAX_CODEWORDS_IN_BARCODE=ce.NUMBER_OF_CODEWORDS-1,ce.MIN_ROWS_IN_BARCODE=3,ce.MAX_ROWS_IN_BARCODE=90,ce.MODULES_IN_CODEWORD=17,ce.MODULES_IN_STOP_PATTERN=18,ce.BARS_IN_MODULE=8,ce.EMPTY_INT_ARRAY=new Int32Array([]),ce.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),ce.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class rs{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class he{static detectMultiple(e,t,n){let r=e.getBlackMatrix(),i=he.detect(n,r);return i.length||(r=r.clone(),r.rotate180(),i=he.detect(n,r)),new rs(r,i)}static detect(e,t){const n=new Array;let r=0,i=0,s=!1;for(;r<t.getHeight();){const o=he.findVertices(t,r,i);if(o[0]==null&&o[3]==null){if(!s)break;s=!1,i=0;for(const a of n)a[1]!=null&&(r=Math.trunc(Math.max(r,a[1].getY()))),a[3]!=null&&(r=Math.max(r,Math.trunc(a[3].getY())));r+=he.ROW_STEP;continue}if(s=!0,n.push(o),!e)break;o[2]!=null?(i=Math.trunc(o[2].getX()),r=Math.trunc(o[2].getY())):(i=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY()))}return n}static findVertices(e,t,n){const r=e.getHeight(),i=e.getWidth(),s=new Array(8);return he.copyToResult(s,he.findRowsWithPattern(e,r,i,t,n,he.START_PATTERN),he.INDEXES_START_PATTERN),s[4]!=null&&(n=Math.trunc(s[4].getX()),t=Math.trunc(s[4].getY())),he.copyToResult(s,he.findRowsWithPattern(e,r,i,t,n,he.STOP_PATTERN),he.INDEXES_STOP_PATTERN),s}static copyToResult(e,t,n){for(let r=0;r<n.length;r++)e[n[r]]=t[r]}static findRowsWithPattern(e,t,n,r,i,s){const o=new Array(4);let a=!1;const l=new Int32Array(s.length);for(;r<t;r+=he.ROW_STEP){let x=he.findGuardPattern(e,i,r,n,!1,s,l);if(x!=null){for(;r>0;){const E=he.findGuardPattern(e,i,--r,n,!1,s,l);if(E!=null)x=E;else{r++;break}}o[0]=new ee(x[0],r),o[1]=new ee(x[1],r),a=!0;break}}let u=r+1;if(a){let x=0,E=Int32Array.from([Math.trunc(o[0].getX()),Math.trunc(o[1].getX())]);for(;u<t;u++){const I=he.findGuardPattern(e,E[0],u,n,!1,s,l);if(I!=null&&Math.abs(E[0]-I[0])<he.MAX_PATTERN_DRIFT&&Math.abs(E[1]-I[1])<he.MAX_PATTERN_DRIFT)E=I,x=0;else{if(x>he.SKIPPED_ROW_COUNT_MAX)break;x++}}u-=x+1,o[2]=new ee(E[0],u),o[3]=new ee(E[1],u)}return u-r<he.BARCODE_MIN_HEIGHT&&$.fill(o,null),o}static findGuardPattern(e,t,n,r,i,s,o){$.fillWithin(o,0,o.length,0);let a=t,l=0;for(;e.get(a,n)&&a>0&&l++<he.MAX_PIXEL_DRIFT;)a--;let u=a,x=0,E=s.length;for(let I=i;u<r;u++)if(e.get(u,n)!==I)o[x]++;else{if(x===E-1){if(he.patternMatchVariance(o,s,he.MAX_INDIVIDUAL_VARIANCE)<he.MAX_AVG_VARIANCE)return new Int32Array([a,u]);a+=o[0]+o[1],q.arraycopy(o,2,o,0,x-1),o[x-1]=0,o[x]=0,x--}else x++;o[x]=1,I=!I}return x===E-1&&he.patternMatchVariance(o,s,he.MAX_INDIVIDUAL_VARIANCE)<he.MAX_AVG_VARIANCE?new Int32Array([a,u-1]):null}static patternMatchVariance(e,t,n){let r=e.length,i=0,s=0;for(let l=0;l<r;l++)i+=e[l],s+=t[l];if(i<s)return 1/0;let o=i/s;n*=o;let a=0;for(let l=0;l<r;l++){let u=e[l],x=t[l]*o,E=u>x?u-x:x-u;if(E>n)return 1/0;a+=E}return a/i}}he.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),he.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),he.MAX_AVG_VARIANCE=.42,he.MAX_INDIVIDUAL_VARIANCE=.8,he.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),he.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),he.MAX_PIXEL_DRIFT=3,he.MAX_PATTERN_DRIFT=5,he.SKIPPED_ROW_COUNT_MAX=25,he.ROW_STEP=5,he.BARCODE_MIN_HEIGHT=10;class je{constructor(e,t){if(t.length===0)throw new R;this.field=e;let n=t.length;if(n>1&&t[0]===0){let r=1;for(;r<n&&t[r]===0;)r++;r===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-r),q.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);if(e===1){let r=0;for(let i of this.coefficients)r=this.field.add(r,i);return r}let t=this.coefficients[0],n=this.coefficients.length;for(let r=1;r<n;r++)t=this.field.add(this.field.multiply(e,t),this.coefficients[r]);return t}add(e){if(!this.field.equals(e.field))throw new R("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){let s=t;t=n,n=s}let r=new Int32Array(n.length),i=n.length-t.length;q.arraycopy(n,0,r,0,i);for(let s=i;s<n.length;s++)r[s]=this.field.add(t[s-i],n[s]);return new je(this.field,r)}subtract(e){if(!this.field.equals(e.field))throw new R("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof je?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new R("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new je(this.field,new Int32Array([0]));let t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,s=new Int32Array(n+i-1);for(let o=0;o<n;o++){let a=t[o];for(let l=0;l<i;l++)s[o+l]=this.field.add(s[o+l],this.field.multiply(a,r[l]))}return new je(this.field,s)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=this.field.subtract(0,this.coefficients[n]);return new je(this.field,t)}multiplyScalar(e){if(e===0)return new je(this.field,new Int32Array([0]));if(e===1)return this;let t=this.coefficients.length,n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new je(this.field,n)}multiplyByMonomial(e,t){if(e<0)throw new R;if(t===0)return new je(this.field,new Int32Array([0]));let n=this.coefficients.length,r=new Int32Array(n+e);for(let i=0;i<n;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new je(this.field,r)}toString(){let e=new Z;for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(t===0||n!==1)&&e.append(n),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class is{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(e===0)throw new R;return this.logTable[e]}inverse(e){if(e===0)throw new yn;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class er extends is{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let n=1;for(let r=0;r<e;r++)this.expTable[r]=n,n=n*t%e;for(let r=0;r<e-1;r++)this.logTable[this.expTable[r]]=r;this.zero=new je(this,new Int32Array([0])),this.one=new je(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new R;if(t===0)return this.zero;let n=new Int32Array(e+1);return n[0]=t,new je(this,n)}}er.PDF417_GF=new er(ce.NUMBER_OF_CODEWORDS,3);class Hr{constructor(){this.field=er.PDF417_GF}decode(e,t,n){let r=new je(this.field,e),i=new Int32Array(t),s=!1;for(let b=t;b>0;b--){let T=r.evaluateAt(this.field.exp(b));i[t-b]=T,T!==0&&(s=!0)}if(!s)return 0;let o=this.field.getOne();if(n!=null)for(const b of n){let T=this.field.exp(e.length-1-b),N=new je(this.field,new Int32Array([this.field.subtract(0,T),1]));o=o.multiply(N)}let a=new je(this.field,i),l=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),a,t),u=l[0],x=l[1],E=this.findErrorLocations(u),I=this.findErrorMagnitudes(x,u,E);for(let b=0;b<E.length;b++){let T=e.length-1-this.field.log(E[b]);if(T<0)throw k.getChecksumInstance();e[T]=this.field.subtract(e[T],I[b])}return E.length}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){let E=e;e=t,t=E}let r=e,i=t,s=this.field.getZero(),o=this.field.getOne();for(;i.getDegree()>=Math.round(n/2);){let E=r,I=s;if(r=i,s=o,r.isZero())throw k.getChecksumInstance();i=E;let b=this.field.getZero(),T=r.getCoefficient(r.getDegree()),N=this.field.inverse(T);for(;i.getDegree()>=r.getDegree()&&!i.isZero();){let B=i.getDegree()-r.getDegree(),V=this.field.multiply(i.getCoefficient(i.getDegree()),N);b=b.add(this.field.buildMonomial(B,V)),i=i.subtract(r.multiplyByMonomial(B,V))}o=b.multiply(s).subtract(I).negative()}let a=o.getCoefficient(0);if(a===0)throw k.getChecksumInstance();let l=this.field.inverse(a),u=o.multiply(l),x=i.multiply(l);return[u,x]}findErrorLocations(e){let t=e.getDegree(),n=new Int32Array(t),r=0;for(let i=1;i<this.field.getSize()&&r<t;i++)e.evaluateAt(i)===0&&(n[r]=this.field.inverse(i),r++);if(r!==t)throw k.getChecksumInstance();return n}findErrorMagnitudes(e,t,n){let r=t.getDegree(),i=new Int32Array(r);for(let l=1;l<=r;l++)i[r-l]=this.field.multiply(l,t.getCoefficient(l));let s=new je(this.field,i),o=n.length,a=new Int32Array(o);for(let l=0;l<o;l++){let u=this.field.inverse(n[l]),x=this.field.subtract(0,e.evaluateAt(u)),E=this.field.inverse(s.evaluateAt(u));a[l]=this.field.multiply(x,E)}return a}}class Kt{constructor(e,t,n,r,i){e instanceof Kt?this.constructor_2(e):this.constructor_1(e,t,n,r,i)}constructor_1(e,t,n,r,i){const s=t==null||n==null,o=r==null||i==null;if(s&&o)throw new v;s?(t=new ee(0,r.getY()),n=new ee(0,i.getY())):o&&(r=new ee(e.getWidth()-1,t.getY()),i=new ee(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=r,this.bottomRight=i,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(r.getX(),i.getX())),this.minY=Math.trunc(Math.min(t.getY(),r.getY())),this.maxY=Math.trunc(Math.max(n.getY(),i.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return e==null?t:t==null?e:new Kt(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,n){let r=this.topLeft,i=this.bottomLeft,s=this.topRight,o=this.bottomRight;if(e>0){let a=n?this.topLeft:this.topRight,l=Math.trunc(a.getY()-e);l<0&&(l=0);let u=new ee(a.getX(),l);n?r=u:s=u}if(t>0){let a=n?this.bottomLeft:this.bottomRight,l=Math.trunc(a.getY()+t);l>=this.image.getHeight()&&(l=this.image.getHeight()-1);let u=new ee(a.getX(),l);n?i=u:o=u}return new Kt(this.image,r,i,s,o)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class ss{constructor(e,t,n,r){this.columnCount=e,this.errorCorrectionLevel=r,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class xn{constructor(){this.buffer=""}static form(e,t){let n=-1;function r(s,o,a,l,u,x){if(s==="%%")return"%";if(t[++n]===void 0)return;s=l?parseInt(l.substr(1)):void 0;let E=u?parseInt(u.substr(1)):void 0,I;switch(x){case"s":I=t[n];break;case"c":I=t[n][0];break;case"f":I=parseFloat(t[n]).toFixed(s);break;case"p":I=parseFloat(t[n]).toPrecision(s);break;case"e":I=parseFloat(t[n]).toExponential(s);break;case"x":I=parseInt(t[n]).toString(E||16);break;case"d":I=parseFloat(parseInt(t[n],E||10).toPrecision(s)).toFixed(0);break}I=typeof I=="object"?JSON.stringify(I):(+I).toString(E);let b=parseInt(a),T=a&&a[0]+""=="0"?"0":" ";for(;I.length<b;)I=o!==void 0?I+T:T+I;return I}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,r)}format(e,...t){this.buffer+=xn.form(e,t)}toString(){return this.buffer}}class wn{constructor(e){this.boundingBox=new Kt(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(t!=null)return t;for(let n=1;n<wn.MAX_NEARBY_DISTANCE;n++){let r=this.imageRowToCodewordIndex(e)-n;if(r>=0&&(t=this.codewords[r],t!=null)||(r=this.imageRowToCodewordIndex(e)+n,r<this.codewords.length&&(t=this.codewords[r],t!=null)))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new xn;let t=0;for(const n of this.codewords){if(n==null){e.format("%3d:    |   %n",t++);continue}e.format("%3d: %3d|%3d%n",t++,n.getRowNumber(),n.getValue())}return e.toString()}}wn.MAX_NEARBY_DISTANCE=5;class An{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[n,r]of this.values.entries()){const i={getKey:()=>n,getValue:()=>r};i.getValue()>e?(e=i.getValue(),t=[],t.push(i.getKey())):i.getValue()===e&&t.push(i.getKey())}return ce.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class Wr extends wn{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())e!=null&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let n=this.getBoundingBox(),r=this._isLeft?n.getTopLeft():n.getTopRight(),i=this._isLeft?n.getBottomLeft():n.getBottomRight(),s=this.imageRowToCodewordIndex(Math.trunc(r.getY())),o=this.imageRowToCodewordIndex(Math.trunc(i.getY())),a=-1,l=1,u=0;for(let x=s;x<o;x++){if(t[x]==null)continue;let E=t[x],I=E.getRowNumber()-a;if(I===0)u++;else if(I===1)l=Math.max(l,u),u=1,a=E.getRowNumber();else if(I<0||E.getRowNumber()>=e.getRowCount()||I>x)t[x]=null;else{let b;l>2?b=(l-2)*I:b=I;let T=b>=x;for(let N=1;N<=b&&!T;N++)T=t[x-N]!=null;T?t[x]=null:(a=E.getRowNumber(),u=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(e==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let n of this.getCodewords())if(n!=null){let r=n.getRowNumber();if(r>=t.length)continue;t[r]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),n=this._isLeft?t.getTopLeft():t.getTopRight(),r=this._isLeft?t.getBottomLeft():t.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(n.getY())),s=this.imageRowToCodewordIndex(Math.trunc(r.getY())),o=this.getCodewords(),a=-1;for(let l=i;l<s;l++){if(o[l]==null)continue;let u=o[l];u.setRowNumberAsRowIndicatorColumn();let x=u.getRowNumber()-a;x===0||(x===1?a=u.getRowNumber():u.getRowNumber()>=e.getRowCount()?o[l]=null:a=u.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new An,n=new An,r=new An,i=new An;for(let o of e){if(o==null)continue;o.setRowNumberAsRowIndicatorColumn();let a=o.getValue()%30,l=o.getRowNumber();switch(this._isLeft||(l+=2),l%3){case 0:n.setValue(a*3+1);break;case 1:i.setValue(a/3),r.setValue(a%3);break;case 2:t.setValue(a+1);break}}if(t.getValue().length===0||n.getValue().length===0||r.getValue().length===0||i.getValue().length===0||t.getValue()[0]<1||n.getValue()[0]+r.getValue()[0]<ce.MIN_ROWS_IN_BARCODE||n.getValue()[0]+r.getValue()[0]>ce.MAX_ROWS_IN_BARCODE)return null;let s=new ss(t.getValue()[0],n.getValue()[0],r.getValue()[0],i.getValue()[0]);return this.removeIncorrectCodewords(e,s),s}removeIncorrectCodewords(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(e[n]==null)continue;let i=r.getValue()%30,s=r.getRowNumber();if(s>t.getRowCount()){e[n]=null;continue}switch(this._isLeft||(s+=2),s%3){case 0:i*3+1!==t.getRowCountUpperPart()&&(e[n]=null);break;case 1:(Math.trunc(i/3)!==t.getErrorCorrectionLevel()||i%3!==t.getRowCountLowerPart())&&(e[n]=null);break;case 2:i+1!==t.getColumnCount()&&(e[n]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class En{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e=ce.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(e===0)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let n=this.detectionResultColumns[t].getCodewords();for(let r=0;r<n.length;r++)n[r]!=null&&(n[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,n))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<e.length;n++)if(e[n]!=null&&t[n]!=null&&e[n].getRowNumber()===t[n].getRowNumber())for(let r=1;r<=this.barcodeColumnCount;r++){let i=this.detectionResultColumns[r].getCodewords()[n];i!=null&&(i.setRowNumber(e[n].getRowNumber()),i.hasValidRowNumber()||(this.detectionResultColumns[r].getCodewords()[n]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<t.length;n++){if(t[n]==null)continue;let r=t[n].getRowNumber(),i=0;for(let s=this.barcodeColumnCount+1;s>0&&i<this.ADJUST_ROW_NUMBER_SKIP;s--){let o=this.detectionResultColumns[s].getCodewords()[n];o!=null&&(i=En.adjustRowNumberIfValid(r,i,o),o.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let n=0;n<t.length;n++){if(t[n]==null)continue;let r=t[n].getRowNumber(),i=0;for(let s=1;s<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;s++){let o=this.detectionResultColumns[s].getCodewords()[n];o!=null&&(i=En.adjustRowNumberIfValid(r,i,o),o.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,n){if(!this.detectionResultColumns[e-1])return;let r=n[t],i=this.detectionResultColumns[e-1].getCodewords(),s=i;this.detectionResultColumns[e+1]!=null&&(s=this.detectionResultColumns[e+1].getCodewords());let o=new Array(14);o[2]=i[t],o[3]=s[t],t>0&&(o[0]=n[t-1],o[4]=i[t-1],o[5]=s[t-1]),t>1&&(o[8]=n[t-2],o[10]=i[t-2],o[11]=s[t-2]),t<n.length-1&&(o[1]=n[t+1],o[6]=i[t+1],o[7]=s[t+1]),t<n.length-2&&(o[9]=n[t+2],o[12]=i[t+2],o[13]=s[t+2]);for(let a of o)if(En.adjustRowNumber(r,a))return}static adjustRowNumber(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new xn;for(let n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(let r=0;r<this.barcodeColumnCount+2;r++){if(this.detectionResultColumns[r]==null){t.format("    |   ");continue}let i=this.detectionResultColumns[r].getCodewords()[n];if(i==null){t.format("    |   ");continue}t.format(" %3d|%3d",i.getRowNumber(),i.getValue())}t.format("%n")}return t.toString()}}class Cn{constructor(e,t,n,r){this.rowNumber=Cn.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(n),this.value=Math.trunc(r)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==Cn.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}Cn.BARCODE_ROW_UNKNOWN=-1;class ot{static initialize(){for(let e=0;e<ce.SYMBOL_TABLE.length;e++){let t=ce.SYMBOL_TABLE[e],n=t&1;for(let r=0;r<ce.BARS_IN_MODULE;r++){let i=0;for(;(t&1)===n;)i+=1,t>>=1;n=t&1,ot.RATIOS_TABLE[e]||(ot.RATIOS_TABLE[e]=new Array(ce.BARS_IN_MODULE)),ot.RATIOS_TABLE[e][ce.BARS_IN_MODULE-r-1]=Math.fround(i/ce.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=ot.getDecodedCodewordValue(ot.sampleBitCounts(e));return t!==-1?t:ot.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=we.sum(e),n=new Int32Array(ce.BARS_IN_MODULE),r=0,i=0;for(let s=0;s<ce.MODULES_IN_CODEWORD;s++){let o=t/(2*ce.MODULES_IN_CODEWORD)+s*t/ce.MODULES_IN_CODEWORD;i+e[r]<=o&&(i+=e[r],r++),n[r]++}return n}static getDecodedCodewordValue(e){let t=ot.getBitValue(e);return ce.getCodeword(t)===-1?-1:t}static getBitValue(e){let t=0;for(let n=0;n<e.length;n++)for(let r=0;r<e[n];r++)t=t<<1|(n%2===0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=we.sum(e),n=new Array(ce.BARS_IN_MODULE);if(t>1)for(let s=0;s<n.length;s++)n[s]=Math.fround(e[s]/t);let r=Tn.MAX_VALUE,i=-1;this.bSymbolTableReady||ot.initialize();for(let s=0;s<ot.RATIOS_TABLE.length;s++){let o=0,a=ot.RATIOS_TABLE[s];for(let l=0;l<ce.BARS_IN_MODULE;l++){let u=Math.fround(a[l]-n[l]);if(o+=Math.fround(u*u),o>=r)break}o<r&&(r=o,i=ce.SYMBOL_TABLE[s])}return i}}ot.bSymbolTableReady=!1,ot.RATIOS_TABLE=new Array(ce.SYMBOL_TABLE.length).map(g=>new Array(ce.BARS_IN_MODULE));class Xr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class Yr{static parseLong(e,t=void 0){return parseInt(e,t)}}class zr extends C{}zr.kind="NullPointerException";class os{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,n){if(e==null)throw new zr;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new Ie;if(n===0)return;for(let r=0;r<n;r++)this.write(e[t+r])}flush(){}close(){}}class as extends C{}class ls extends os{constructor(e=32){if(super(),this.count=0,e<0)throw new R("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let n=this.buf.length<<1;if(n-e<0&&(n=e),n<0){if(e<0)throw new as;n=G.MAX_VALUE}this.buf=$.copyOfUint8Array(this.buf,n)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,n){if(t<0||t>e.length||n<0||t+n-e.length>0)throw new Ie;this.ensureCapacity(this.count+n),q.arraycopy(e,t,this.buf,this.count,n),this.count+=n}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return $.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?typeof e=="string"?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}var ye;(function(g){g[g.ALPHA=0]="ALPHA",g[g.LOWER=1]="LOWER",g[g.MIXED=2]="MIXED",g[g.PUNCT=3]="PUNCT",g[g.ALPHA_SHIFT=4]="ALPHA_SHIFT",g[g.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(ye||(ye={}));function Zr(){if(typeof window<"u")return window.BigInt||null;if(typeof Fn<"u")return Fn.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Mn;function Vt(g){if(typeof Mn>"u"&&(Mn=Zr()),Mn===null)throw new Error("BigInt is not supported!");return Mn(g)}function cs(){let g=[];g[0]=Vt(1);let e=Vt(900);g[1]=e;for(let t=2;t<16;t++)g[t]=g[t-1]*e;return g}class D{static decode(e,t){let n=new Z(""),r=M.ISO8859_1;n.enableDecoding(r);let i=1,s=e[i++],o=new Xr;for(;i<e[0];){switch(s){case D.TEXT_COMPACTION_MODE_LATCH:i=D.textCompaction(e,i,n);break;case D.BYTE_COMPACTION_MODE_LATCH:case D.BYTE_COMPACTION_MODE_LATCH_6:i=D.byteCompaction(s,e,r,i,n);break;case D.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[i++]);break;case D.NUMERIC_COMPACTION_MODE_LATCH:i=D.numericCompaction(e,i,n);break;case D.ECI_CHARSET:M.getCharacterSetECIByValue(e[i++]);break;case D.ECI_GENERAL_PURPOSE:i+=2;break;case D.ECI_USER_DEFINED:i++;break;case D.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=D.decodeMacroBlock(e,i,o);break;case D.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case D.MACRO_PDF417_TERMINATOR:throw new P;default:i--,i=D.textCompaction(e,i,n);break}if(i<e.length)s=e[i++];else throw P.getFormatInstance()}if(n.length()===0)throw P.getFormatInstance();let a=new dt(null,n.toString(),null,t);return a.setOther(o),a}static decodeMacroBlock(e,t,n){if(t+D.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw P.getFormatInstance();let r=new Int32Array(D.NUMBER_OF_SEQUENCE_CODEWORDS);for(let o=0;o<D.NUMBER_OF_SEQUENCE_CODEWORDS;o++,t++)r[o]=e[t];n.setSegmentIndex(G.parseInt(D.decodeBase900toBase10(r,D.NUMBER_OF_SEQUENCE_CODEWORDS)));let i=new Z;t=D.textCompaction(e,t,i),n.setFileId(i.toString());let s=-1;for(e[t]===D.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(s=t+1);t<e[0];)switch(e[t]){case D.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case D.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let o=new Z;t=D.textCompaction(e,t+1,o),n.setFileName(o.toString());break;case D.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let a=new Z;t=D.textCompaction(e,t+1,a),n.setSender(a.toString());break;case D.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let l=new Z;t=D.textCompaction(e,t+1,l),n.setAddressee(l.toString());break;case D.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let u=new Z;t=D.numericCompaction(e,t+1,u),n.setSegmentCount(G.parseInt(u.toString()));break;case D.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let x=new Z;t=D.numericCompaction(e,t+1,x),n.setTimestamp(Yr.parseLong(x.toString()));break;case D.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let E=new Z;t=D.numericCompaction(e,t+1,E),n.setChecksum(G.parseInt(E.toString()));break;case D.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let I=new Z;t=D.numericCompaction(e,t+1,I),n.setFileSize(Yr.parseLong(I.toString()));break;default:throw P.getFormatInstance()}break;case D.MACRO_PDF417_TERMINATOR:t++,n.setLastSegment(!0);break;default:throw P.getFormatInstance()}if(s!==-1){let o=t-s;n.isLastSegment()&&o--,n.setOptionalData($.copyOfRange(e,s,s+o))}return t}static textCompaction(e,t,n){let r=new Int32Array((e[0]-t)*2),i=new Int32Array((e[0]-t)*2),s=0,o=!1;for(;t<e[0]&&!o;){let a=e[t++];if(a<D.TEXT_COMPACTION_MODE_LATCH)r[s]=a/30,r[s+1]=a%30,s+=2;else switch(a){case D.TEXT_COMPACTION_MODE_LATCH:r[s++]=D.TEXT_COMPACTION_MODE_LATCH;break;case D.BYTE_COMPACTION_MODE_LATCH:case D.BYTE_COMPACTION_MODE_LATCH_6:case D.NUMERIC_COMPACTION_MODE_LATCH:case D.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case D.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case D.MACRO_PDF417_TERMINATOR:t--,o=!0;break;case D.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r[s]=D.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,a=e[t++],i[s]=a,s++;break}}return D.decodeTextCompaction(r,i,s,n),t}static decodeTextCompaction(e,t,n,r){let i=ye.ALPHA,s=ye.ALPHA,o=0;for(;o<n;){let a=e[o],l="";switch(i){case ye.ALPHA:if(a<26)l=String.fromCharCode(65+a);else switch(a){case 26:l=" ";break;case D.LL:i=ye.LOWER;break;case D.ML:i=ye.MIXED;break;case D.PS:s=i,i=ye.PUNCT_SHIFT;break;case D.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case D.TEXT_COMPACTION_MODE_LATCH:i=ye.ALPHA;break}break;case ye.LOWER:if(a<26)l=String.fromCharCode(97+a);else switch(a){case 26:l=" ";break;case D.AS:s=i,i=ye.ALPHA_SHIFT;break;case D.ML:i=ye.MIXED;break;case D.PS:s=i,i=ye.PUNCT_SHIFT;break;case D.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case D.TEXT_COMPACTION_MODE_LATCH:i=ye.ALPHA;break}break;case ye.MIXED:if(a<D.PL)l=D.MIXED_CHARS[a];else switch(a){case D.PL:i=ye.PUNCT;break;case 26:l=" ";break;case D.LL:i=ye.LOWER;break;case D.AL:i=ye.ALPHA;break;case D.PS:s=i,i=ye.PUNCT_SHIFT;break;case D.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case D.TEXT_COMPACTION_MODE_LATCH:i=ye.ALPHA;break}break;case ye.PUNCT:if(a<D.PAL)l=D.PUNCT_CHARS[a];else switch(a){case D.PAL:i=ye.ALPHA;break;case D.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case D.TEXT_COMPACTION_MODE_LATCH:i=ye.ALPHA;break}break;case ye.ALPHA_SHIFT:if(i=s,a<26)l=String.fromCharCode(65+a);else switch(a){case 26:l=" ";break;case D.TEXT_COMPACTION_MODE_LATCH:i=ye.ALPHA;break}break;case ye.PUNCT_SHIFT:if(i=s,a<D.PAL)l=D.PUNCT_CHARS[a];else switch(a){case D.PAL:i=ye.ALPHA;break;case D.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case D.TEXT_COMPACTION_MODE_LATCH:i=ye.ALPHA;break}break}l!==""&&r.append(l),o++}}static byteCompaction(e,t,n,r,i){let s=new ls,o=0,a=0,l=!1;switch(e){case D.BYTE_COMPACTION_MODE_LATCH:let u=new Int32Array(6),x=t[r++];for(;r<t[0]&&!l;)switch(u[o++]=x,a=900*a+x,x=t[r++],x){case D.TEXT_COMPACTION_MODE_LATCH:case D.BYTE_COMPACTION_MODE_LATCH:case D.NUMERIC_COMPACTION_MODE_LATCH:case D.BYTE_COMPACTION_MODE_LATCH_6:case D.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case D.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case D.MACRO_PDF417_TERMINATOR:r--,l=!0;break;default:if(o%5===0&&o>0){for(let E=0;E<6;++E)s.write(Number(Vt(a)>>Vt(8*(5-E))));a=0,o=0}break}r===t[0]&&x<D.TEXT_COMPACTION_MODE_LATCH&&(u[o++]=x);for(let E=0;E<o;E++)s.write(u[E]);break;case D.BYTE_COMPACTION_MODE_LATCH_6:for(;r<t[0]&&!l;){let E=t[r++];if(E<D.TEXT_COMPACTION_MODE_LATCH)o++,a=900*a+E;else switch(E){case D.TEXT_COMPACTION_MODE_LATCH:case D.BYTE_COMPACTION_MODE_LATCH:case D.NUMERIC_COMPACTION_MODE_LATCH:case D.BYTE_COMPACTION_MODE_LATCH_6:case D.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case D.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case D.MACRO_PDF417_TERMINATOR:r--,l=!0;break}if(o%5===0&&o>0){for(let I=0;I<6;++I)s.write(Number(Vt(a)>>Vt(8*(5-I))));a=0,o=0}}break}return i.append(J.decode(s.toByteArray(),n)),r}static numericCompaction(e,t,n){let r=0,i=!1,s=new Int32Array(D.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!i;){let o=e[t++];if(t===e[0]&&(i=!0),o<D.TEXT_COMPACTION_MODE_LATCH)s[r]=o,r++;else switch(o){case D.TEXT_COMPACTION_MODE_LATCH:case D.BYTE_COMPACTION_MODE_LATCH:case D.BYTE_COMPACTION_MODE_LATCH_6:case D.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case D.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case D.MACRO_PDF417_TERMINATOR:t--,i=!0;break}(r%D.MAX_NUMERIC_CODEWORDS===0||o===D.NUMERIC_COMPACTION_MODE_LATCH||i)&&r>0&&(n.append(D.decodeBase900toBase10(s,r)),r=0)}return t}static decodeBase900toBase10(e,t){let n=Vt(0);for(let i=0;i<t;i++)n+=D.EXP900[t-i-1]*Vt(e[i]);let r=n.toString();if(r.charAt(0)!=="1")throw new P;return r.substring(1)}}D.TEXT_COMPACTION_MODE_LATCH=900,D.BYTE_COMPACTION_MODE_LATCH=901,D.NUMERIC_COMPACTION_MODE_LATCH=902,D.BYTE_COMPACTION_MODE_LATCH_6=924,D.ECI_USER_DEFINED=925,D.ECI_GENERAL_PURPOSE=926,D.ECI_CHARSET=927,D.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,D.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,D.MACRO_PDF417_TERMINATOR=922,D.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,D.MAX_NUMERIC_CODEWORDS=15,D.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,D.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,D.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,D.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,D.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,D.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,D.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,D.PL=25,D.LL=27,D.AS=27,D.ML=28,D.AL=28,D.PS=29,D.PAL=29,D.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,D.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",D.EXP900=Zr()?cs():[],D.NUMBER_OF_SEQUENCE_CODEWORDS=2;class de{constructor(){}static decode(e,t,n,r,i,s,o){let a=new Kt(e,t,n,r,i),l=null,u=null,x;for(let b=!0;;b=!1){if(t!=null&&(l=de.getRowIndicatorColumn(e,a,t,!0,s,o)),r!=null&&(u=de.getRowIndicatorColumn(e,a,r,!1,s,o)),x=de.merge(l,u),x==null)throw v.getNotFoundInstance();let T=x.getBoundingBox();if(b&&T!=null&&(T.getMinY()<a.getMinY()||T.getMaxY()>a.getMaxY()))a=T;else break}x.setBoundingBox(a);let E=x.getBarcodeColumnCount()+1;x.setDetectionResultColumn(0,l),x.setDetectionResultColumn(E,u);let I=l!=null;for(let b=1;b<=E;b++){let T=I?b:E-b;if(x.getDetectionResultColumn(T)!==void 0)continue;let N;T===0||T===E?N=new Wr(a,T===0):N=new wn(a),x.setDetectionResultColumn(T,N);let B=-1,V=B;for(let H=a.getMinY();H<=a.getMaxY();H++){if(B=de.getStartColumn(x,T,H,I),B<0||B>a.getMaxX()){if(V===-1)continue;B=V}let F=de.detectCodeword(e,a.getMinX(),a.getMaxX(),I,B,H,s,o);F!=null&&(N.setCodeword(H,F),V=B,s=Math.min(s,F.getWidth()),o=Math.max(o,F.getWidth()))}}return de.createDecoderResult(x)}static merge(e,t){if(e==null&&t==null)return null;let n=de.getBarcodeMetadata(e,t);if(n==null)return null;let r=Kt.merge(de.adjustBoundingBox(e),de.adjustBoundingBox(t));return new En(n,r)}static adjustBoundingBox(e){if(e==null)return null;let t=e.getRowHeights();if(t==null)return null;let n=de.getMax(t),r=0;for(let o of t)if(r+=n-o,o>0)break;let i=e.getCodewords();for(let o=0;r>0&&i[o]==null;o++)r--;let s=0;for(let o=t.length-1;o>=0&&(s+=n-t[o],!(t[o]>0));o--);for(let o=i.length-1;s>0&&i[o]==null;o--)s--;return e.getBoundingBox().addMissingRows(r,s,e.isLeft())}static getMax(e){let t=-1;for(let n of e)t=Math.max(t,n);return t}static getBarcodeMetadata(e,t){let n;if(e==null||(n=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();let r;return t==null||(r=t.getBarcodeMetadata())==null?n:n.getColumnCount()!==r.getColumnCount()&&n.getErrorCorrectionLevel()!==r.getErrorCorrectionLevel()&&n.getRowCount()!==r.getRowCount()?null:n}static getRowIndicatorColumn(e,t,n,r,i,s){let o=new Wr(t,r);for(let a=0;a<2;a++){let l=a===0?1:-1,u=Math.trunc(Math.trunc(n.getX()));for(let x=Math.trunc(Math.trunc(n.getY()));x<=t.getMaxY()&&x>=t.getMinY();x+=l){let E=de.detectCodeword(e,0,e.getWidth(),r,u,x,i,s);E!=null&&(o.setCodeword(x,E),r?u=E.getStartX():u=E.getEndX())}}return o}static adjustCodewordCount(e,t){let n=t[0][1],r=n.getValue(),i=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-de.getNumberOfECCodeWords(e.getBarcodeECLevel());if(r.length===0){if(i<1||i>ce.MAX_CODEWORDS_IN_BARCODE)throw v.getNotFoundInstance();n.setValue(i)}else r[0]!==i&&n.setValue(i)}static createDecoderResult(e){let t=de.createBarcodeMatrix(e);de.adjustCodewordCount(e,t);let n=new Array,r=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),i=[],s=new Array;for(let a=0;a<e.getBarcodeRowCount();a++)for(let l=0;l<e.getBarcodeColumnCount();l++){let u=t[a][l+1].getValue(),x=a*e.getBarcodeColumnCount()+l;u.length===0?n.push(x):u.length===1?r[x]=u[0]:(s.push(x),i.push(u))}let o=new Array(i.length);for(let a=0;a<o.length;a++)o[a]=i[a];return de.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),r,ce.toIntArray(n),ce.toIntArray(s),o)}static createDecoderResultFromAmbiguousValues(e,t,n,r,i){let s=new Int32Array(r.length),o=100;for(;o-- >0;){for(let a=0;a<s.length;a++)t[r[a]]=i[a][s[a]];try{return de.decodeCodewords(t,e,n)}catch(a){if(!(a instanceof k))throw a}if(s.length===0)throw k.getChecksumInstance();for(let a=0;a<s.length;a++)if(s[a]<i[a].length-1){s[a]++;break}else if(s[a]=0,a===s.length-1)throw k.getChecksumInstance()}throw k.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++)t[r][i]=new An;let n=0;for(let r of e.getDetectionResultColumns()){if(r!=null){for(let i of r.getCodewords())if(i!=null){let s=i.getRowNumber();if(s>=0){if(s>=t.length)continue;t[s][n].setValue(i.getValue())}}}n++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,n,r){let i=r?1:-1,s=null;if(de.isValidBarcodeColumn(e,t-i)&&(s=e.getDetectionResultColumn(t-i).getCodeword(n)),s!=null)return r?s.getEndX():s.getStartX();if(s=e.getDetectionResultColumn(t).getCodewordNearby(n),s!=null)return r?s.getStartX():s.getEndX();if(de.isValidBarcodeColumn(e,t-i)&&(s=e.getDetectionResultColumn(t-i).getCodewordNearby(n)),s!=null)return r?s.getEndX():s.getStartX();let o=0;for(;de.isValidBarcodeColumn(e,t-i);){t-=i;for(let a of e.getDetectionResultColumn(t).getCodewords())if(a!=null)return(r?a.getEndX():a.getStartX())+i*o*(a.getEndX()-a.getStartX());o++}return r?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,n,r,i,s,o,a){i=de.adjustCodewordStartColumn(e,t,n,r,i,s);let l=de.getModuleBitCount(e,t,n,r,i,s);if(l==null)return null;let u,x=we.sum(l);if(r)u=i+x;else{for(let b=0;b<l.length/2;b++){let T=l[b];l[b]=l[l.length-1-b],l[l.length-1-b]=T}u=i,i=u-x}if(!de.checkCodewordSkew(x,o,a))return null;let E=ot.getDecodedValue(l),I=ce.getCodeword(E);return I===-1?null:new Cn(i,u,de.getCodewordBucketNumber(E),I)}static getModuleBitCount(e,t,n,r,i,s){let o=i,a=new Int32Array(8),l=0,u=r?1:-1,x=r;for(;(r?o<n:o>=t)&&l<a.length;)e.get(o,s)===x?(a[l]++,o+=u):(l++,x=!x);return l===a.length||o===(r?n:t)&&l===a.length-1?a:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,n,r,i,s){let o=i,a=r?-1:1;for(let l=0;l<2;l++){for(;(r?o>=t:o<n)&&r===e.get(o,s);){if(Math.abs(i-o)>de.CODEWORD_SKEW_SIZE)return i;o+=a}a=-a,r=!r}return o}static checkCodewordSkew(e,t,n){return t-de.CODEWORD_SKEW_SIZE<=e&&e<=n+de.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,n){if(e.length===0)throw P.getFormatInstance();let r=1<<t+1,i=de.correctErrors(e,n,r);de.verifyCodewordCount(e,r);let s=D.decode(e,""+t);return s.setErrorsCorrected(i),s.setErasures(n.length),s}static correctErrors(e,t,n){if(t!=null&&t.length>n/2+de.MAX_ERRORS||n<0||n>de.MAX_EC_CODEWORDS)throw k.getChecksumInstance();return de.errorCorrection.decode(e,n,t)}static verifyCodewordCount(e,t){if(e.length<4)throw P.getFormatInstance();let n=e[0];if(n>e.length)throw P.getFormatInstance();if(n===0)if(t<e.length)e[0]=e.length-t;else throw P.getFormatInstance()}static getBitCountForCodeword(e){let t=new Int32Array(8),n=0,r=t.length-1;for(;!((e&1)!==n&&(n=e&1,r--,r<0));)t[r]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return de.getCodewordBucketNumber(de.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new xn;for(let n=0;n<e.length;n++){t.format("Row %2d: ",n);for(let r=0;r<e[n].length;r++){let i=e[n][r];i.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}t.format("%n")}return t.toString()}}de.CODEWORD_SKEW_SIZE=2,de.MAX_ERRORS=3,de.MAX_EC_CODEWORDS=512,de.errorCorrection=new Hr;class Qe{decode(e,t=null){let n=Qe.decode(e,t,!1);if(n==null||n.length===0||n[0]==null)throw v.getNotFoundInstance();return n[0]}decodeMultiple(e,t=null){try{return Qe.decode(e,t,!0)}catch(n){throw n instanceof P||n instanceof k?v.getNotFoundInstance():n}}static decode(e,t,n){const r=new Array,i=he.detectMultiple(e,t,n);for(const s of i.getPoints()){const o=de.decode(i.getBits(),s[4],s[5],s[6],s[7],Qe.getMinCodewordWidth(s),Qe.getMaxCodewordWidth(s)),a=new Ke(o.getText(),o.getRawBytes(),void 0,s,ie.PDF_417);a.putMetadata(be.ERROR_CORRECTION_LEVEL,o.getECLevel());const l=o.getOther();l!=null&&a.putMetadata(be.PDF417_EXTRA_METADATA,l),r.push(a)}return r.map(s=>s)}static getMaxWidth(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return e==null||t==null?G.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(Qe.getMaxWidth(e[0],e[4]),Qe.getMaxWidth(e[6],e[2])*ce.MODULES_IN_CODEWORD/ce.MODULES_IN_STOP_PATTERN),Math.max(Qe.getMaxWidth(e[1],e[5]),Qe.getMaxWidth(e[7],e[3])*ce.MODULES_IN_CODEWORD/ce.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(Qe.getMinWidth(e[0],e[4]),Qe.getMinWidth(e[6],e[2])*ce.MODULES_IN_CODEWORD/ce.MODULES_IN_STOP_PATTERN),Math.min(Qe.getMinWidth(e[1],e[5]),Qe.getMinWidth(e[7],e[3])*ce.MODULES_IN_CODEWORD/ce.MODULES_IN_STOP_PATTERN)))}reset(){}}class Bn extends C{}Bn.kind="ReaderException";class Kr{constructor(e,t){this.verbose=e===!0,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const t=!w(e)&&e.get(W.TRY_HARDER)===!0,n=w(e)?null:e.get(W.POSSIBLE_FORMATS),r=new Array;if(!w(n)){const i=n.some(s=>s===ie.UPC_A||s===ie.UPC_E||s===ie.EAN_13||s===ie.EAN_8||s===ie.CODABAR||s===ie.CODE_39||s===ie.CODE_93||s===ie.CODE_128||s===ie.ITF||s===ie.RSS_14||s===ie.RSS_EXPANDED);i&&!t&&r.push(new rn(e,this.verbose)),n.includes(ie.QR_CODE)&&r.push(new Ut),n.includes(ie.DATA_MATRIX)&&r.push(new kt),n.includes(ie.AZTEC)&&r.push(new Nn),n.includes(ie.PDF_417)&&r.push(new Qe),i&&t&&r.push(new rn(e,this.verbose))}r.length===0&&(t||r.push(new rn(e,this.verbose)),r.push(new Ut),r.push(new kt),r.push(new Nn),r.push(new Qe),t&&r.push(new rn(e,this.verbose))),this.readers=r}reset(){if(this.readers!==null)for(const e of this.readers)e.reset()}decodeInternal(e){if(this.readers===null)throw new Bn("No readers where selected, nothing can be read.");for(const t of this.readers)try{return t.decode(e,this.hints)}catch(n){if(n instanceof Bn)continue}throw new v("No MultiFormat Readers were able to detect the code.")}}class us extends Et{constructor(e=null,t=500){const n=new Kr;n.setHints(e),super(n,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class fs extends Et{constructor(e=500){super(new Qe,e)}}class hs extends Et{constructor(e=500){super(new Ut,e)}}var tr;(function(g){g[g.ERROR_CORRECTION=0]="ERROR_CORRECTION",g[g.CHARACTER_SET=1]="CHARACTER_SET",g[g.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",g[g.MIN_SIZE=3]="MIN_SIZE",g[g.MAX_SIZE=4]="MAX_SIZE",g[g.MARGIN=5]="MARGIN",g[g.PDF417_COMPACT=6]="PDF417_COMPACT",g[g.PDF417_COMPACTION=7]="PDF417_COMPACTION",g[g.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",g[g.AZTEC_LAYERS=9]="AZTEC_LAYERS",g[g.QR_VERSION=10]="QR_VERSION"})(tr||(tr={}));var Xe=tr;class nr{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new rt(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let n=t[t.length-1];const r=this.field;for(let i=t.length;i<=e;i++){const s=n.multiply(new rt(r,Int32Array.from([1,r.exp(i-1+r.getGeneratorBase())])));t.push(s),n=s}}return t[e]}encode(e,t){if(t===0)throw new R("No error correction bytes");const n=e.length-t;if(n<=0)throw new R("No data bytes provided");const r=this.buildGenerator(t),i=new Int32Array(n);q.arraycopy(e,0,i,0,n);let s=new rt(this.field,i);s=s.multiplyByMonomial(t,1);const a=s.divide(r)[1].getCoefficients(),l=t-a.length;for(let u=0;u<l;u++)e[n+u]=0;q.arraycopy(a,0,e,n+l,a.length)}}class ke{constructor(){}static applyMaskPenaltyRule1(e){return ke.applyMaskPenaltyRule1Internal(e,!0)+ke.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let s=0;s<i-1;s++){const o=n[s];for(let a=0;a<r-1;a++){const l=o[a];l===o[a+1]&&l===n[s+1][a]&&l===n[s+1][a+1]&&t++}}return ke.N2*t}static applyMaskPenaltyRule3(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let s=0;s<i;s++)for(let o=0;o<r;o++){const a=n[s];o+6<r&&a[o]===1&&a[o+1]===0&&a[o+2]===1&&a[o+3]===1&&a[o+4]===1&&a[o+5]===0&&a[o+6]===1&&(ke.isWhiteHorizontal(a,o-4,o)||ke.isWhiteHorizontal(a,o+7,o+11))&&t++,s+6<i&&n[s][o]===1&&n[s+1][o]===0&&n[s+2][o]===1&&n[s+3][o]===1&&n[s+4][o]===1&&n[s+5][o]===0&&n[s+6][o]===1&&(ke.isWhiteVertical(n,o,s-4,s)||ke.isWhiteVertical(n,o,s+7,s+11))&&t++}return t*ke.N3}static isWhiteHorizontal(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(let r=t;r<n;r++)if(e[r]===1)return!1;return!0}static isWhiteVertical(e,t,n,r){n=Math.max(n,0),r=Math.min(r,e.length);for(let i=n;i<r;i++)if(e[i][t]===1)return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let a=0;a<i;a++){const l=n[a];for(let u=0;u<r;u++)l[u]===1&&t++}const s=e.getHeight()*e.getWidth();return Math.floor(Math.abs(t*2-s)*10/s)*ke.N4}static getDataMaskBit(e,t,n){let r,i;switch(e){case 0:r=n+t&1;break;case 1:r=n&1;break;case 2:r=t%3;break;case 3:r=(n+t)%3;break;case 4:r=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:i=n*t,r=(i&1)+i%3;break;case 6:i=n*t,r=(i&1)+i%3&1;break;case 7:i=n*t,r=i%3+(n+t&1)&1;break;default:throw new R("Invalid mask pattern: "+e)}return r===0}static applyMaskPenaltyRule1Internal(e,t){let n=0;const r=t?e.getHeight():e.getWidth(),i=t?e.getWidth():e.getHeight(),s=e.getArray();for(let o=0;o<r;o++){let a=0,l=-1;for(let u=0;u<i;u++){const x=t?s[o][u]:s[u][o];x===l?a++:(a>=5&&(n+=ke.N1+(a-5)),a=1,l=x)}a>=5&&(n+=ke.N1+(a-5))}return n}}ke.N1=3,ke.N2=3,ke.N3=40,ke.N4=10;class vn{constructor(e,t){this.width=e,this.height=t;const n=new Array(t);for(let r=0;r!==t;r++)n[r]=new Uint8Array(e);this.bytes=n}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,n){this.bytes[t][e]=n}setBoolean(e,t,n){this.bytes[t][e]=n?1:0}clear(e){for(const t of this.bytes)$.fill(t,e)}equals(e){if(!(e instanceof vn))return!1;const t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(let n=0,r=this.height;n<r;++n){const i=this.bytes[n],s=t.bytes[n];for(let o=0,a=this.width;o<a;++o)if(i[o]!==s[o])return!1}return!0}toString(){const e=new Z;for(let t=0,n=this.height;t<n;++t){const r=this.bytes[t];for(let i=0,s=this.width;i<s;++i)switch(r[i]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()}}class qt{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new Z;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<qt.NUM_MASK_PATTERNS}}qt.NUM_MASK_PATTERNS=8;class Ne extends C{}Ne.kind="WriterException";class le{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,n,r,i){le.clearMatrix(i),le.embedBasicPatterns(n,i),le.embedTypeInfo(t,r,i),le.maybeEmbedVersionInfo(n,i),le.embedDataBits(e,r,i)}static embedBasicPatterns(e,t){le.embedPositionDetectionPatternsAndSeparators(t),le.embedDarkDotAtLeftBottomCorner(t),le.maybeEmbedPositionAdjustmentPatterns(e,t),le.embedTimingPatterns(t)}static embedTypeInfo(e,t,n){const r=new K;le.makeTypeInfoBits(e,t,r);for(let i=0,s=r.getSize();i<s;++i){const o=r.get(r.getSize()-1-i),a=le.TYPE_INFO_COORDINATES[i],l=a[0],u=a[1];if(n.setBoolean(l,u,o),i<8){const x=n.getWidth()-i-1;n.setBoolean(x,8,o)}else{const E=n.getHeight()-7+(i-8);n.setBoolean(8,E,o)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const n=new K;le.makeVersionInfoBits(e,n);let r=6*3-1;for(let i=0;i<6;++i)for(let s=0;s<3;++s){const o=n.get(r);r--,t.setBoolean(i,t.getHeight()-11+s,o),t.setBoolean(t.getHeight()-11+s,i,o)}}static embedDataBits(e,t,n){let r=0,i=-1,s=n.getWidth()-1,o=n.getHeight()-1;for(;s>0;){for(s===6&&(s-=1);o>=0&&o<n.getHeight();){for(let a=0;a<2;++a){const l=s-a;if(!le.isEmpty(n.get(l,o)))continue;let u;r<e.getSize()?(u=e.get(r),++r):u=!1,t!==255&&ke.getDataMaskBit(t,l,o)&&(u=!u),n.setBoolean(l,o,u)}o+=i}i=-i,o+=i,s-=2}if(r!==e.getSize())throw new Ne("Not all bits consumed: "+r+"/"+e.getSize())}static findMSBSet(e){return 32-G.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(t===0)throw new R("0 polynomial");const n=le.findMSBSet(t);for(e<<=n-1;le.findMSBSet(e)>=n;)e^=t<<le.findMSBSet(e)-n;return e}static makeTypeInfoBits(e,t,n){if(!qt.isValidMaskPattern(t))throw new Ne("Invalid mask pattern");const r=e.getBits()<<3|t;n.appendBits(r,5);const i=le.calculateBCHCode(r,le.TYPE_INFO_POLY);n.appendBits(i,10);const s=new K;if(s.appendBits(le.TYPE_INFO_MASK_PATTERN,15),n.xor(s),n.getSize()!==15)throw new Ne("should not happen but we got: "+n.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const n=le.calculateBCHCode(e.getVersionNumber(),le.VERSION_INFO_POLY);if(t.appendBits(n,12),t.getSize()!==18)throw new Ne("should not happen but we got: "+t.getSize())}static isEmpty(e){return e===255}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const n=(t+1)%2;le.isEmpty(e.get(t,6))&&e.setNumber(t,6,n),le.isEmpty(e.get(6,t))&&e.setNumber(6,t,n)}}static embedDarkDotAtLeftBottomCorner(e){if(e.get(8,e.getHeight()-8)===0)throw new Ne;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,n){for(let r=0;r<8;++r){if(!le.isEmpty(n.get(e+r,t)))throw new Ne;n.setNumber(e+r,t,0)}}static embedVerticalSeparationPattern(e,t,n){for(let r=0;r<7;++r){if(!le.isEmpty(n.get(e,t+r)))throw new Ne;n.setNumber(e,t+r,0)}}static embedPositionAdjustmentPattern(e,t,n){for(let r=0;r<5;++r){const i=le.POSITION_ADJUSTMENT_PATTERN[r];for(let s=0;s<5;++s)n.setNumber(e+s,t+r,i[s])}}static embedPositionDetectionPattern(e,t,n){for(let r=0;r<7;++r){const i=le.POSITION_DETECTION_PATTERN[r];for(let s=0;s<7;++s)n.setNumber(e+s,t+r,i[s])}}static embedPositionDetectionPatternsAndSeparators(e){const t=le.POSITION_DETECTION_PATTERN[0].length;le.embedPositionDetectionPattern(0,0,e),le.embedPositionDetectionPattern(e.getWidth()-t,0,e),le.embedPositionDetectionPattern(0,e.getWidth()-t,e);const n=8;le.embedHorizontalSeparationPattern(0,n-1,e),le.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),le.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);const r=7;le.embedVerticalSeparationPattern(r,0,e),le.embedVerticalSeparationPattern(e.getHeight()-r-1,0,e),le.embedVerticalSeparationPattern(r,e.getHeight()-r,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const n=e.getVersionNumber()-1,r=le.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n];for(let i=0,s=r.length;i!==s;i++){const o=r[i];if(o>=0)for(let a=0;a!==s;a++){const l=r[a];l>=0&&le.isEmpty(t.get(l,o))&&le.embedPositionAdjustmentPattern(l-2,o-2,t)}}}}le.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),le.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),le.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),le.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),le.VERSION_INFO_POLY=7973,le.TYPE_INFO_POLY=1335,le.TYPE_INFO_MASK_PATTERN=21522;class ds{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class De{constructor(){}static calculateMaskPenalty(e){return ke.applyMaskPenaltyRule1(e)+ke.applyMaskPenaltyRule2(e)+ke.applyMaskPenaltyRule3(e)+ke.applyMaskPenaltyRule4(e)}static encode(e,t,n=null){let r=De.DEFAULT_BYTE_MODE_ENCODING;const i=n!==null&&n.get(Xe.CHARACTER_SET)!==void 0;i&&(r=n.get(Xe.CHARACTER_SET).toString());const s=this.chooseMode(e,r),o=new K;if(s===se.BYTE&&(i||De.DEFAULT_BYTE_MODE_ENCODING!==r)){const H=M.getCharacterSetECIByName(r);H!==void 0&&this.appendECI(H,o)}this.appendModeInfo(s,o);const a=new K;this.appendBytes(e,s,a,r);let l;if(n!==null&&n.get(Xe.QR_VERSION)!==void 0){const H=Number.parseInt(n.get(Xe.QR_VERSION).toString(),10);l=ne.getVersionForNumber(H);const F=this.calculateBitsNeeded(s,o,a,l);if(!this.willFit(F,l,t))throw new Ne("Data too big for requested version")}else l=this.recommendVersion(t,s,o,a);const u=new K;u.appendBitArray(o);const x=s===se.BYTE?a.getSizeInBytes():e.length;this.appendLengthInfo(x,l,s,u),u.appendBitArray(a);const E=l.getECBlocksForLevel(t),I=l.getTotalCodewords()-E.getTotalECCodewords();this.terminateBits(I,u);const b=this.interleaveWithECBytes(u,l.getTotalCodewords(),I,E.getNumBlocks()),T=new qt;T.setECLevel(t),T.setMode(s),T.setVersion(l);const N=l.getDimensionForVersion(),B=new vn(N,N),V=this.chooseMaskPattern(b,t,l,B);return T.setMaskPattern(V),le.buildMatrix(b,t,l,V,B),T.setMatrix(B),T}static recommendVersion(e,t,n,r){const i=this.calculateBitsNeeded(t,n,r,ne.getVersionForNumber(1)),s=this.chooseVersion(i,e),o=this.calculateBitsNeeded(t,n,r,s);return this.chooseVersion(o,e)}static calculateBitsNeeded(e,t,n,r){return t.getSize()+e.getCharacterCountBits(r)+n.getSize()}static getAlphanumericCode(e){return e<De.ALPHANUMERIC_TABLE.length?De.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(M.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return se.KANJI;let n=!1,r=!1;for(let i=0,s=e.length;i<s;++i){const o=e.charAt(i);if(De.isDigit(o))n=!0;else if(this.getAlphanumericCode(o.charCodeAt(0))!==-1)r=!0;else return se.BYTE}return r?se.ALPHANUMERIC:n?se.NUMERIC:se.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=J.encode(e,M.SJIS)}catch{return!1}const n=t.length;if(n%2!==0)return!1;for(let r=0;r<n;r+=2){const i=t[r]&255;if((i<129||i>159)&&(i<224||i>235))return!1}return!0}static chooseMaskPattern(e,t,n,r){let i=Number.MAX_SAFE_INTEGER,s=-1;for(let o=0;o<qt.NUM_MASK_PATTERNS;o++){le.buildMatrix(e,t,n,o,r);let a=this.calculateMaskPenalty(r);a<i&&(i=a,s=o)}return s}static chooseVersion(e,t){for(let n=1;n<=40;n++){const r=ne.getVersionForNumber(n);if(De.willFit(e,r,t))return r}throw new Ne("Data too big")}static willFit(e,t,n){const r=t.getTotalCodewords(),s=t.getECBlocksForLevel(n).getTotalECCodewords(),o=r-s,a=(e+7)/8;return o>=a}static terminateBits(e,t){const n=e*8;if(t.getSize()>n)throw new Ne("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(let s=0;s<4&&t.getSize()<n;++s)t.appendBit(!1);const r=t.getSize()&7;if(r>0)for(let s=r;s<8;s++)t.appendBit(!1);const i=e-t.getSizeInBytes();for(let s=0;s<i;++s)t.appendBits((s&1)===0?236:17,8);if(t.getSize()!==n)throw new Ne("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,n,r,i,s){if(r>=n)throw new Ne("Block ID too large");const o=e%n,a=n-o,l=Math.floor(e/n),u=l+1,x=Math.floor(t/n),E=x+1,I=l-x,b=u-E;if(I!==b)throw new Ne("EC bytes mismatch");if(n!==a+o)throw new Ne("RS blocks mismatch");if(e!==(x+I)*a+(E+b)*o)throw new Ne("Total bytes mismatch");r<a?(i[0]=x,s[0]=I):(i[0]=E,s[0]=b)}static interleaveWithECBytes(e,t,n,r){if(e.getSizeInBytes()!==n)throw new Ne("Number of bits and data bytes does not match");let i=0,s=0,o=0;const a=new Array;for(let u=0;u<r;++u){const x=new Int32Array(1),E=new Int32Array(1);De.getNumDataBytesAndNumECBytesForBlockID(t,n,r,u,x,E);const I=x[0],b=new Uint8Array(I);e.toBytes(8*i,b,0,I);const T=De.generateECBytes(b,E[0]);a.push(new ds(b,T)),s=Math.max(s,I),o=Math.max(o,T.length),i+=x[0]}if(n!==i)throw new Ne("Data bytes does not match offset");const l=new K;for(let u=0;u<s;++u)for(const x of a){const E=x.getDataBytes();u<E.length&&l.appendBits(E[u],8)}for(let u=0;u<o;++u)for(const x of a){const E=x.getErrorCorrectionBytes();u<E.length&&l.appendBits(E[u],8)}if(t!==l.getSizeInBytes())throw new Ne("Interleaving error: "+t+" and "+l.getSizeInBytes()+" differ.");return l}static generateECBytes(e,t){const n=e.length,r=new Int32Array(n+t);for(let s=0;s<n;s++)r[s]=e[s]&255;new nr(Ee.QR_CODE_FIELD_256).encode(r,t);const i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=r[n+s];return i}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,n,r){const i=n.getCharacterCountBits(t);if(e>=1<<i)throw new Ne(e+" is bigger than "+((1<<i)-1));r.appendBits(e,i)}static appendBytes(e,t,n,r){switch(t){case se.NUMERIC:De.appendNumericBytes(e,n);break;case se.ALPHANUMERIC:De.appendAlphanumericBytes(e,n);break;case se.BYTE:De.append8BitBytes(e,n,r);break;case se.KANJI:De.appendKanjiBytes(e,n);break;default:throw new Ne("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=De.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=De.getDigit(e.charAt(r));if(r+2<n){const s=De.getDigit(e.charAt(r+1)),o=De.getDigit(e.charAt(r+2));t.appendBits(i*100+s*10+o,10),r+=3}else if(r+1<n){const s=De.getDigit(e.charAt(r+1));t.appendBits(i*10+s,7),r+=2}else t.appendBits(i,4),r++}}static appendAlphanumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=De.getAlphanumericCode(e.charCodeAt(r));if(i===-1)throw new Ne;if(r+1<n){const s=De.getAlphanumericCode(e.charCodeAt(r+1));if(s===-1)throw new Ne;t.appendBits(i*45+s,11),r+=2}else t.appendBits(i,6),r++}}static append8BitBytes(e,t,n){let r;try{r=J.encode(e,n)}catch(i){throw new Ne(i)}for(let i=0,s=r.length;i!==s;i++){const o=r[i];t.appendBits(o,8)}}static appendKanjiBytes(e,t){let n;try{n=J.encode(e,M.SJIS)}catch(i){throw new Ne(i)}const r=n.length;for(let i=0;i<r;i+=2){const s=n[i]&255,o=n[i+1]&255,a=s<<8&4294967295|o;let l=-1;if(a>=33088&&a<=40956?l=a-33088:a>=57408&&a<=60351&&(l=a-49472),l===-1)throw new Ne("Invalid byte sequence");const u=(l>>8)*192+(l&255);t.appendBits(u,13)}}static appendECI(e,t){t.appendBits(se.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}De.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),De.DEFAULT_BYTE_MODE_ENCODING=M.UTF8.getName();class jt{write(e,t,n,r=null){if(e.length===0)throw new R("Found empty contents");if(t<0||n<0)throw new R("Requested dimensions are too small: "+t+"x"+n);let i=Oe.L,s=jt.QUIET_ZONE_SIZE;r!==null&&(r.get(Xe.ERROR_CORRECTION)!==void 0&&(i=Oe.fromString(r.get(Xe.ERROR_CORRECTION).toString())),r.get(Xe.MARGIN)!==void 0&&(s=Number.parseInt(r.get(Xe.MARGIN).toString(),10)));const o=De.encode(e,i,r);return this.renderResult(o,t,n,s)}writeToDom(e,t,n,r,i=null){typeof e=="string"&&(e=document.querySelector(e));const s=this.write(t,n,r,i);e&&e.appendChild(s)}renderResult(e,t,n,r){const i=e.getMatrix();if(i===null)throw new bt;const s=i.getWidth(),o=i.getHeight(),a=s+r*2,l=o+r*2,u=Math.max(t,a),x=Math.max(n,l),E=Math.min(Math.floor(u/a),Math.floor(x/l)),I=Math.floor((u-s*E)/2),b=Math.floor((x-o*E)/2),T=this.createSVGElement(u,x);for(let N=0,B=b;N<o;N++,B+=E)for(let V=0,H=I;V<s;V++,H+=E)if(i.get(V,N)===1){const F=this.createSvgRectElement(H,B,E,E);T.appendChild(F)}return T}createSVGElement(e,t){const n=document.createElementNS(jt.SVG_NS,"svg");return n.setAttributeNS(null,"height",e.toString()),n.setAttributeNS(null,"width",t.toString()),n}createSvgRectElement(e,t,n,r){const i=document.createElementNS(jt.SVG_NS,"rect");return i.setAttributeNS(null,"x",e.toString()),i.setAttributeNS(null,"y",t.toString()),i.setAttributeNS(null,"height",n.toString()),i.setAttributeNS(null,"width",r.toString()),i.setAttributeNS(null,"fill","#000000"),i}}jt.QUIET_ZONE_SIZE=4,jt.SVG_NS="http://www.w3.org/2000/svg";class on{encode(e,t,n,r,i){if(e.length===0)throw new R("Found empty contents");if(t!==ie.QR_CODE)throw new R("Can only encode QR_CODE, but got "+t);if(n<0||r<0)throw new R(`Requested dimensions are too small: ${n}x${r}`);let s=Oe.L,o=on.QUIET_ZONE_SIZE;i!==null&&(i.get(Xe.ERROR_CORRECTION)!==void 0&&(s=Oe.fromString(i.get(Xe.ERROR_CORRECTION).toString())),i.get(Xe.MARGIN)!==void 0&&(o=Number.parseInt(i.get(Xe.MARGIN).toString(),10)));const a=De.encode(e,s,i);return on.renderResult(a,n,r,o)}static renderResult(e,t,n,r){const i=e.getMatrix();if(i===null)throw new bt;const s=i.getWidth(),o=i.getHeight(),a=s+r*2,l=o+r*2,u=Math.max(t,a),x=Math.max(n,l),E=Math.min(Math.floor(u/a),Math.floor(x/l)),I=Math.floor((u-s*E)/2),b=Math.floor((x-o*E)/2),T=new te(u,x);for(let N=0,B=b;N<o;N++,B+=E)for(let V=0,H=I;V<s;V++,H+=E)i.get(V,N)===1&&T.setRegion(H,B,E,E);return T}}on.QUIET_ZONE_SIZE=4;class gs{encode(e,t,n,r,i){let s;switch(t){case ie.QR_CODE:s=new on;break;default:throw new R("No encoder available for format "+t)}return s.encode(e,t,n,r,i)}}class Nt extends vt{constructor(e,t,n,r,i,s,o,a){if(super(s,o),this.yuvData=e,this.dataWidth=t,this.dataHeight=n,this.left=r,this.top=i,r+s>t||i+o>n)throw new R("Crop rectangle does not fit within image data.");a&&this.reverseHorizontal(s,o)}getRow(e,t){if(e<0||e>=this.getHeight())throw new R("Requested row is outside the image: "+e);const n=this.getWidth();(t==null||t.length<n)&&(t=new Uint8ClampedArray(n));const r=(e+this.top)*this.dataWidth+this.left;return q.arraycopy(this.yuvData,r,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const n=e*t,r=new Uint8ClampedArray(n);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return q.arraycopy(this.yuvData,i,r,0,n),r;for(let s=0;s<t;s++){const o=s*e;q.arraycopy(this.yuvData,i,r,o,e),i+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,n,r){return new Nt(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,n,r,!1)}renderThumbnail(){const e=this.getWidth()/Nt.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/Nt.THUMBNAIL_SCALE_FACTOR,n=new Int32Array(e*t),r=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let s=0;s<t;s++){const o=s*e;for(let a=0;a<e;a++){const l=r[i+a*Nt.THUMBNAIL_SCALE_FACTOR]&255;n[o+a]=4278190080|l*65793}i+=this.dataWidth*Nt.THUMBNAIL_SCALE_FACTOR}return n}getThumbnailWidth(){return this.getWidth()/Nt.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Nt.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const n=this.yuvData;for(let r=0,i=this.top*this.dataWidth+this.left;r<t;r++,i+=this.dataWidth){const s=i+e/2;for(let o=i,a=i+e-1;o<s;o++,a--){const l=n[o];n[o]=n[a],n[a]=l}}}invert(){return new pt(this)}}Nt.THUMBNAIL_SCALE_FACTOR=2;class rr extends vt{constructor(e,t,n,r,i,s,o){if(super(t,n),this.dataWidth=r,this.dataHeight=i,this.left=s,this.top=o,e.BYTES_PER_ELEMENT===4){const a=t*n,l=new Uint8ClampedArray(a);for(let u=0;u<a;u++){const x=e[u],E=x>>16&255,I=x>>7&510,b=x&255;l[u]=(E+I+b)/4&255}this.luminances=l}else this.luminances=e;if(r===void 0&&(this.dataWidth=t),i===void 0&&(this.dataHeight=n),s===void 0&&(this.left=0),o===void 0&&(this.top=0),this.left+t>this.dataWidth||this.top+n>this.dataHeight)throw new R("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new R("Requested row is outside the image: "+e);const n=this.getWidth();(t==null||t.length<n)&&(t=new Uint8ClampedArray(n));const r=(e+this.top)*this.dataWidth+this.left;return q.arraycopy(this.luminances,r,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const n=e*t,r=new Uint8ClampedArray(n);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return q.arraycopy(this.luminances,i,r,0,n),r;for(let s=0;s<t;s++){const o=s*e;q.arraycopy(this.luminances,i,r,o,e),i+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,n,r){return new rr(this.luminances,n,r,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new pt(this)}}class qr extends M{static forName(e){return this.getCharacterSetECIByName(e)}}class ir{}ir.ISO_8859_1=M.ISO8859_1;class jr{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class Qr{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class xs{constructor(e){this.previous=e}getPrevious(){return this.previous}}class an extends xs{constructor(e,t,n){super(e),this.value=t,this.bitCount=n}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new an(this,e,t)}addBinaryShift(e,t){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new an(this,e,t)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+G.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class sr extends an{constructor(e,t,n){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=n}appendTo(e,t){for(let n=0;n<this.binaryShiftByteCount;n++)(n===0||n===31&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):n===0?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+n],8)}addBinaryShift(e,t){return new sr(this,e,t)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function ws(g,e,t){return new sr(g,e,t)}function mn(g,e,t){return new an(g,e,t)}const As=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Gt=0,Pn=1,At=2,Jr=3,_t=4,Es=new an(null,0,0),or=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Cs(g){for(let e of g)$.fill(e,-1);return g[Gt][_t]=0,g[Pn][_t]=0,g[Pn][Gt]=28,g[Jr][_t]=0,g[At][_t]=0,g[At][Gt]=15,g}const $r=Cs($.createInt32Array(6,6));class Rt{constructor(e,t,n,r){this.token=e,this.mode=t,this.binaryShiftByteCount=n,this.bitCount=r}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let n=this.bitCount,r=this.token;if(e!==this.mode){let s=or[this.mode][e];r=mn(r,s&65535,s>>16),n+=s>>16}let i=e===At?4:5;return r=mn(r,t,i),new Rt(r,e,0,n+i)}shiftAndAppend(e,t){let n=this.token,r=this.mode===At?4:5;return n=mn(n,$r[this.mode][e],r),n=mn(n,t,5),new Rt(n,this.mode,0,this.bitCount+r+5)}addBinaryShiftChar(e){let t=this.token,n=this.mode,r=this.bitCount;if(this.mode===_t||this.mode===At){let o=or[n][Gt];t=mn(t,o&65535,o>>16),r+=o>>16,n=Gt}let i=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,s=new Rt(t,n,this.binaryShiftByteCount+1,r+i);return s.binaryShiftByteCount===2078&&(s=s.endBinaryShift(e+1)),s}endBinaryShift(e){if(this.binaryShiftByteCount===0)return this;let t=this.token;return t=ws(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new Rt(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(or[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=Rt.calculateBinaryShiftCost(e)-Rt.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let r=this.endBinaryShift(e.length).token;r!==null;r=r.getPrevious())t.unshift(r);let n=new K;for(const r of t)r.appendTo(n,e);return n}toString(){return U.format("%s bits=%d bytes=%d",As[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}Rt.INITIAL_STATE=new Rt(Es,Gt,0,0);function ms(g){const e=U.getCharCode(" "),t=U.getCharCode("."),n=U.getCharCode(",");g[Gt][e]=1;const r=U.getCharCode("Z"),i=U.getCharCode("A");for(let E=i;E<=r;E++)g[Gt][E]=E-i+2;g[Pn][e]=1;const s=U.getCharCode("z"),o=U.getCharCode("a");for(let E=o;E<=s;E++)g[Pn][E]=E-o+2;g[At][e]=1;const a=U.getCharCode("9"),l=U.getCharCode("0");for(let E=l;E<=a;E++)g[At][E]=E-l+2;g[At][n]=12,g[At][t]=13;const u=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let E=0;E<u.length;E++)g[Jr][U.getCharCode(u[E])]=E;const x=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let E=0;E<x.length;E++)U.getCharCode(x[E])>0&&(g[_t][U.getCharCode(x[E])]=E);return g}const ar=ms($.createInt32Array(5,256));class In{constructor(e){this.text=e}encode(){const e=U.getCharCode(" "),t=U.getCharCode(`
`);let n=Qr.singletonList(Rt.INITIAL_STATE);for(let i=0;i<this.text.length;i++){let s,o=i+1<this.text.length?this.text[i+1]:0;switch(this.text[i]){case U.getCharCode("\r"):s=o===t?2:0;break;case U.getCharCode("."):s=o===e?3:0;break;case U.getCharCode(","):s=o===e?4:0;break;case U.getCharCode(":"):s=o===e?5:0;break;default:s=0}s>0?(n=In.updateStateListForPair(n,i,s),i++):n=this.updateStateListForChar(n,i)}return Qr.min(n,(i,s)=>i.getBitCount()-s.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,t){const n=[];for(let r of e)this.updateStateForChar(r,t,n);return In.simplifyStates(n)}updateStateForChar(e,t,n){let r=this.text[t]&255,i=ar[e.getMode()][r]>0,s=null;for(let o=0;o<=_t;o++){let a=ar[o][r];if(a>0){if(s==null&&(s=e.endBinaryShift(t)),!i||o===e.getMode()||o===At){const l=s.latchAndAppend(o,a);n.push(l)}if(!i&&$r[e.getMode()][o]>=0){const l=s.shiftAndAppend(o,a);n.push(l)}}}if(e.getBinaryShiftByteCount()>0||ar[e.getMode()][r]===0){let o=e.addBinaryShiftChar(t);n.push(o)}}static updateStateListForPair(e,t,n){const r=[];for(let i of e)this.updateStateForPair(i,t,n,r);return this.simplifyStates(r)}static updateStateForPair(e,t,n,r){let i=e.endBinaryShift(t);if(r.push(i.latchAndAppend(_t,n)),e.getMode()!==_t&&r.push(i.shiftAndAppend(_t,n)),n===3||n===4){let s=i.latchAndAppend(At,16-n).latchAndAppend(At,1);r.push(s)}if(e.getBinaryShiftByteCount()>0){let s=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);r.push(s)}}static simplifyStates(e){let t=[];for(const n of e){let r=!0;for(const i of t){if(i.isBetterThanOrEqualTo(n)){r=!1;break}n.isBetterThanOrEqualTo(i)&&(t=t.filter(s=>s!==i))}r&&t.push(n)}return t}}class Ae{constructor(){}static encodeBytes(e){return Ae.encode(e,Ae.DEFAULT_EC_PERCENT,Ae.DEFAULT_AZTEC_LAYERS)}static encode(e,t,n){let r=new In(e).encode(),i=G.truncDivision(r.getSize()*t,100)+11,s=r.getSize()+i,o,a,l,u,x;if(n!==Ae.DEFAULT_AZTEC_LAYERS){if(o=n<0,a=Math.abs(n),a>(o?Ae.MAX_NB_BITS_COMPACT:Ae.MAX_NB_BITS))throw new R(U.format("Illegal value %s for layers",n));l=Ae.totalBitsInLayer(a,o),u=Ae.WORD_SIZE[a];let F=l-l%u;if(x=Ae.stuffBits(r,u),x.getSize()+i>F)throw new R("Data to large for user specified layer");if(o&&x.getSize()>u*64)throw new R("Data to large for user specified layer")}else{u=0,x=null;for(let F=0;;F++){if(F>Ae.MAX_NB_BITS)throw new R("Data too large for an Aztec code");if(o=F<=3,a=o?F+1:F,l=Ae.totalBitsInLayer(a,o),s>l)continue;(x==null||u!==Ae.WORD_SIZE[a])&&(u=Ae.WORD_SIZE[a],x=Ae.stuffBits(r,u));let ge=l-l%u;if(!(o&&x.getSize()>u*64)&&x.getSize()+i<=ge)break}}let E=Ae.generateCheckWords(x,l,u),I=x.getSize()/u,b=Ae.generateModeMessage(o,a,I),T=(o?11:14)+a*4,N=new Int32Array(T),B;if(o){B=T;for(let F=0;F<N.length;F++)N[F]=F}else{B=T+1+2*G.truncDivision(G.truncDivision(T,2)-1,15);let F=G.truncDivision(T,2),ge=G.truncDivision(B,2);for(let fe=0;fe<F;fe++){let at=fe+G.truncDivision(fe,15);N[F-fe-1]=ge-at-1,N[F+fe]=ge+at+1}}let V=new te(B);for(let F=0,ge=0;F<a;F++){let fe=(a-F)*4+(o?9:12);for(let at=0;at<fe;at++){let It=at*2;for(let lt=0;lt<2;lt++)E.get(ge+It+lt)&&V.set(N[F*2+lt],N[F*2+at]),E.get(ge+fe*2+It+lt)&&V.set(N[F*2+at],N[T-1-F*2-lt]),E.get(ge+fe*4+It+lt)&&V.set(N[T-1-F*2-lt],N[T-1-F*2-at]),E.get(ge+fe*6+It+lt)&&V.set(N[T-1-F*2-at],N[F*2+lt])}ge+=fe*8}if(Ae.drawModeMessage(V,o,B,b),o)Ae.drawBullsEye(V,G.truncDivision(B,2),5);else{Ae.drawBullsEye(V,G.truncDivision(B,2),7);for(let F=0,ge=0;F<G.truncDivision(T,2)-1;F+=15,ge+=16)for(let fe=G.truncDivision(B,2)&1;fe<B;fe+=2)V.set(G.truncDivision(B,2)-ge,fe),V.set(G.truncDivision(B,2)+ge,fe),V.set(fe,G.truncDivision(B,2)-ge),V.set(fe,G.truncDivision(B,2)+ge)}let H=new jr;return H.setCompact(o),H.setSize(B),H.setLayers(a),H.setCodeWords(I),H.setMatrix(V),H}static drawBullsEye(e,t,n){for(let r=0;r<n;r+=2)for(let i=t-r;i<=t+r;i++)e.set(i,t-r),e.set(i,t+r),e.set(t-r,i),e.set(t+r,i);e.set(t-n,t-n),e.set(t-n+1,t-n),e.set(t-n,t-n+1),e.set(t+n,t-n),e.set(t+n,t-n+1),e.set(t+n,t+n-1)}static generateModeMessage(e,t,n){let r=new K;return e?(r.appendBits(t-1,2),r.appendBits(n-1,6),r=Ae.generateCheckWords(r,28,4)):(r.appendBits(t-1,5),r.appendBits(n-1,11),r=Ae.generateCheckWords(r,40,4)),r}static drawModeMessage(e,t,n,r){let i=G.truncDivision(n,2);if(t)for(let s=0;s<7;s++){let o=i-3+s;r.get(s)&&e.set(o,i-5),r.get(s+7)&&e.set(i+5,o),r.get(20-s)&&e.set(o,i+5),r.get(27-s)&&e.set(i-5,o)}else for(let s=0;s<10;s++){let o=i-5+s+G.truncDivision(s,5);r.get(s)&&e.set(o,i-7),r.get(s+10)&&e.set(i+7,o),r.get(29-s)&&e.set(o,i+7),r.get(39-s)&&e.set(i-7,o)}}static generateCheckWords(e,t,n){let r=e.getSize()/n,i=new nr(Ae.getGF(n)),s=G.truncDivision(t,n),o=Ae.bitsToWords(e,n,s);i.encode(o,s-r);let a=t%n,l=new K;l.appendBits(0,a);for(const u of Array.from(o))l.appendBits(u,n);return l}static bitsToWords(e,t,n){let r=new Int32Array(n),i,s;for(i=0,s=e.getSize()/t;i<s;i++){let o=0;for(let a=0;a<t;a++)o|=e.get(i*t+a)?1<<t-a-1:0;r[i]=o}return r}static getGF(e){switch(e){case 4:return Ee.AZTEC_PARAM;case 6:return Ee.AZTEC_DATA_6;case 8:return Ee.AZTEC_DATA_8;case 10:return Ee.AZTEC_DATA_10;case 12:return Ee.AZTEC_DATA_12;default:throw new R("Unsupported word size "+e)}}static stuffBits(e,t){let n=new K,r=e.getSize(),i=(1<<t)-2;for(let s=0;s<r;s+=t){let o=0;for(let a=0;a<t;a++)(s+a>=r||e.get(s+a))&&(o|=1<<t-1-a);(o&i)===i?(n.appendBits(o&i,t),s--):(o&i)===0?(n.appendBits(o|1,t),s--):n.appendBits(o,t)}return n}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Ae.DEFAULT_EC_PERCENT=33,Ae.DEFAULT_AZTEC_LAYERS=0,Ae.MAX_NB_BITS=32,Ae.MAX_NB_BITS_COMPACT=4,Ae.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Ln{encode(e,t,n,r){return this.encodeWithHints(e,t,n,r,null)}encodeWithHints(e,t,n,r,i){let s=ir.ISO_8859_1,o=Ae.DEFAULT_EC_PERCENT,a=Ae.DEFAULT_AZTEC_LAYERS;return i!=null&&(i.has(Xe.CHARACTER_SET)&&(s=qr.forName(i.get(Xe.CHARACTER_SET).toString())),i.has(Xe.ERROR_CORRECTION)&&(o=G.parseInt(i.get(Xe.ERROR_CORRECTION).toString())),i.has(Xe.AZTEC_LAYERS)&&(a=G.parseInt(i.get(Xe.AZTEC_LAYERS).toString()))),Ln.encodeLayers(e,t,n,r,s,o,a)}static encodeLayers(e,t,n,r,i,s,o){if(t!==ie.AZTEC)throw new R("Can only encode AZTEC, but got "+t);let a=Ae.encode(U.getBytes(e,i),s,o);return Ln.renderResult(a,n,r)}static renderResult(e,t,n){let r=e.getMatrix();if(r==null)throw new bt;let i=r.getWidth(),s=r.getHeight(),o=Math.max(t,i),a=Math.max(n,s),l=Math.min(o/i,a/s),u=(o-i*l)/2,x=(a-s*l)/2,E=new te(o,a);for(let I=0,b=x;I<s;I++,b+=l)for(let T=0,N=u;T<i;T++,N+=l)r.get(T,I)&&E.setRegion(N,b,l,l);return E}}c.AbstractExpandedDecoder=zn,c.ArgumentException=O,c.ArithmeticException=yn,c.AztecCode=jr,c.AztecCodeReader=Nn,c.AztecCodeWriter=Ln,c.AztecDecoder=Re,c.AztecDetector=Lr,c.AztecDetectorResult=vr,c.AztecEncoder=Ae,c.AztecHighLevelEncoder=In,c.AztecPoint=tt,c.BarcodeFormat=ie,c.Binarizer=re,c.BinaryBitmap=Y,c.BitArray=K,c.BitMatrix=te,c.BitSource=jn,c.BrowserAztecCodeReader=zi,c.BrowserBarcodeReader=Qi,c.BrowserCodeReader=Et,c.BrowserDatamatrixCodeReader=$i,c.BrowserMultiFormatReader=us,c.BrowserPDF417Reader=fs,c.BrowserQRCodeReader=hs,c.BrowserQRCodeSvgWriter=jt,c.CharacterSetECI=M,c.ChecksumException=k,c.Code128Reader=X,c.Code39Reader=He,c.DataMatrixDecodedBitStreamParser=Ft,c.DataMatrixReader=kt,c.DecodeHintType=W,c.DecoderResult=dt,c.DefaultGridSampler=Pr,c.DetectorResult=Sn,c.EAN13Reader=Yt,c.EncodeHintType=Xe,c.Exception=C,c.FormatException=P,c.GenericGF=Ee,c.GenericGFPoly=rt,c.GlobalHistogramBinarizer=Be,c.GridSampler=Hn,c.GridSamplerInstance=Pt,c.HTMLCanvasElementLuminanceSource=ht,c.HybridBinarizer=ue,c.ITFReader=Se,c.IllegalArgumentException=R,c.IllegalStateException=bt,c.InvertedLuminanceSource=pt,c.LuminanceSource=vt,c.MathUtils=we,c.MultiFormatOneDReader=rn,c.MultiFormatReader=Kr,c.MultiFormatWriter=gs,c.NotFoundException=v,c.OneDReader=Ge,c.PDF417DecodedBitStreamParser=D,c.PDF417DecoderErrorCorrection=Hr,c.PDF417Reader=Qe,c.PDF417ResultMetadata=Xr,c.PerspectiveTransform=Ct,c.PlanarYUVLuminanceSource=Nt,c.QRCodeByteMatrix=vn,c.QRCodeDataMask=xt,c.QRCodeDecodedBitStreamParser=Pe,c.QRCodeDecoderErrorCorrectionLevel=Oe,c.QRCodeDecoderFormatInformation=et,c.QRCodeEncoder=De,c.QRCodeEncoderQRCode=qt,c.QRCodeMaskUtil=ke,c.QRCodeMatrixUtil=le,c.QRCodeMode=se,c.QRCodeReader=Ut,c.QRCodeVersion=ne,c.QRCodeWriter=on,c.RGBLuminanceSource=rr,c.RSS14Reader=Fe,c.RSSExpandedReader=L,c.ReaderException=Bn,c.ReedSolomonDecoder=hn,c.ReedSolomonEncoder=nr,c.ReedSolomonException=$t,c.Result=Ke,c.ResultMetadataType=be,c.ResultPoint=ee,c.StringUtils=U,c.UnsupportedOperationException=ae,c.VideoInputDevice=Wt,c.WhiteRectangleDetector=Mt,c.WriterException=Ne,c.ZXingArrays=$,c.ZXingCharset=qr,c.ZXingInteger=G,c.ZXingStandardCharsets=ir,c.ZXingStringBuilder=Z,c.ZXingStringEncoding=J,c.ZXingSystem=q,c.createAbstractExpandedDecoder=Vr,Object.defineProperty(c,"__esModule",{value:!0})})}(bn,bn.exports)),bn.exports}var Me=js();const Qs=bs(Me),Js=ys({__proto__:null,default:Qs},[Me]);var Mi=function(){function d(f,c,w){if(this.formatMap=new Map([[Q.QR_CODE,Me.BarcodeFormat.QR_CODE],[Q.AZTEC,Me.BarcodeFormat.AZTEC],[Q.CODABAR,Me.BarcodeFormat.CODABAR],[Q.CODE_39,Me.BarcodeFormat.CODE_39],[Q.CODE_93,Me.BarcodeFormat.CODE_93],[Q.CODE_128,Me.BarcodeFormat.CODE_128],[Q.DATA_MATRIX,Me.BarcodeFormat.DATA_MATRIX],[Q.MAXICODE,Me.BarcodeFormat.MAXICODE],[Q.ITF,Me.BarcodeFormat.ITF],[Q.EAN_13,Me.BarcodeFormat.EAN_13],[Q.EAN_8,Me.BarcodeFormat.EAN_8],[Q.PDF_417,Me.BarcodeFormat.PDF_417],[Q.RSS_14,Me.BarcodeFormat.RSS_14],[Q.RSS_EXPANDED,Me.BarcodeFormat.RSS_EXPANDED],[Q.UPC_A,Me.BarcodeFormat.UPC_A],[Q.UPC_E,Me.BarcodeFormat.UPC_E],[Q.UPC_EAN_EXTENSION,Me.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Js)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=c,this.logger=w;var A=this.createZXingFormats(f),h=new Map;h.set(Me.DecodeHintType.POSSIBLE_FORMATS,A),h.set(Me.DecodeHintType.TRY_HARDER,!1),this.hints=h}return d.prototype.decodeAsync=function(f){var c=this;return new Promise(function(w,A){try{w(c.decode(f))}catch(h){A(h)}})},d.prototype.decode=function(f){var c=new Me.MultiFormatReader(this.verbose,this.hints),w=new Me.HTMLCanvasElementLuminanceSource(f),A=new Me.BinaryBitmap(new Me.HybridBinarizer(w)),h=c.decode(A);return{text:h.text,format:Wi.create(this.toHtml5QrcodeSupportedFormats(h.format)),debugData:this.createDebugData()}},d.prototype.createReverseFormatMap=function(){var f=new Map;return this.formatMap.forEach(function(c,w,A){f.set(c,w)}),f},d.prototype.toHtml5QrcodeSupportedFormats=function(f){if(!this.reverseFormatMap.has(f))throw"reverseFormatMap doesn't have ".concat(f);return this.reverseFormatMap.get(f)},d.prototype.createZXingFormats=function(f){for(var c=[],w=0,A=f;w<A.length;w++){var h=A[w];this.formatMap.has(h)?c.push(this.formatMap.get(h)):this.logger.logError("".concat(h," is not supported by")+"ZXingHtml5QrcodeShim")}return c},d.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},d}(),$s=function(d,f,c,w){function A(h){return h instanceof c?h:new c(function(p){p(h)})}return new(c||(c=Promise))(function(h,p){function S(O){try{C(w.next(O))}catch(R){p(R)}}function y(O){try{C(w.throw(O))}catch(R){p(R)}}function C(O){O.done?h(O.value):A(O.value).then(S,y)}C((w=w.apply(d,f||[])).next())})},eo=function(d,f){var c={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},w,A,h,p;return p={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function S(C){return function(O){return y([C,O])}}function y(C){if(w)throw new TypeError("Generator is already executing.");for(;p&&(p=0,C[0]&&(c=0)),c;)try{if(w=1,A&&(h=C[0]&2?A.return:C[0]?A.throw||((h=A.return)&&h.call(A),0):A.next)&&!(h=h.call(A,C[1])).done)return h;switch(A=0,h&&(C=[C[0]&2,h.value]),C[0]){case 0:case 1:h=C;break;case 4:return c.label++,{value:C[1],done:!1};case 5:c.label++,A=C[1],C=[0];continue;case 7:C=c.ops.pop(),c.trys.pop();continue;default:if(h=c.trys,!(h=h.length>0&&h[h.length-1])&&(C[0]===6||C[0]===2)){c=0;continue}if(C[0]===3&&(!h||C[1]>h[0]&&C[1]<h[3])){c.label=C[1];break}if(C[0]===6&&c.label<h[1]){c.label=h[1],h=C;break}if(h&&c.label<h[2]){c.label=h[2],c.ops.push(C);break}h[2]&&c.ops.pop(),c.trys.pop();continue}C=f.call(d,c)}catch(O){C=[6,O],A=0}finally{w=h=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},Bi=function(){function d(f,c,w){if(this.formatMap=new Map([[Q.QR_CODE,"qr_code"],[Q.AZTEC,"aztec"],[Q.CODABAR,"codabar"],[Q.CODE_39,"code_39"],[Q.CODE_93,"code_93"],[Q.CODE_128,"code_128"],[Q.DATA_MATRIX,"data_matrix"],[Q.ITF,"itf"],[Q.EAN_13,"ean_13"],[Q.EAN_8,"ean_8"],[Q.PDF_417,"pdf417"],[Q.UPC_A,"upc_a"],[Q.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!d.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=c,this.logger=w;var A=this.createBarcodeDetectorFormats(f);if(this.detector=new BarcodeDetector(A),!this.detector)throw"BarcodeDetector detector not supported"}return d.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var f=new BarcodeDetector({formats:["qr_code"]});return typeof f<"u"},d.prototype.decodeAsync=function(f){return $s(this,void 0,void 0,function(){var c,w;return eo(this,function(A){switch(A.label){case 0:return[4,this.detector.detect(f)];case 1:if(c=A.sent(),!c||c.length===0)throw"No barcode or QR code detected.";return w=this.selectLargestBarcode(c),[2,{text:w.rawValue,format:Wi.create(this.toHtml5QrcodeSupportedFormats(w.format)),debugData:this.createDebugData()}]}})})},d.prototype.selectLargestBarcode=function(f){for(var c=null,w=0,A=0,h=f;A<h.length;A++){var p=h[A],S=p.boundingBox.width*p.boundingBox.height;S>w&&(w=S,c=p)}if(!c)throw"No largest barcode found";return c},d.prototype.createBarcodeDetectorFormats=function(f){for(var c=[],w=0,A=f;w<A.length;w++){var h=A[w];this.formatMap.has(h)?c.push(this.formatMap.get(h)):this.logger.warn("".concat(h," is not supported by")+"BarcodeDetectorDelegate")}return{formats:c}},d.prototype.toHtml5QrcodeSupportedFormats=function(f){if(!this.reverseFormatMap.has(f))throw"reverseFormatMap doesn't have ".concat(f);return this.reverseFormatMap.get(f)},d.prototype.createReverseFormatMap=function(){var f=new Map;return this.formatMap.forEach(function(c,w,A){f.set(c,w)}),f},d.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},d}(),vi=function(d,f,c,w){function A(h){return h instanceof c?h:new c(function(p){p(h)})}return new(c||(c=Promise))(function(h,p){function S(O){try{C(w.next(O))}catch(R){p(R)}}function y(O){try{C(w.throw(O))}catch(R){p(R)}}function C(O){O.done?h(O.value):A(O.value).then(S,y)}C((w=w.apply(d,f||[])).next())})},Pi=function(d,f){var c={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},w,A,h,p;return p={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function S(C){return function(O){return y([C,O])}}function y(C){if(w)throw new TypeError("Generator is already executing.");for(;p&&(p=0,C[0]&&(c=0)),c;)try{if(w=1,A&&(h=C[0]&2?A.return:C[0]?A.throw||((h=A.return)&&h.call(A),0):A.next)&&!(h=h.call(A,C[1])).done)return h;switch(A=0,h&&(C=[C[0]&2,h.value]),C[0]){case 0:case 1:h=C;break;case 4:return c.label++,{value:C[1],done:!1};case 5:c.label++,A=C[1],C=[0];continue;case 7:C=c.ops.pop(),c.trys.pop();continue;default:if(h=c.trys,!(h=h.length>0&&h[h.length-1])&&(C[0]===6||C[0]===2)){c=0;continue}if(C[0]===3&&(!h||C[1]>h[0]&&C[1]<h[3])){c.label=C[1];break}if(C[0]===6&&c.label<h[1]){c.label=h[1],h=C;break}if(h&&c.label<h[2]){c.label=h[2],c.ops.push(C);break}h[2]&&c.ops.pop(),c.trys.pop();continue}C=f.call(d,c)}catch(O){C=[6,O],A=0}finally{w=h=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},to=function(){function d(f,c,w,A){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=w,c&&Bi.isSupported()?(this.primaryDecoder=new Bi(f,w,A),this.secondaryDecoder=new Mi(f,w,A)):this.primaryDecoder=new Mi(f,w,A)}return d.prototype.decodeAsync=function(f){return vi(this,void 0,void 0,function(){var c;return Pi(this,function(w){switch(w.label){case 0:c=performance.now(),w.label=1;case 1:return w.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(f)];case 2:return[2,w.sent()];case 3:return this.possiblyLogPerformance(c),[7];case 4:return[2]}})})},d.prototype.decodeRobustlyAsync=function(f){return vi(this,void 0,void 0,function(){var c,w;return Pi(this,function(A){switch(A.label){case 0:c=performance.now(),A.label=1;case 1:return A.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(f)];case 2:return[2,A.sent()];case 3:if(w=A.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(f)];throw w;case 4:return this.possiblyLogPerformance(c),[7];case 5:return[2]}})})},d.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},d.prototype.possiblyLogPerformance=function(f){if(this.verbose){var c=performance.now()-f;this.executionResults.push(c),this.executions++,this.possiblyFlushPerformanceReport()}},d.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var f=0,c=0,w=this.executionResults;c<w.length;c++){var A=w[c];f+=A}var h=f/this.executionResults.length;console.log("".concat(h," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},d}(),Br=function(){var d=function(f,c){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,A){w.__proto__=A}||function(w,A){for(var h in A)Object.prototype.hasOwnProperty.call(A,h)&&(w[h]=A[h])},d(f,c)};return function(f,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");d(f,c);function w(){this.constructor=f}f.prototype=c===null?Object.create(c):(w.prototype=c.prototype,new w)}}(),Vn=function(d,f,c,w){function A(h){return h instanceof c?h:new c(function(p){p(h)})}return new(c||(c=Promise))(function(h,p){function S(O){try{C(w.next(O))}catch(R){p(R)}}function y(O){try{C(w.throw(O))}catch(R){p(R)}}function C(O){O.done?h(O.value):A(O.value).then(S,y)}C((w=w.apply(d,f||[])).next())})},Gn=function(d,f){var c={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},w,A,h,p;return p={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function S(C){return function(O){return y([C,O])}}function y(C){if(w)throw new TypeError("Generator is already executing.");for(;p&&(p=0,C[0]&&(c=0)),c;)try{if(w=1,A&&(h=C[0]&2?A.return:C[0]?A.throw||((h=A.return)&&h.call(A),0):A.next)&&!(h=h.call(A,C[1])).done)return h;switch(A=0,h&&(C=[C[0]&2,h.value]),C[0]){case 0:case 1:h=C;break;case 4:return c.label++,{value:C[1],done:!1};case 5:c.label++,A=C[1],C=[0];continue;case 7:C=c.ops.pop(),c.trys.pop();continue;default:if(h=c.trys,!(h=h.length>0&&h[h.length-1])&&(C[0]===6||C[0]===2)){c=0;continue}if(C[0]===3&&(!h||C[1]>h[0]&&C[1]<h[3])){c.label=C[1];break}if(C[0]===6&&c.label<h[1]){c.label=h[1],h=C;break}if(h&&c.label<h[2]){c.label=h[2],c.ops.push(C);break}h[2]&&c.ops.pop(),c.trys.pop();continue}C=f.call(d,c)}catch(O){C=[6,O],A=0}finally{w=h=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},Yi=function(){function d(f,c){this.name=f,this.track=c}return d.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},d.prototype.apply=function(f){var c={};c[this.name]=f;var w={advanced:[c]};return this.track.applyConstraints(w)},d.prototype.value=function(){var f=this.track.getSettings();if(this.name in f){var c=f[this.name];return c}return null},d}(),no=function(d){Br(f,d);function f(c,w){return d.call(this,c,w)||this}return f.prototype.min=function(){return this.getCapabilities().min},f.prototype.max=function(){return this.getCapabilities().max},f.prototype.step=function(){return this.getCapabilities().step},f.prototype.apply=function(c){var w={};w[this.name]=c;var A={advanced:[w]};return this.track.applyConstraints(A)},f.prototype.getCapabilities=function(){this.failIfNotSupported();var c=this.track.getCapabilities(),w=c[this.name];return{min:w.min,max:w.max,step:w.step}},f.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},f}(Yi),ro=function(d){Br(f,d);function f(c){return d.call(this,"zoom",c)||this}return f}(no),io=function(d){Br(f,d);function f(c){return d.call(this,"torch",c)||this}return f}(Yi),so=function(){function d(f){this.track=f}return d.prototype.zoomFeature=function(){return new ro(this.track)},d.prototype.torchFeature=function(){return new io(this.track)},d}(),oo=function(){function d(f,c,w){this.isClosed=!1,this.parentElement=f,this.mediaStream=c,this.callbacks=w,this.surface=this.createVideoElement(this.parentElement.clientWidth),f.append(this.surface)}return d.prototype.createVideoElement=function(f){var c=document.createElement("video");return c.style.width="".concat(f,"px"),c.style.display="block",c.muted=!0,c.setAttribute("muted","true"),c.playsInline=!0,c},d.prototype.setupSurface=function(){var f=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var c=function(){var w=f.surface.clientWidth,A=f.surface.clientHeight;f.callbacks.onRenderSurfaceReady(w,A),f.surface.removeEventListener("playing",c)};this.surface.addEventListener("playing",c),this.surface.srcObject=this.mediaStream,this.surface.play()},d.create=function(f,c,w,A){return Vn(this,void 0,void 0,function(){var h,p;return Gn(this,function(S){switch(S.label){case 0:return h=new d(f,c,A),w.aspectRatio?(p={aspectRatio:w.aspectRatio},[4,h.getFirstTrackOrFail().applyConstraints(p)]):[3,2];case 1:S.sent(),S.label=2;case 2:return h.setupSurface(),[2,h]}})})},d.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},d.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},d.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},d.prototype.resume=function(f){this.failIfClosed();var c=this,w=function(){setTimeout(f,200),c.surface.removeEventListener("playing",w)};this.surface.addEventListener("playing",w),this.surface.play()},d.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},d.prototype.getSurface=function(){return this.failIfClosed(),this.surface},d.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},d.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},d.prototype.applyVideoConstraints=function(f){return Vn(this,void 0,void 0,function(){return Gn(this,function(c){if("aspectRatio"in f)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(f)]})})},d.prototype.close=function(){if(this.isClosed)return Promise.resolve();var f=this;return new Promise(function(c,w){var A=f.mediaStream.getVideoTracks(),h=A.length,p=0;f.mediaStream.getVideoTracks().forEach(function(S){f.mediaStream.removeTrack(S),S.stop(),++p,p>=h&&(f.isClosed=!0,f.parentElement.removeChild(f.surface),c())})})},d.prototype.getCapabilities=function(){return new so(this.getFirstTrackOrFail())},d}(),ao=function(){function d(f){this.mediaStream=f}return d.prototype.render=function(f,c,w){return Vn(this,void 0,void 0,function(){return Gn(this,function(A){return[2,oo.create(f,this.mediaStream,c,w)]})})},d.create=function(f){return Vn(this,void 0,void 0,function(){var c,w;return Gn(this,function(A){switch(A.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return c={audio:!1,video:f},[4,navigator.mediaDevices.getUserMedia(c)];case 1:return w=A.sent(),[2,new d(w)]}})})},d}(),Li=function(d,f,c,w){function A(h){return h instanceof c?h:new c(function(p){p(h)})}return new(c||(c=Promise))(function(h,p){function S(O){try{C(w.next(O))}catch(R){p(R)}}function y(O){try{C(w.throw(O))}catch(R){p(R)}}function C(O){O.done?h(O.value):A(O.value).then(S,y)}C((w=w.apply(d,f||[])).next())})},Fi=function(d,f){var c={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},w,A,h,p;return p={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function S(C){return function(O){return y([C,O])}}function y(C){if(w)throw new TypeError("Generator is already executing.");for(;p&&(p=0,C[0]&&(c=0)),c;)try{if(w=1,A&&(h=C[0]&2?A.return:C[0]?A.throw||((h=A.return)&&h.call(A),0):A.next)&&!(h=h.call(A,C[1])).done)return h;switch(A=0,h&&(C=[C[0]&2,h.value]),C[0]){case 0:case 1:h=C;break;case 4:return c.label++,{value:C[1],done:!1};case 5:c.label++,A=C[1],C=[0];continue;case 7:C=c.ops.pop(),c.trys.pop();continue;default:if(h=c.trys,!(h=h.length>0&&h[h.length-1])&&(C[0]===6||C[0]===2)){c=0;continue}if(C[0]===3&&(!h||C[1]>h[0]&&C[1]<h[3])){c.label=C[1];break}if(C[0]===6&&c.label<h[1]){c.label=h[1],h=C;break}if(h&&c.label<h[2]){c.label=h[2],c.ops.push(C);break}h[2]&&c.ops.pop(),c.trys.pop();continue}C=f.call(d,c)}catch(O){C=[6,O],A=0}finally{w=h=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},lo=function(){function d(){}return d.failIfNotSupported=function(){return Li(this,void 0,void 0,function(){return Fi(this,function(f){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new d]})})},d.prototype.create=function(f){return Li(this,void 0,void 0,function(){return Fi(this,function(c){return[2,ao.create(f)]})})},d}(),co=function(d,f,c,w){function A(h){return h instanceof c?h:new c(function(p){p(h)})}return new(c||(c=Promise))(function(h,p){function S(O){try{C(w.next(O))}catch(R){p(R)}}function y(O){try{C(w.throw(O))}catch(R){p(R)}}function C(O){O.done?h(O.value):A(O.value).then(S,y)}C((w=w.apply(d,f||[])).next())})},uo=function(d,f){var c={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},w,A,h,p;return p={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function S(C){return function(O){return y([C,O])}}function y(C){if(w)throw new TypeError("Generator is already executing.");for(;p&&(p=0,C[0]&&(c=0)),c;)try{if(w=1,A&&(h=C[0]&2?A.return:C[0]?A.throw||((h=A.return)&&h.call(A),0):A.next)&&!(h=h.call(A,C[1])).done)return h;switch(A=0,h&&(C=[C[0]&2,h.value]),C[0]){case 0:case 1:h=C;break;case 4:return c.label++,{value:C[1],done:!1};case 5:c.label++,A=C[1],C=[0];continue;case 7:C=c.ops.pop(),c.trys.pop();continue;default:if(h=c.trys,!(h=h.length>0&&h[h.length-1])&&(C[0]===6||C[0]===2)){c=0;continue}if(C[0]===3&&(!h||C[1]>h[0]&&C[1]<h[3])){c.label=C[1];break}if(C[0]===6&&c.label<h[1]){c.label=h[1],h=C;break}if(h&&c.label<h[2]){c.label=h[2],c.ops.push(C);break}h[2]&&c.ops.pop(),c.trys.pop();continue}C=f.call(d,c)}catch(O){C=[6,O],A=0}finally{w=h=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},fo=function(){function d(){}return d.retrieve=function(){if(navigator.mediaDevices)return d.getCamerasFromMediaDevices();var f=MediaStreamTrack;return MediaStreamTrack&&f.getSources?d.getCamerasFromMediaStreamTrack():d.rejectWithError()},d.rejectWithError=function(){var f=fn.unableToQuerySupportedDevices();return d.isHttpsOrLocalhost()||(f=fn.insecureContextCameraQueryError()),Promise.reject(f)},d.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var f=location.host.split(":")[0];return f==="127.0.0.1"||f==="localhost"},d.getCamerasFromMediaDevices=function(){return co(this,void 0,void 0,function(){var f,c,w,A,h,p,S;return uo(this,function(y){switch(y.label){case 0:return f=function(C){for(var O=C.getVideoTracks(),R=0,Y=O;R<Y.length;R++){var k=Y[R];k.enabled=!1,k.stop(),C.removeTrack(k)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return c=y.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(w=y.sent(),A=[],h=0,p=w;h<p.length;h++)S=p[h],S.kind==="videoinput"&&A.push({id:S.deviceId,label:S.label});return f(c),[2,A]}})})},d.getCamerasFromMediaStreamTrack=function(){return new Promise(function(f,c){var w=function(h){for(var p=[],S=0,y=h;S<y.length;S++){var C=y[S];C.kind==="video"&&p.push({id:C.id,label:C.label})}f(p)},A=MediaStreamTrack;A.getSources(w)})},d}(),Ue;(function(d){d[d.UNKNOWN=0]="UNKNOWN",d[d.NOT_STARTED=1]="NOT_STARTED",d[d.SCANNING=2]="SCANNING",d[d.PAUSED=3]="PAUSED"})(Ue||(Ue={}));var ho=function(){function d(){this.state=Ue.NOT_STARTED,this.onGoingTransactionNewState=Ue.UNKNOWN}return d.prototype.directTransition=function(f){this.failIfTransitionOngoing(),this.validateTransition(f),this.state=f},d.prototype.startTransition=function(f){return this.failIfTransitionOngoing(),this.validateTransition(f),this.onGoingTransactionNewState=f,this},d.prototype.execute=function(){if(this.onGoingTransactionNewState===Ue.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var f=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Ue.UNKNOWN,this.directTransition(f)},d.prototype.cancel=function(){if(this.onGoingTransactionNewState===Ue.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Ue.UNKNOWN},d.prototype.getState=function(){return this.state},d.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Ue.UNKNOWN)throw"Cannot transition to a new state, already under transition"},d.prototype.validateTransition=function(f){switch(this.state){case Ue.UNKNOWN:throw"Transition from unknown is not allowed";case Ue.NOT_STARTED:this.failIfNewStateIs(f,[Ue.PAUSED]);break;case Ue.SCANNING:break;case Ue.PAUSED:break}},d.prototype.failIfNewStateIs=function(f,c){for(var w=0,A=c;w<A.length;w++){var h=A[w];if(f===h)throw"Cannot transition from ".concat(this.state," to ").concat(f)}},d}(),go=function(){function d(f){this.stateManager=f}return d.prototype.startTransition=function(f){return this.stateManager.startTransition(f)},d.prototype.directTransition=function(f){this.stateManager.directTransition(f)},d.prototype.getState=function(){return this.stateManager.getState()},d.prototype.canScanFile=function(){return this.stateManager.getState()===Ue.NOT_STARTED},d.prototype.isScanning=function(){return this.stateManager.getState()!==Ue.NOT_STARTED},d.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Ue.SCANNING},d.prototype.isPaused=function(){return this.stateManager.getState()===Ue.PAUSED},d}(),xo=function(){function d(){}return d.create=function(){return new go(new ho)},d}(),wo=function(){var d=function(f,c){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,A){w.__proto__=A}||function(w,A){for(var h in A)Object.prototype.hasOwnProperty.call(A,h)&&(w[h]=A[h])},d(f,c)};return function(f,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");d(f,c);function w(){this.constructor=f}f.prototype=c===null?Object.create(c):(w.prototype=c.prototype,new w)}}(),ft=function(d){wo(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.DEFAULT_WIDTH=300,f.DEFAULT_WIDTH_OFFSET=2,f.FILE_SCAN_MIN_HEIGHT=300,f.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,f.MIN_QR_BOX_SIZE=50,f.SHADED_LEFT=1,f.SHADED_RIGHT=2,f.SHADED_TOP=3,f.SHADED_BOTTOM=4,f.SHADED_REGION_ELEMENT_ID="qr-shaded-region",f.VERBOSE=!1,f.BORDER_SHADER_DEFAULT_COLOR="#ffffff",f.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",f}(zs),Ao=function(){function d(f,c){this.logger=c,this.fps=ft.SCAN_DEFAULT_FPS,f?(f.fps&&(this.fps=f.fps),this.disableFlip=f.disableFlip===!0,this.qrbox=f.qrbox,this.aspectRatio=f.aspectRatio,this.videoConstraints=f.videoConstraints):this.disableFlip=ft.DEFAULT_DISABLE_FLIP}return d.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Xi.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},d.prototype.isShadedBoxEnabled=function(){return!Bt(this.qrbox)},d.create=function(f,c){return new d(f,c)},d}(),mo=function(){function d(f,c){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(f))throw"HTML Element with id=".concat(f," not found");this.elementId=f,this.verbose=!1;var w;typeof c=="boolean"?this.verbose=c===!0:c&&(w=c,this.verbose=w.verbose===!0,w.experimentalFeatures),this.logger=new Ks(this.verbose),this.qrcode=new to(this.getSupportedFormats(c),this.getUseBarCodeDetectorIfSupported(w),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=xo.create()}return d.prototype.start=function(f,c,w,A){var h=this;if(!f)throw"cameraIdOrConfig is required";if(!w||typeof w!="function")throw"qrCodeSuccessCallback is required and should be a function.";var p;A?p=A:p=this.verbose?this.logger.log:function(){};var S=Ao.create(c,this.logger);this.clearElement();var y=!1;S.videoConstraints&&(S.isMediaStreamConstraintsValid()?y=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var C=y,O=document.getElementById(this.elementId);O.clientWidth?O.clientWidth:ft.DEFAULT_WIDTH,O.style.position="relative",this.shouldScan=!0,this.element=O;var R=this,Y=this.stateManagerProxy.startTransition(Ue.SCANNING);return new Promise(function(k,re){var q=C?S.videoConstraints:R.createVideoConstraints(f);if(!q){Y.cancel(),re("videoConstraints should be defined");return}var Ie={};(!C||S.aspectRatio)&&(Ie.aspectRatio=S.aspectRatio);var oe={onRenderSurfaceReady:function($,G){R.setupUi($,G,S),R.isScanning=!0,R.foreverScan(S,w,p)}};lo.failIfNotSupported().then(function($){$.create(q).then(function(G){return G.render(h.element,Ie,oe).then(function(K){R.renderedCamera=K,Y.execute(),k(null)}).catch(function(K){Y.cancel(),re(K)})}).catch(function(G){Y.cancel(),re(fn.errorGettingUserMedia(G))})}).catch(function($){Y.cancel(),re(fn.cameraStreamingNotSupported())})})},d.prototype.pause=function(f){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Ue.PAUSED),this.showPausedState(),(Bt(f)||f!==!0)&&(f=!1),f&&this.renderedCamera&&this.renderedCamera.pause()},d.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var f=this,c=function(){f.stateManagerProxy.directTransition(Ue.SCANNING),f.hidePausedState()};if(!this.renderedCamera.isPaused()){c();return}this.renderedCamera.resume(function(){c()})},d.prototype.getState=function(){return this.stateManagerProxy.getState()},d.prototype.stop=function(){var f=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var c=this.stateManagerProxy.startTransition(Ue.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var w=function(){if(f.element){var h=document.getElementById(ft.SHADED_REGION_ELEMENT_ID);h&&f.element.removeChild(h)}},A=this;return this.renderedCamera.close().then(function(){return A.renderedCamera=null,A.element&&(A.element.removeChild(A.canvasElement),A.canvasElement=null),w(),A.qrRegion&&(A.qrRegion=null),A.context&&(A.context=null),c.execute(),A.hidePausedState(),A.isScanning=!1,Promise.resolve()})},d.prototype.scanFile=function(f,c){return this.scanFileV2(f,c).then(function(w){return w.decodedText})},d.prototype.scanFileV2=function(f,c){var w=this;if(!f||!(f instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Bt(c)&&(c=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(A,h){w.possiblyCloseLastScanImageFile(),w.clearElement(),w.lastScanImageFile=URL.createObjectURL(f);var p=new Image;p.onload=function(){var S=p.width,y=p.height,C=document.getElementById(w.elementId),O=C.clientWidth?C.clientWidth:ft.DEFAULT_WIDTH,R=Math.max(C.clientHeight?C.clientHeight:y,ft.FILE_SCAN_MIN_HEIGHT),Y=w.computeCanvasDrawConfig(S,y,O,R);if(c){var k=w.createCanvasElement(O,R,"qr-canvas-visible");k.style.display="inline-block",C.appendChild(k);var re=k.getContext("2d");if(!re)throw"Unable to get 2d context from canvas";re.canvas.width=O,re.canvas.height=R,re.drawImage(p,0,0,S,y,Y.x,Y.y,Y.width,Y.height)}var q=ft.FILE_SCAN_HIDDEN_CANVAS_PADDING,Ie=Math.max(p.width,Y.width),oe=Math.max(p.height,Y.height),$=Ie+2*q,G=oe+2*q,K=w.createCanvasElement($,G);C.appendChild(K);var Te=K.getContext("2d");if(!Te)throw"Unable to get 2d context from canvas";Te.canvas.width=$,Te.canvas.height=G,Te.drawImage(p,0,0,S,y,q,q,Ie,oe);try{w.qrcode.decodeRobustlyAsync(K).then(function(W){A(Oi.createFromQrcodeResult(W))}).catch(h)}catch(W){h("QR code parse error, error = ".concat(W))}},p.onerror=h,p.onabort=h,p.onstalled=h,p.onsuspend=h,p.src=URL.createObjectURL(f)})},d.prototype.clear=function(){this.clearElement()},d.getCameras=function(){return fo.retrieve()},d.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},d.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},d.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},d.prototype.applyVideoConstraints=function(f){if(f){if(!Xi.isMediaStreamConstraintsValid(f,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(f)},d.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},d.prototype.getSupportedFormats=function(f){var c=[Q.QR_CODE,Q.AZTEC,Q.CODABAR,Q.CODE_39,Q.CODE_93,Q.CODE_128,Q.DATA_MATRIX,Q.MAXICODE,Q.ITF,Q.EAN_13,Q.EAN_8,Q.PDF_417,Q.RSS_14,Q.RSS_EXPANDED,Q.UPC_A,Q.UPC_E,Q.UPC_EAN_EXTENSION];if(!f||typeof f=="boolean"||!f.formatsToSupport)return c;if(!Array.isArray(f.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(f.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var w=[],A=0,h=f.formatsToSupport;A<h.length;A++){var p=h[A];Ys(p)?w.push(p):this.logger.warn("Invalid format: ".concat(p," passed in config, ignoring."))}if(w.length===0)throw"None of formatsToSupport match supported values.";return w},d.prototype.getUseBarCodeDetectorIfSupported=function(f){if(Bt(f))return!0;if(!Bt(f.useBarCodeDetectorIfSupported))return f.useBarCodeDetectorIfSupported!==!1;if(Bt(f.experimentalFeatures))return!0;var c=f.experimentalFeatures;return Bt(c.useBarCodeDetectorIfSupported)?!0:c.useBarCodeDetectorIfSupported!==!1},d.prototype.validateQrboxSize=function(f,c,w){var A=this,h=w.qrbox;this.validateQrboxConfig(h);var p=this.toQrdimensions(f,c,h),S=function(C){if(C<ft.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(ft.MIN_QR_BOX_SIZE,"px.")},y=function(C){return C>f&&(A.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),C=f),C};S(p.width),S(p.height),p.width=y(p.width)},d.prototype.validateQrboxConfig=function(f){if(typeof f!="number"&&typeof f!="function"&&(f.width===void 0||f.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},d.prototype.toQrdimensions=function(f,c,w){if(typeof w=="number")return{width:w,height:w};if(typeof w=="function")try{return w(f,c)}catch(A){throw new Error("qrbox config was passed as a function but it failed with unknown error"+A)}return w},d.prototype.setupUi=function(f,c,w){w.isShadedBoxEnabled()&&this.validateQrboxSize(f,c,w);var A=Bt(w.qrbox)?{width:f,height:c}:w.qrbox;this.validateQrboxConfig(A);var h=this.toQrdimensions(f,c,A);h.height>c&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var p=w.isShadedBoxEnabled()&&h.height<=c,S={x:0,y:0,width:f,height:c},y=p?this.getShadedRegionBounds(f,c,h):S,C=this.createCanvasElement(y.width,y.height),O={willReadFrequently:!0},R=C.getContext("2d",O);R.canvas.width=y.width,R.canvas.height=y.height,this.element.append(C),p&&this.possiblyInsertShadingElement(this.element,f,c,h),this.createScannerPausedUiElement(this.element),this.qrRegion=y,this.context=R,this.canvasElement=C},d.prototype.createScannerPausedUiElement=function(f){var c=document.createElement("div");c.innerText=fn.scannerPaused(),c.style.display="none",c.style.position="absolute",c.style.top="0px",c.style.zIndex="1",c.style.background="rgba(9, 9, 9, 0.46)",c.style.color="#FFECEC",c.style.textAlign="center",c.style.width="100%",f.appendChild(c),this.scannerPausedUiElement=c},d.prototype.scanContext=function(f,c){var w=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(A){return f(A.text,Oi.createFromQrcodeResult(A)),w.possiblyUpdateShaders(!0),!0}).catch(function(A){w.possiblyUpdateShaders(!1);var h=fn.codeParseError(A);return c(h,Zs.createFrom(h)),!1})},d.prototype.foreverScan=function(f,c,w){var A=this;if(this.shouldScan&&this.renderedCamera){var h=this.renderedCamera.getSurface(),p=h.videoWidth/h.clientWidth,S=h.videoHeight/h.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var y=this.qrRegion.width*p,C=this.qrRegion.height*S,O=this.qrRegion.x*p,R=this.qrRegion.y*S;this.context.drawImage(h,O,R,y,C,0,0,this.qrRegion.width,this.qrRegion.height);var Y=function(){A.foreverScanTimeout=setTimeout(function(){A.foreverScan(f,c,w)},A.getTimeoutFps(f.fps))};this.scanContext(c,w).then(function(k){!k&&f.disableFlip!==!0?(A.context.translate(A.context.canvas.width,0),A.context.scale(-1,1),A.scanContext(c,w).finally(function(){Y()})):Y()}).catch(function(k){A.logger.logError("Error happend while scanning context",k),Y()})}},d.prototype.createVideoConstraints=function(f){if(typeof f=="string")return{deviceId:{exact:f}};if(typeof f=="object"){var c="facingMode",w="deviceId",A={user:!0,environment:!0},h="exact",p=function(re){if(re in A)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(re,"'")},S=Object.keys(f);if(S.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(S.length," keys");var y=Object.keys(f)[0];if(y!==c&&y!==w)throw"Only '".concat(c,"' and '").concat(w,"' ")+" are supported for 'cameraIdOrConfig'";if(y===c){var C=f.facingMode;if(typeof C=="string"){if(p(C))return{facingMode:C}}else if(typeof C=="object")if(h in C){if(p(C["".concat(h)]))return{facingMode:{exact:C["".concat(h)]}}}else throw"'facingMode' should be string or object with"+" ".concat(h," as key.");else{var O=typeof C;throw"Invalid type of 'facingMode' = ".concat(O)}}else{var R=f.deviceId;if(typeof R=="string")return{deviceId:R};if(typeof R=="object"){if(h in R)return{deviceId:{exact:R["".concat(h)]}};throw"'deviceId' should be string or object with"+" ".concat(h," as key.")}else{var Y=typeof R;throw"Invalid type of 'deviceId' = ".concat(Y)}}}var k=typeof f;throw"Invalid type of 'cameraIdOrConfig' = ".concat(k)},d.prototype.computeCanvasDrawConfig=function(f,c,w,A){if(f<=w&&c<=A){var h=(w-f)/2,p=(A-c)/2;return{x:h,y:p,width:f,height:c}}else{var S=f,y=c;return f>w&&(c=w/f*c,f=w),c>A&&(f=A/c*f,c=A),this.logger.log("Image downsampled from "+"".concat(S,"X").concat(y)+" to ".concat(f,"X").concat(c,".")),this.computeCanvasDrawConfig(f,c,w,A)}},d.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var f=document.getElementById(this.elementId);f&&(f.innerHTML="")},d.prototype.possiblyUpdateShaders=function(f){this.qrMatch!==f&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(c){c.style.backgroundColor=f?ft.BORDER_SHADER_MATCH_COLOR:ft.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=f)},d.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},d.prototype.createCanvasElement=function(f,c,w){var A=f,h=c,p=document.createElement("canvas");return p.style.width="".concat(A,"px"),p.style.height="".concat(h,"px"),p.style.display="none",p.id=Bt(w)?"qr-canvas":w,p},d.prototype.getShadedRegionBounds=function(f,c,w){if(w.width>f||w.height>c)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(f-w.width)/2,y:(c-w.height)/2,width:w.width,height:w.height}},d.prototype.possiblyInsertShadingElement=function(f,c,w,A){if(!(c-A.width<1||w-A.height<1)){var h=document.createElement("div");h.style.position="absolute";var p=(c-A.width)/2,S=(w-A.height)/2;if(h.style.borderLeft="".concat(p,"px solid rgba(0, 0, 0, 0.48)"),h.style.borderRight="".concat(p,"px solid rgba(0, 0, 0, 0.48)"),h.style.borderTop="".concat(S,"px solid rgba(0, 0, 0, 0.48)"),h.style.borderBottom="".concat(S,"px solid rgba(0, 0, 0, 0.48)"),h.style.boxSizing="border-box",h.style.top="0px",h.style.bottom="0px",h.style.left="0px",h.style.right="0px",h.id="".concat(ft.SHADED_REGION_ELEMENT_ID),c-A.width<11||w-A.height<11)this.hasBorderShaders=!1;else{var y=5,C=40;this.insertShaderBorders(h,C,y,-y,null,0,!0),this.insertShaderBorders(h,C,y,-y,null,0,!1),this.insertShaderBorders(h,C,y,null,-y,0,!0),this.insertShaderBorders(h,C,y,null,-y,0,!1),this.insertShaderBorders(h,y,C+y,-y,null,-y,!0),this.insertShaderBorders(h,y,C+y,null,-y,-y,!0),this.insertShaderBorders(h,y,C+y,-y,null,-y,!1),this.insertShaderBorders(h,y,C+y,null,-y,-y,!1),this.hasBorderShaders=!0}f.append(h)}},d.prototype.insertShaderBorders=function(f,c,w,A,h,p,S){var y=document.createElement("div");y.style.position="absolute",y.style.backgroundColor=ft.BORDER_SHADER_DEFAULT_COLOR,y.style.width="".concat(c,"px"),y.style.height="".concat(w,"px"),A!==null&&(y.style.top="".concat(A,"px")),h!==null&&(y.style.bottom="".concat(h,"px")),S?y.style.left="".concat(p,"px"):y.style.right="".concat(p,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(y),f.appendChild(y)},d.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},d.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},d.prototype.getTimeoutFps=function(f){return 1e3/f},d}(),ki;(function(d){d[d.STATUS_DEFAULT=0]="STATUS_DEFAULT",d[d.STATUS_SUCCESS=1]="STATUS_SUCCESS",d[d.STATUS_WARNING=2]="STATUS_WARNING",d[d.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(ki||(ki={}));export{mo as H,Un as a,Co as r};
//# sourceMappingURL=qrcode-vendor-hOVvWyDU.js.map
